<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Greg Ridgeway">
<meta name="dcterms.date" content="2025-03-29">

<title>Machine learning with text</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="L11-text_files/libs/clipboard/clipboard.min.js"></script>
<script src="L11-text_files/libs/quarto-html/quarto.js"></script>
<script src="L11-text_files/libs/quarto-html/popper.min.js"></script>
<script src="L11-text_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="L11-text_files/libs/quarto-html/anchor.min.js"></script>
<link href="L11-text_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="L11-text_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="L11-text_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="L11-text_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="L11-text_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="L11-text_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="L11-text_files/libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="L11-text_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="L11-text_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

<link href="L11-text_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="L11-text_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="L11-text_files/libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="L11-text_files/libs/typedarray-0.1/typedarray.min.js"></script>

<script src="L11-text_files/libs/jquery-3.5.1/jquery.min.js"></script>

<link href="L11-text_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="L11-text_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="L11-text_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="L11-text_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#turning-text-into-data-with-text2vec" id="toc-turning-text-into-data-with-text2vec" class="nav-link" data-scroll-target="#turning-text-into-data-with-text2vec"><span class="header-section-number">2</span> Turning text into data with <code>text2vec</code></a>
  <ul class="collapse">
  <li><a href="#creating-a-document-term-matrix-dtm" id="toc-creating-a-document-term-matrix-dtm" class="nav-link" data-scroll-target="#creating-a-document-term-matrix-dtm"><span class="header-section-number">2.1</span> Creating a document-term matrix (DTM)</a></li>
  <li><a href="#term-frequencyinverse-document-frequency" id="toc-term-frequencyinverse-document-frequency" class="nav-link" data-scroll-target="#term-frequencyinverse-document-frequency"><span class="header-section-number">2.2</span> Term Frequency–Inverse Document Frequency</a>
  <ul class="collapse">
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span class="header-section-number">2.2.1</span> Example</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#term-co-occurrence-matrix-tcm" id="toc-term-co-occurrence-matrix-tcm" class="nav-link" data-scroll-target="#term-co-occurrence-matrix-tcm"><span class="header-section-number">3</span> Term co-occurrence matrix (TCM)</a></li>
  <li><a href="#singular-value-decomposition-for-text" id="toc-singular-value-decomposition-for-text" class="nav-link" data-scroll-target="#singular-value-decomposition-for-text"><span class="header-section-number">4</span> Singular value decomposition for text</a></li>
  <li><a href="#clustering-documents-with-hartigans-k-means-clustering-algorithm" id="toc-clustering-documents-with-hartigans-k-means-clustering-algorithm" class="nav-link" data-scroll-target="#clustering-documents-with-hartigans-k-means-clustering-algorithm"><span class="header-section-number">5</span> Clustering documents with Hartigan’s k-means clustering algorithm</a></li>
  <li><a href="#document-classification" id="toc-document-classification" class="nav-link" data-scroll-target="#document-classification"><span class="header-section-number">6</span> Document classification</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="L11-text.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Machine learning with text</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Greg Ridgeway <a href="mailto:gridge@upenn.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Pennsylvania
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 29, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<!-- In terminal: Only to HTML since heavy plotly() use -->
<!-- quarto render L11-text.qmd --to html-->
<!-- quarto render L11-text.qmd --cache-refresh --to html -->
<!-- git commit L11-* -m "commit message" -->
<!-- git status -->
<!-- git push -->
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>In this section we will use <code>text2vec</code> to explore the language used in a collection of police reports describing officer-involved shootings (OIS). These reports contain unstructured narrative text. Our goal is to transform that text into a format we can analyze using tools from natural language processing (NLP). We will walk through a typical text analysis process: tokenizing the reports, building a vocabulary, constructing a document-term matrix, and applying TF-IDF to highlight the most distinctive terms. Along the way, we will also examine co-occurrence patterns.</p>
<p>To start, we are going to need a couple of R packages to facilitate our work. <code>text2vec</code> will do most of the work converting the documents into a form of data that we can analyze.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(crayon)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(text2vec)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Matrix)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gbm3)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(uwot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As for the source of our documents, the Philadelphia Police Department posts <a href="https://www.phillypolice.com/accountability/ois/">reports</a> on each officer-involved shooting. I have pulled the data off their website and packaged it into an .RData file. Loading it will create the data frame <code>ois</code>. Details on how to pull the data off of the PPD website are part of my <a href="https://github.com/gregridgeway/R4crim?tab=readme-ov-file">R4crim collection</a> of scripts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"data/PPD OIS.RData"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>ois <span class="ot">&lt;-</span> ois <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fatal =</span> <span class="fu">grepl</span>(<span class="st">"1 Killed|^Killed$"</span>, subInjury) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>())</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>ois <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id                                 location
1 24-37      3450 Vista Street, Philadelphia, PA
2 24-36          3250 A Street, Philadelphia, PA
3 24-35 5450 Chancellor Street, Philadelphia, PA
4 24-32         2950 E. Street, Philadelphia, PA
5 24-31      3350 Willits Road, Philadelphia, PA
6 24-30    6150 Lebanon Avenue, Philadelphia, PA
                                        url subInjury       date       lon
1   https://www.phillypolice.com/ois/24-37/       N/A 2024-12-10 -75.03885
2   https://www.phillypolice.com/ois/24-36/       N/A 2024-11-12 -75.12714
3   https://www.phillypolice.com/ois/24-35/    Killed 2024-11-10 -75.23050
4   https://www.phillypolice.com/ois/24-32/       N/A 2024-10-11 -75.12024
5   https://www.phillypolice.com/ois/24-31/    Killed 2024-10-03 -75.00908
6 https://www.phillypolice.com/ois/ps24-30/       N/A 2024-10-02 -75.24450
       lat                                             addrmatch score
1 40.04022      3450 Vista St, Philadelphia, Pennsylvania, 19136   100
2 39.99956          3250 A St, Philadelphia, Pennsylvania, 19134   100
3 39.95692 5450 Chancellor St, Philadelphia, Pennsylvania, 19139   100
4 39.99345          2950 E St, Philadelphia, Pennsylvania, 19134   100
5 40.05383    3350 Willits Rd, Philadelphia, Pennsylvania, 19136   100
6 39.98175   6150 Lebanon Ave, Philadelphia, Pennsylvania, 19151   100
       addrtype fatal
1 StreetAddress     0
2 StreetAddress     0
3 StreetAddress     1
4 StreetAddress     0
5 StreetAddress     1
6  PointAddress     0</code></pre>
</div>
</div>
<p>The data include an incident ID, the date of the shooting, the address and coordinates where the shooting occurred, and a URL to the incident report. There is also a column called <code>text</code> containing the full text of the officer-involved shooting report. Some can be long, but here’s one that hits close to home as an example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ois <span class="sc">|&gt;</span> <span class="fu">filter</span>(id<span class="sc">==</span><span class="st">"16-30"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(text) <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">cat</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Narrative from OIS Report 16-30">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Narrative from OIS Report 16-30
</div>
</div>
<div class="callout-body-container callout-body">
<p>PS#16-30 9/16/16 On Friday, September 16, 2016, at approximately 11:18 P.M., a uniformed sergeant in a marked police vehicle was seated in her parked vehicle in the 5100 block of Sansom Street, when a male approached and without warning, began to discharge a firearm, striking the sergeant, as she remained seated in her vehicle. The offender then began walking east on Sansom Street, stopping at a lounge/bar in the 5100 block of Sansom Street, where he discharged his firearm into the lounge/bar, striking a female employee and a male security guard. The offender continued walking east on Sansom Street to the 4900 block, where he discharged his firearm into an occupied parked vehicle, striking one female and one male occupant. Responding uniformed officers, in marked police vehicles, along with an officer from the University of Pennsylvania police force, located the offender in an alleyway in the rear of the 4800 blocks of Sansom and Walnut Streets. While in the 4800 block of Sansom Street the offender discharged his firearm, striking the University of Pennsylvania Officer as well as a marked police vehicle. Four Officers (one of whom was the University of Pennsylvania Officer) discharged their firearms, striking the offender. The offender fell to the ground and dropped his firearm. Fire Rescue responded and pronounced the offender deceased. The offender’s firearm, a 9MM, semi-automatic pistol, with an obliterated serial number, loaded with 14 live rounds, was recovered at the scene. There were three empty magazines from the offender’s firearm recovered throughout the scene. The sergeant, the University of Pennsylvania Officer, along with the four civilians who were all struck by gunfire, were transported to Penn-Presbyterian Hospital for treatment. The female from the parked vehicle was later pronounced deceased at Penn-Presbyterian Hospital. *** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The DA’s Office is provided all the information from the PPD’s investigation prior to their charging decision.</p>
</div>
</div>
<p>With this set of 133 reports, we will use a variety of data cleaning methods and machine learning methods to try to make sense of these documents.</p>
</section>
<section id="turning-text-into-data-with-text2vec" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Turning text into data with <code>text2vec</code></h1>
<p>To transform the text into a form that is better suited for analysis, we need to go through a number of steps. Part of the reason <code>text2vec</code> is popular is that it can handle large collections of documents. To make the tasks computational efficient there are a number of steps to work through in order to get a usable dataset.</p>
<p>We start by create a “tokenizer,” a process that breaks raw text into individual units like words, phrases, or symbols—called (the “tokens”), the basic building blocks for text analysis. The <code>itoken()</code> function in the <code>text2vec</code> package creates an iterator over a collection of text documents, preparing them for efficient text processing. Instead of transforming all text at once, <code>itoken()</code> streams the documents one at a time, making it well-suited for handling large sets of documents. It “tokenizes” each document using =either a built-in default or a custom tokenizer (which we will do) and produces a structure that can be passed on to other functions that will tidy up the collection of tokens and convert them into a dataset. Because it does not store all tokenized text in memory, <code>itoken()</code> enables fast and memory-efficient text analysis workflows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an iterator over tokens</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   tokens does not actually store data</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   just an efficient means for looping over documents</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>tokens <span class="ot">&lt;-</span> <span class="fu">itoken</span>(ois<span class="sc">$</span>text,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">progressbar =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ids =</span> ois<span class="sc">$</span>id)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># this gets the next batch of documents... for me around 14 documents</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> tokens<span class="sc">$</span><span class="fu">nextElem</span>()</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>a<span class="sc">$</span>ids</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "24-37" "24-36" "24-35" "24-32" "24-31" "24-30" "24-29" "24-28" "24-27"
[10] "24-23" "24-22" "24-21" "24-20" "24-18"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>a<span class="sc">$</span>tokens <span class="sc">|&gt;</span> <span class="fu">sapply</span>(head)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]         [,2]         [,3]         [,4]         [,5]       
[1,] "3400"       "3200"       "5400"       "29oo"       "3300"     
[2,] "block"      "block"      "block"      "block"      "Willits"  
[3,] "of"         "of"         "of"         "of"         "Road\nOn" 
[4,] "Vista"      "A"          "Chancellor" "E."         "Thursday,"
[5,] "Street\nOn" "Street\nOn" "Street\nOn" "Street\nOn" "October"  
[6,] "Tuesday,"   "Tuesday,"   "Sunday,"    "Friday,"    "3,"       
     [,6]         [,7]           [,8]           [,9]          [,10]         
[1,] "6100"       "2600"         "3900"         "2200"        "3000"        
[2,] "block"      "block"        "block"        "block"       "block"       
[3,] "of"         "of"           "of"           "of"          "of"          
[4,] "Lebanon"    "Glenwood"     "Whittaker"    "S."          "Ruth"        
[5,] "Avenue\nOn" "Avenue\nThe"  "Avenue\nThe"  "65th"        "Street\nThe" 
[6,] "Wednesday," "Philadelphia" "Philadelphia" "Street\nThe" "Philadelphia"
     [,11]       [,12]          [,13]       [,14]      
[1,] "6100"      "3500"         "2700"      "1500"     
[2,] "block"     "block"        "block"     "block"    
[3,] "of"        "of"           "of"        "of"       
[4,] "West"      "F"            "North"     "North"    
[5,] "Columbia"  "Street\nA"    "6th"       "57th"     
[6,] "Avenue\nA" "Philadelphia" "Street\nA" "Street\nA"</code></pre>
</div>
</div>
<p>You can see that so far <code>itoken()</code> has pulled in 14 documents and chopped them up into individual words. Notice that the collection of words have some undesirable quirks. For example, there are</p>
<ul>
<li>numbers that we probably do not really care about</li>
<li>unimportant words like “of” (known as “stop words”)</li>
<li>Line feeds <code>\n</code> in between two words</li>
</ul>
<p><code>create_vocabulary()</code> and <code>prune_vocabulary()</code> help us to trim down the words to the ones that we actually care about. <code>create_vocabulary()</code> allows us to provide a list of stop words to remove. <code>stopwords("en")</code> is just such a list. Here are just a few of the 175 English stop words</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>stopwords<span class="sc">::</span><span class="fu">stopwords</span>(<span class="st">"en"</span>) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "i"          "me"         "my"         "myself"     "we"        
 [6] "our"        "ours"       "ourselves"  "you"        "your"      
[11] "yours"      "yourself"   "yourselves" "he"         "him"       
[16] "his"        "himself"    "she"        "her"        "hers"      </code></pre>
</div>
</div>
<p>There are lists for several other languages as well, Italian, for example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>stopwords<span class="sc">::</span><span class="fu">stopwords</span>(<span class="st">"it"</span>) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ad"    "al"    "allo"  "ai"    "agli"  "all"   "agl"   "alla"  "alle" 
[10] "con"   "col"   "coi"   "da"    "dal"   "dallo" "dai"   "dagli" "dall" 
[19] "dagl"  "dalla"</code></pre>
</div>
</div>
<p>We can also ask consider pairs of words in addition to single words (<code>ngram=1:2</code>). This allows word phrases like “police officer” and “pit bull” to be considered as words.</p>
<p><code>prune_vocabulary()</code> trims down words from our vocabulary that are probably not particularly useful</p>
<ul>
<li>words that few documents use (too rare)</li>
<li>words that too many documents use (too common)</li>
</ul>
<p>We can add in some other filters too, like only using words that are at least three letters and dropping any words that have numbers in them (like 3pm or 9mm).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reset to beginning</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>tokens <span class="ot">&lt;-</span> <span class="fu">itoken</span>(ois<span class="sc">$</span>text,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">progressbar =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ids =</span> ois<span class="sc">$</span>id)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Build vocabulary</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   these are the collection of words that I care about</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   skip stopwords (the, of, in, ...)</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   include two word phrases (2-gram or bigram), </span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#      "police officer", "full uniform", "black male", "drop weapon", "pit bull"</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   skip words that only show up in fewer than 10 documents</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   skip words that are in the majority of documents (police?, discharged?)</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> tokens <span class="sc">|&gt;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">create_vocabulary</span>(<span class="at">stopwords =</span> stopwords<span class="sc">::</span><span class="fu">stopwords</span>(<span class="st">"en"</span>),</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ngram =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prune_vocabulary</span>(<span class="at">term_count_min =</span> <span class="dv">10</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">doc_proportion_max =</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">nchar</span>(term) <span class="sc">&gt;=</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"[0-9]"</span>, term))</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co"># space_tokenizer(), default, keeps a lot of punctuation</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>vocab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of docs: 133 
175 stopwords: i, me, my, myself, we, our ... 
ngram_min = 1; ngram_max = 2 
Vocabulary: 
                  term term_count doc_count
                &lt;char&gt;      &lt;int&gt;     &lt;int&gt;
  1:               AM,         10        10
  2:        Avenue\nOn         10        10
  3:   District_Police         10        10
  4:         Hospital,         10         9
  5: Penn-Presbyterian         10         8
 ---                                       
552:           firearm        112        63
553:               one        116        65
554:            posted        120        60
555:           vehicle        180        65
556:          offender        182        49</code></pre>
</div>
</div>
<p>Let’s make our own tokenizer instead of using the default. As we see, the default (<code>space_tokenizer()</code>) often retains punctuation, symbols, or other strange features that dilute or fragment our vocabulary. Customizing the tokenizer allows us to tailor the cleaning process to the structure and quirks of the officer-involved shooting reports. The function that we will create, <code>oisTokenizer()</code>, is a custom tokenizer designed to clean and standardize the raw text from officer-involved shooting reports before further text analysis. It converts the text to lowercase, removes common punctuation patterns (like those in abbreviations such as “3 p.m.”), strips out unusual or inconsistent symbols (such as smart quotes, parentheses, and hash symbols), and splits the text into individual tokens using whitespace as the delimiter.</p>
<p>After tokenization, it will also apply “stemming”. Stemming is a text preprocessing technique that reduces words to their root or base form by removing common suffixes. For example, “running”, “runner”, and “runs” might all be reduced to “run”, allowing the model to treat these variations as the same underlying concept. The <code>SnowballC</code> package has a handy <code>wordStem()</code> function in it. Let’s test it out on a few words.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"dog"</span>,<span class="st">"dogs"</span>,<span class="st">"office"</span>,<span class="st">"officer"</span>,<span class="st">"officers"</span>,<span class="st">"police"</span>,<span class="st">"policy"</span>,<span class="st">"policies"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  SnowballC<span class="sc">::</span><span class="fu">wordStem</span>(<span class="at">language =</span> <span class="st">"en"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "dog"    "dog"    "offic"  "offic"  "offic"  "polic"  "polici" "polici"</code></pre>
</div>
</div>
<p>Conveniently, it makes both “dog” and “dogs” simply “dog”. However, note that it also makes “office”, “officer”, and “officers” all simplified to “office”… maybe not ideal. Since our text will have a lot of “officer” and “officers” and probably very few, if any, “office”, we will need to remember that this stemming has reduced our “police officers” to “polic_offic”. You may see terms like “offic_offic” or “offend_offend”. Typically this occurs because officer or offender was the last word in one sentence and the first non-stop word in the next sentence (e.g.&nbsp;“The suspect ran from the officer. The officer said ‘stop!’”).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># our own custom tokenizer</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>oisTokenizer <span class="ot">&lt;-</span> <span class="cf">function</span>(text)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  text <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tolower</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove abbreviation punctuation (like 3 p.m.)</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gsub</span>(<span class="st">"([A-z])[,.]+"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, <span class="at">x=</span>_) <span class="sc">|&gt;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove some weird symbols</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gsub</span>(<span class="st">"[“”()#]"</span>, <span class="st">""</span>, <span class="at">x=</span>_) <span class="sc">|&gt;</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># no smart quotes</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gsub</span>(<span class="st">"’"</span>, <span class="st">"'"</span>, <span class="at">x=</span>_) <span class="sc">|&gt;</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># split any words with \n, \t, \r between them</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">strsplit</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># stemming</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(SnowballC<span class="sc">::</span>wordStem, <span class="at">language =</span> <span class="st">"en"</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can rerun our documents through our new tokenizer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reset to beginning</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#    now using our oisTokenizer()</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>tokens <span class="ot">&lt;-</span> <span class="fu">itoken</span>(ois<span class="sc">$</span>text,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">tokenizer =</span> oisTokenizer,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">progressbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ids =</span> ois<span class="sc">$</span>id)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> tokens <span class="sc">|&gt;</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">create_vocabulary</span>(<span class="at">stopwords =</span> stopwords<span class="sc">::</span><span class="fu">stopwords</span>(<span class="st">"en"</span>),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ngram =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prune_vocabulary</span>(<span class="at">term_count_min =</span> <span class="dv">10</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">doc_proportion_min =</span> <span class="fl">0.05</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">doc_proportion_max =</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">nchar</span>(term) <span class="sc">&gt;=</span><span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"[0-9]"</span>, term))  <span class="sc">|&gt;</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   Drop some specific terms that are not useful (e.g. philadelphia)</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>term <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"philadelphia_polic"</span>,<span class="st">"philadelphia"</span>,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"inform_da"</span>,<span class="st">"da_offic"</span>,<span class="st">"incid_inform"</span>,<span class="st">"inform_ppd"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"inform_post"</span>,<span class="st">"post"</span>,<span class="st">"officer-involv"</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"officer-involv_shoot"</span>))</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>vocab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of docs: 133 
175 stopwords: i, me, my, myself, we, our ... 
ngram_min = 1; ngram_max = 2 
Vocabulary: 
                term term_count doc_count
              &lt;char&gt;      &lt;int&gt;     &lt;int&gt;
  1:   advanc_toward         10         7
  2:         announc         10         8
  3: approach_driver         10         9
  4:        cartridg         10         9
  5:  district_place         10        10
 ---                                     
514:           shoot        102        62
515:            door        103        51
516:           point        105        54
517:         suspect        110        21
518:          offend        308        56</code></pre>
</div>
</div>
<p>Now we have a collection of words and word phrases gathered from our documents. Note that it includes so two word phrases (bigrams) with the two stemmed words combined with an underscore between them.</p>
<section id="creating-a-document-term-matrix-dtm" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="creating-a-document-term-matrix-dtm"><span class="header-section-number">2.1</span> Creating a document-term matrix (DTM)</h2>
<p>Our next destination is to create a “document-term matrix” (DTM). A DTM is a matrix representation of a collection of text documents, where each row corresponds to a document and each column corresponds to a unique term (a word or phrase) from the collection of documents. The values in the matrix typically reflect the number of times each term appears in each document. A DTM transforms the unstructured text into a format that machine learning models can work with.</p>
<p>The first step to getting to a DTM with <code>text2vec</code> is to create a “vectorizer”. A vectorizer translates tokenized text into a numeric matrix format, such as a DTM. <code>vocab_vectorizer()</code> creates a function that will take batches of documents, compare them to the vocabulary we built, and produce the associated components of the DTM.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vectorizer</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   helper function to convert streams of text into DTM</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>vectorizer <span class="ot">&lt;-</span> <span class="fu">vocab_vectorizer</span>(vocab)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's see what this function looks like!</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>vectorizer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (iterator, grow_dtm, skip_grams_window_context, window_size, 
    weights, binary_cooccurence = FALSE) 
{
    vocab_corpus_ptr = cpp_vocabulary_corpus_create(vocabulary$term, 
        attr(vocabulary, "ngram")[[1]], attr(vocabulary, "ngram")[[2]], 
        attr(vocabulary, "stopwords"), attr(vocabulary, "sep_ngram"))
    setattr(vocab_corpus_ptr, "ids", character(0))
    setattr(vocab_corpus_ptr, "class", "VocabCorpus")
    corpus_insert(vocab_corpus_ptr, iterator, grow_dtm, skip_grams_window_context, 
        window_size, weights, binary_cooccurence)
}
&lt;bytecode: 0x000001c7958ba5b8&gt;
&lt;environment: 0x000001c7958af118&gt;</code></pre>
</div>
</div>
<p>It is a little difficult to interpret, but we can see that it is going to take in a iterator over our tokenized documents and produce something that will (hopefully!) be useful. Let’s give it a try.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the document-term matrix (DTM)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   row represents a document</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   column represents a unique term (word or phrase)</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   cell contains the count (or weight) of that term in the document</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>oisDTM <span class="ot">&lt;-</span> <span class="fu">create_dtm</span>(tokens, vectorizer)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>oisDTM[<span class="dv">65</span><span class="sc">:</span><span class="dv">74</span>, <span class="dv">415</span><span class="sc">:</span><span class="dv">424</span>] <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              20-34 20-33 20-32 20-31 20-30 20-29 20-26 20-24 20-23 20-20
affair            0     0     0     0     0     0     0     0     0     0
intern            0     0     0     0     0     0     0     0     0     0
intern_affair     0     0     0     0     0     0     0     0     0     0
offic_offic       0     3     0     0     0     0     0     0     0     1
sever             0     1     0     0     0     0     3     1     0     5
wound             0     0     1     1     0     1     2     0     0     0
complain          0     0     4     0     0     0    23     0     0     0
dure              0     0     1     0     0     1     0     0     0     0
duti              0     0     0     0     0     0     0     0     0     0
park              0     0     0     1     1     2     3     0     0     0</code></pre>
</div>
</div>
<p>We have a DTM! I have picked a few interesting rows and columns. I also transposed the DTM so it is more readable, but typically the rows are documents and columns are terms. You can see a few non-zero counts in this matrix. These indicate which documents include these terms and how many times that term appears in the document.</p>
<p>Let’s explore further.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of documents and words</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(oisDTM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 133 518</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rows represent individual OIS shooting reports</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(oisDTM)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "24-37" "24-36" "24-35" "24-32" "24-31"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># columns are the words/phrases</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(oisDTM)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]     <span class="co"># feature names</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "advanc_toward"   "announc"         "approach_driver" "cartridg"       
 [5] "district_place"  "district_polic"  "drop_gun"        "due"            
 [9] "fled_scene"      "gave"           </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many vocab words in document?</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(oisDTM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>24-37 24-36 24-35 24-32 24-31 24-30 24-29 24-28 24-27 24-23 24-22 24-21 24-20 
   56    71   118    56    63    63    62    59    43    84    83    84    96 
24-18 24-17 24-15 24-14 24-13 24-12 24-10 24-09 24-08 24-07 24-06 24-05 24-04 
  110    78   101    81    98   150    95   141   116    96    98   184   242 
24-03 24-02 24-01 23-33 23-31 23-29 23-27 23-26 23-25 23-24 23-23 23-21 23-14 
  101    93   105    74   138    79   142   112    97    92   108   108   101 
23-13 23-10 23-04 22-27 22-26 22-24 22-22 22-15 22-14 22-10 22-09 22-08 22-07 
   77    99   159   116   165   114    94   169   130   251   100   105   113 
22-06 22-05 22-04 22-03 22-01 21-15 21-14 21-12 21-10 21-09 21-06 21-04 20-34 
  179   140    89    98    94    93    92   165   163    70   109   174    65 
20-33 20-32 20-31 20-30 20-29 20-26 20-24 20-23 20-20 20-15 20-12 20-08 20-07 
  159   143   105   124   115   292   135   104   204   116   126   139   103 
19-23 19-21 19-20 19-14 19-13 19-11 19-09 19-06 19-04 18-28 18-27 18-26 18-25 
  133   106   166    92   152   118   166   140   131   137   136   136   120 
18-22 18-19 18-17 18-16 18-12 18-08 18-02 18-01 17-37 17-36 17-30 17-28 17-25 
   96   110   133   134    87    92   102   147   145   101    78    78   104 
17-23 17-22 17-20 17-19 17-17 17-13 17-03 16-43 16-40 16-38 16-37 16-35 16-34 
  135   104    93   106   121   114   135   140   150   111   161   137    87 
16-33 16-32 16-30 16-29 16-28 16-19 16-18 16-16 16-13 16-12 16-11 16-10 16-07 
  174   141   143   127    98    92   114   105   109   130   135   129   119 
16-03 16-02 16-01 
  173   131   113 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many documents have these words?</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(oisDTM)[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  advanc_toward         announc approach_driver        cartridg  district_place 
             10              10              10              10              10 
 district_polic        drop_gun             due      fled_scene            gave 
             10              10              10              10              10 
    ground_drop      hand_offic   hospit_critic    hospit_polic            june 
             10              10              10              10              10 
          knock            lost          notifi      offic_drew      offic_oper 
             10              10              10              10              10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most common words?</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(oisDTM) <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> offend suspect   point    door   shoot     two   avenu     dog  toward  patrol 
    308     110     105     103     102     101      99      93      93      90 </code></pre>
</div>
</div>
</section>
<section id="term-frequencyinverse-document-frequency" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="term-frequencyinverse-document-frequency"><span class="header-section-number">2.2</span> Term Frequency–Inverse Document Frequency</h2>
<p>While raw term counts in a document-term matrix tell us how often each word appears, they do not account for how informative or distinctive those words are across the entire collection of documents. Common words like “officer” or “incident” may appear frequently in every report, but they are not useful for distinguishing one document from another. Term frequency-inverse document frequency (TF-IDF) improves on this by weighting terms based on how frequently they appear in a specific document and how rare they are across all documents. This highlights terms that are both common within a document and uncommon elsewhere, making them more meaningful for identifying the unique content of each report.</p>
<p>Term Frequency-Inverse Document Frequency (TF-IDF) gives weights to words in a document in a way that balances:</p>
<ol type="1">
<li><em>Term Frequency</em> (TF): This word must be important in this document</li>
</ol>
<ul>
<li>The more a word appears in a document, the more likely it is to be relevant to the document’s content</li>
<li>If the word “shooting” appears 12 times in a police report, it is probably central to that document</li>
</ul>
<ol start="2" type="1">
<li><em>Inverse Document Frequency</em> (IDF): But if it appears in every document, it is not very informative</li>
</ol>
<ul>
<li>Common words like “officer”, “incident”, or “said” might appear everywhere</li>
<li>IDF <em>downweights</em> those high-frequency but low-discrimination terms</li>
<li>It prefers terms that help <em>distinguish</em> one document from others</li>
</ul>
<p>The formula for TF-IDF for document <span class="math inline">\(i\)</span> and term <span class="math inline">\(j\)</span>:</p>
<p><span class="math display">\[
\mathrm{tfidf}_{ij} = \mathrm{TF}_{ij}\log\frac{N}{\mathrm{DF}_j}
\]</span> where</p>
<ul>
<li><span class="math inline">\(\mathrm{TF}\)</span> is the number of times term <span class="math inline">\(j\)</span> appears in document <span class="math inline">\(i\)</span>. It measures the importance of the term within a document</li>
<li><span class="math inline">\(N\)</span> = total number of documents</li>
<li><span class="math inline">\(\mathrm{DF}_j\)</span> = number of documents containing term <span class="math inline">\(j\)</span></li>
</ul>
<p><span class="math inline">\(\mathrm{IDF}_{ij}=\log\frac{N}{\mathrm{DF}_j}\)</span> captures the rarity across documents. Note that if a word appears in all documents then <span class="math inline">\(\mathrm{tfidf}_{ij} = 0\)</span>. The combination of <span class="math inline">\(\mathrm{TF}\)</span> and <span class="math inline">\(\mathrm{IDF}\)</span> gives a measure of relevance and distinctiveness. A high <span class="math inline">\(\mathrm{tfidf}_{ij}\)</span> means a term appears often in document <span class="math inline">\(i\)</span>, but rarely in other documents. It gives you terms that define a document. These are the terms that are useful for classification, clustering, or topic modeling.</p>
<section id="example" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="example"><span class="header-section-number">2.2.1</span> Example</h3>
<p>Assume there are <span class="math inline">\(N=100\)</span> documents.</p>
<table class="table">
<thead>
<tr class="header">
<th>Term</th>
<th>TF in Doc A</th>
<th>DF across corpus</th>
<th>IDF</th>
<th>TF-IDF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“weapon”</td>
<td>5</td>
<td>10</td>
<td>2.3</td>
<td>11.5</td>
</tr>
<tr class="even">
<td>“officer”</td>
<td>6</td>
<td>95</td>
<td>0.1</td>
<td>0.3</td>
</tr>
<tr class="odd">
<td>“said”</td>
<td>20</td>
<td>100</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<ul>
<li>“weapon” gets a high score, specific and relevant</li>
<li>“officer” is common, downweighted</li>
<li>“said” is everywhere, zeroed out</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># TF-IDF: term frequency–inverse document frequency weights</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co">#    downweights common words that appear in many documents</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">#    upweights rare words that are more informative or distinctive</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># TF: How often a word appears in a document</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># IDF: How rare that word is across all documents</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co">#    TF-IDF = TF × log(N / DF)</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">#       N = total number of documents</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">#       DF = number of documents containing the term</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>tfidf_transformer <span class="ot">&lt;-</span> TfIdf<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>oisTFIDF <span class="ot">&lt;-</span> tfidf_transformer<span class="sc">$</span><span class="fu">fit_transform</span>(oisDTM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s take a look at those same rows and columns that we did before for the DTM. The matrix looks largely the same, just everything scaled down.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>oisTFIDF[<span class="dv">65</span><span class="sc">:</span><span class="dv">74</span>, <span class="dv">415</span><span class="sc">:</span><span class="dv">424</span>] <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">t</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              20-34 20-33 20-32 20-31 20-30 20-29 20-26 20-24 20-23 20-20
affair            0  0.00  0.00  0.00  0.00  0.00  0.00  0.00     0  0.00
intern            0  0.00  0.00  0.00  0.00  0.00  0.00  0.00     0  0.00
intern_affair     0  0.00  0.00  0.00  0.00  0.00  0.00  0.00     0  0.00
offic_offic       0  0.03  0.00  0.00  0.00  0.00  0.00  0.00     0  0.01
sever             0  0.01  0.00  0.00  0.00  0.00  0.02  0.01     0  0.04
wound             0  0.00  0.01  0.01  0.00  0.01  0.01  0.00     0  0.00
complain          0  0.00  0.07  0.00  0.00  0.00  0.20  0.00     0  0.00
dure              0  0.00  0.01  0.00  0.00  0.01  0.00  0.00     0  0.00
duti              0  0.00  0.00  0.00  0.00  0.00  0.00  0.00     0  0.00
park              0  0.00  0.00  0.02  0.01  0.03  0.02  0.00     0  0.00</code></pre>
</div>
</div>
<p>Let’s compare the top features.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View top features by TF</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(oisDTM) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> offend suspect   point    door   shoot     two   avenu     dog  toward  patrol 
    308     110     105     103     102     101      99      93      93      90 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View top features by TF-IDF</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(oisTFIDF) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      offend          dog      suspect        shoot        knife        avenu 
    3.124350     2.212498     1.819930     1.134967     1.098324     1.087595 
      driver       victim        resid polic_vehicl 
    1.000676     1.000078     0.993729     0.993306 </code></pre>
</div>
</div>
<p>The TF-IDF does change which terms make the top-10 list. We see “knife” and “driver” show up and “door” and “point” drop off.</p>
<!-- Why does "resid" show up in this list? -->
<!-- ```{r} -->
<!-- oisDTM[,"resid"] -->
<!-- # highlight the word "post" in the report -->
<!-- ois |>  -->
<!--   filter(id=="20-20") |>  -->
<!--   pull(text) |>  -->
<!--   gsub("resid", bgYellow$black("resid"), x=_) |>  -->
<!--   cat() -->
<!-- ``` -->
</section>
</section>
</section>
<section id="term-co-occurrence-matrix-tcm" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Term co-occurrence matrix (TCM)</h1>
<p>There may be some concepts that are not limited to a single word or a few adjacent words. Term co-occurrence looks for words that tend to appear close to each other in text to possibly help you expand the vocabulary to additional phrases. A term co-occurrence matrix (TCM) captures how often pairs of words appear near each other within a given window of text, such as a sentence or a few neighboring words. Unlike a document-term matrix, which represents the relationship between documents and individual terms, a TCM focuses on the relationships between terms themselves. This is useful for uncovering word associations and identifying common phrases. In our case, we will use the TCM to explore how certain words, such as “officer,” “suspect,” or “weapon,” tend to co-occur across police shooting reports, revealing patterns that might not be visible from frequency counts alone.</p>
<p>When scanning through each document, setting <code>skip_grams_window = 5</code> will treat any two terms that appear within a window of 5 tokens as co-occurring. For example, if the document has the phrase “the officer shot the suspect with a weapon” and we set <code>skip_grams_window = 5</code>, then for the word “shot” it will consider “the”, “officer”, “the”, “suspect”, “with” as co-occurring terms.</p>
<p>We will use <code>create_tcm()</code> to create a TCM. The <span class="math inline">\((i,j)\)</span> element of the TCM will be the number of times term <span class="math inline">\(i\)</span> occurs within 5 terms of term <span class="math inline">\(j\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a co-occurrence matrix (Feature Co-occurrence Matrix)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>oisTCM <span class="ot">&lt;-</span> <span class="fu">itoken</span>(ois<span class="sc">$</span>text,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">tokenizer =</span> oisTokenizer,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">progressbar =</span> <span class="cn">FALSE</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ids =</span> ois<span class="sc">$</span>id) <span class="sc">|&gt;</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">create_tcm</span>(<span class="fu">vocab_vectorizer</span>(vocab), </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">skip_grams_window =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This will be a little easier to visualize if we convert to a long (rather than wide) format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to triplet format and extract top co-occurring pairs</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>oisPairs <span class="ot">&lt;-</span> Matrix<span class="sc">::</span><span class="fu">summary</span>(oisTCM) <span class="sc">|&gt;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(i <span class="sc">!=</span> j) <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">feature1 =</span> i, <span class="at">feature2 =</span> j, <span class="at">weight =</span> x) <span class="sc">|&gt;</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">data.frame</span>(<span class="at">feature1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(oisTCM),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">term1 =</span> <span class="fu">colnames</span>(oisTCM)),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(feature1))  <span class="sc">|&gt;</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">data.frame</span>(<span class="at">feature2 =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(oisTCM),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">term2 =</span> <span class="fu">colnames</span>(oisTCM)),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(feature2)) <span class="sc">|&gt;</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>feature1, <span class="sc">-</span>feature2) <span class="sc">|&gt;</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term1 <span class="sc">!=</span> term2) <span class="sc">|&gt;</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(term1, <span class="fu">fixed</span>(term2)) <span class="sc">&amp;</span> </span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>           <span class="sc">!</span><span class="fu">str_detect</span>(term2, <span class="fu">fixed</span>(term1)))</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>oisPairs <span class="sc">|&gt;</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(weight)) <span class="sc">|&gt;</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     weight                  term1               term2
1  30.00000           offic_provid       provid_inform
2  30.00000               lead_new          new_inform
3  30.00000          investig_lead            lead_new
4  30.00000              may_updat      updat_investig
5  30.00000              incid_may           may_updat
6  30.00000              incid_may         short_incid
7  30.00000             occur_time          time_incid
8  30.00000             occur_time    understand_occur
9  30.00000 preliminari_understand    understand_occur
10 30.00000 preliminari_understand reflect_preliminari
11 30.00000                reflect         preliminari
12 30.00000    reflect_preliminari     summari_reflect
13 30.00000                reflect             summari
14 30.00000         origin_summari     summari_reflect
15 30.00000                summari              origin
16 30.00000         origin_summari         post_origin
17 30.00000             understand         preliminari
18 30.00000          investig_lead      updat_investig
19 30.00000                   lead                 new
20 30.00000             post_short         short_incid
21 30.00000         investig_prior        ppd_investig
22 29.50000            prior_charg         charg_decis
23 29.50000            prior_charg      investig_prior
24 25.00000                 affair              intern
25 24.00000              administr                duti
26 24.00000                 outcom                pend
27 24.00000              administr               place
28 23.50000              duti_pend      administr_duti
29 23.50000                   duti                pend
30 23.00000         administr_duti     place_administr
31 23.00000              duti_pend         pend_outcom
32 20.00000           ppd_investig               prior
33 20.00000                   lead          new_inform
34 20.00000          investig_lead                 new
35 20.00000          investig_lead               updat
36 20.00000              incid_may               updat
37 20.00000             occur_time          understand
38 20.00000    reflect_preliminari          understand
39 20.00000 preliminari_understand             reflect
40 20.00000        summari_reflect         preliminari
41 20.00000    reflect_preliminari             summari
42 20.00000        summari_reflect              origin
43 20.00000            post_origin             summari
44 20.00000         origin_summari             reflect
45 20.00000                   lead      updat_investig
46 20.00000       understand_occur         preliminari
47 19.86667            charg_decis               prior
48 19.66667            prior_charg               decis
49 19.25000                   mark              patrol
50 18.50000                  stabl              condit</code></pre>
</div>
</div>
<p>Much of this co-occurrence is due to the template language describing where the department is in the investigation, referrals to the district attorney, and the report offers preliminary summary.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Template language on the report">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Template language on the report
</div>
</div>
<div class="callout-body-container callout-body">
<p>*** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The District Attorney’s Office is provided all the information from the PPD’s investigation prior to their charging decision.</p>
</div>
</div>
<p>Further on down the list some term pairs a more interesting.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>oisPairs <span class="sc">|&gt;</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weight <span class="sc">&gt;=</span> <span class="dv">8</span> <span class="sc">&amp;</span> weight <span class="sc">&lt;=</span><span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(weight))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     weight                 term1             term2
1  9.000000        firearm_strike  discharg_firearm
2  9.000000        univers_hospit             templ
3  9.000000                driver              door
4  9.000000                  open              door
5  8.999996             duti_pend             place
6  8.750000                attack               dog
7  8.666667         respond_radio              call
8  8.666667 affair_officer-involv             shoot
9  8.666667 affair_officer-involv            intern
10 8.500000       inform_district        new_inform
11 8.500000                intern              pend
12 8.500000        attorney_offic      offic_provid
13 8.500000       inform_district district_attorney
14 8.500000            offic_mark        mark_polic
15 8.500000                return              fire
16 8.500000          semi-automat            pistol
17 8.500000                  drop            offend
18 8.250000           pend_outcom     intern_affair
19 8.250000         outcom_intern         duti_pend
20 8.250000                outcom            affair
21 8.250000                  miss            offend
22 8.250000                 knife              drop
23 8.000001                unmark      polic_vehicl
24 8.000000                 arriv             locat</code></pre>
</div>
</div>
</section>
<section id="singular-value-decomposition-for-text" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Singular value decomposition for text</h1>
<p>We already explored how SVD can be used to <a href="https://raw.githack.com/gregridgeway/ML4SocialScience/main/L7-svd.html">compress images and classify emojis</a>. Now we will explore what SVD does for text.</p>
<p>Since TFIDF matrices can get large, we will use the SVD implementation in the IRLBA package (Implicitly Restarted Lanczos Bidiagonalization Algorithm). The IRLBA implementation of SVD allows you to limit the number of singular vectors to compute, ignoring and never computing the rest.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(irlba)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>oisSVD <span class="ot">&lt;-</span> <span class="fu">irlba</span>(<span class="fu">t</span>(oisTFIDF), <span class="at">nv =</span> <span class="dv">50</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># each run of SVD can switch the signs on U and V</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co">#    this forces sign(v[1,]) = +1, so SVD is unique</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>oisSVD<span class="sc">$</span>u <span class="ot">&lt;-</span> <span class="fu">sweep</span>(oisSVD<span class="sc">$</span>u, <span class="dv">2</span>, <span class="fu">sign</span>(oisSVD<span class="sc">$</span>v[<span class="dv">1</span>,]), <span class="st">`</span><span class="at">*</span><span class="st">`</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>oisSVD<span class="sc">$</span>v <span class="ot">&lt;-</span> <span class="fu">sweep</span>(oisSVD<span class="sc">$</span>v, <span class="dv">2</span>, <span class="fu">sign</span>(oisSVD<span class="sc">$</span>v[<span class="dv">1</span>,]), <span class="st">`</span><span class="at">*</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s see how many singular vectors seem important. In <a href="#fig-SVDsingularvalues" class="quarto-xref">Figure&nbsp;1</a> we see the first two or three singular values seem large, but then they decrease quite slowly from there.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(oisSVD<span class="sc">$</span>d, </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Index of the singular value"</span>, </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Singular value"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(oisSVD<span class="sc">$</span>d)),</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-SVDsingularvalues" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-SVDsingularvalues-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-SVDsingularvalues-1.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-SVDsingularvalues-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Singular values from SVD of <code>oisTFIDF</code>
</figcaption>
</figure>
</div>
</div>
</div>
<p>The columns of <span class="math inline">\(\mathbf{U}\)</span> are our “eigendocuments,” the fundamental building blocks that the actual documents blend to form their word collections. We will take a look at the first five eigendocuments, highlighting the 10 terms with the highest weight in the left singular vectors. Note that both large positive and large negative values are important to interpret. I have added headings to each left singular vector summarizing what kinds of incidents might heavily weight this column of <span class="math inline">\(\mathbf{U}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stack the top 10 terms from each component into one long table</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">term=</span><span class="fu">colnames</span>(oisTFIDF),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">u1=</span>oisSVD<span class="sc">$</span>u[,<span class="dv">1</span>],</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">u2=</span>oisSVD<span class="sc">$</span>u[,<span class="dv">2</span>],</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">u3=</span>oisSVD<span class="sc">$</span>u[,<span class="dv">3</span>],</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">u4=</span>oisSVD<span class="sc">$</span>u[,<span class="dv">4</span>],</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">u5=</span>oisSVD<span class="sc">$</span>u[,<span class="dv">5</span>])</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(a <span class="sc">|&gt;</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(term, u1) <span class="sc">|&gt;</span> </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(u1))) <span class="sc">|&gt;</span> </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">component =</span> <span class="st">"u1"</span>, <span class="at">u =</span> u1),</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>          a <span class="sc">|&gt;</span> </span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(term, u2) <span class="sc">|&gt;</span> </span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(u2))) <span class="sc">|&gt;</span> </span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">component =</span> <span class="st">"u2"</span>, <span class="at">u =</span> u2),</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>          a <span class="sc">|&gt;</span> </span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(term, u3) <span class="sc">|&gt;</span> </span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(u3))) <span class="sc">|&gt;</span> </span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">component =</span> <span class="st">"u3"</span>, <span class="at">u =</span> u3),</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>          a <span class="sc">|&gt;</span> </span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(term, u4) <span class="sc">|&gt;</span> </span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(u4))) <span class="sc">|&gt;</span> </span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">component =</span> <span class="st">"u4"</span>, <span class="at">u =</span> u4),</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>          a <span class="sc">|&gt;</span> </span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(term, u5) <span class="sc">|&gt;</span> </span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(u5))) <span class="sc">|&gt;</span> </span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>            <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">component =</span> <span class="st">"u5"</span>, <span class="at">u =</span> u5)) <span class="sc">|&gt;</span> </span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(component, term, u) <span class="sc">|&gt;</span> </span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(component) <span class="sc">|&gt;</span> </span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> component, </span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(term, u),</span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term_u1, u_u1, term_u2, u_u2, term_u3, u_u3,</span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>         term_u4, u_u4, term_u5, u_u5) <span class="sc">|&gt;</span></span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"rrrrrrrrrr"</span>,</span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Term"</span>,<span class="st">"</span><span class="sc">\\</span><span class="st">(u_1</span><span class="sc">\\</span><span class="st">)"</span>,<span class="st">"Term"</span>,<span class="st">"</span><span class="sc">\\</span><span class="st">(u_2</span><span class="sc">\\</span><span class="st">)"</span>,</span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Term"</span>,<span class="st">"</span><span class="sc">\\</span><span class="st">(u_3</span><span class="sc">\\</span><span class="st">)"</span>,<span class="st">"Term"</span>,<span class="st">"</span><span class="sc">\\</span><span class="st">(u_4</span><span class="sc">\\</span><span class="st">)"</span>,</span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Term"</span>,<span class="st">"</span><span class="sc">\\</span><span class="st">(u_5</span><span class="sc">\\</span><span class="st">)"</span>),</span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">booktabs =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">"Offender and dog"</span> <span class="ot">=</span> <span class="dv">2</span>, </span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Dog attack, no offender"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Suspect/SWAT"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Knife attacks"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"?"</span> <span class="ot">=</span> <span class="dv">2</span>),</span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a>                   <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Offender and dog
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Dog attack, no offender
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Suspect/SWAT
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Knife attacks
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
?
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
Term
</th>
<th style="text-align:right;">
(u_1)
</th>
<th style="text-align:right;">
Term
</th>
<th style="text-align:right;">
(u_2)
</th>
<th style="text-align:right;">
Term
</th>
<th style="text-align:right;">
(u_3)
</th>
<th style="text-align:right;">
Term
</th>
<th style="text-align:right;">
(u_4)
</th>
<th style="text-align:right;">
Term
</th>
<th style="text-align:right;">
(u_5)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
dog
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
dog
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
suspect
</td>
<td style="text-align:right;">
-0.61
</td>
<td style="text-align:right;">
knife
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
knife
</td>
<td style="text-align:right;">
-0.53
</td>
</tr>
<tr>
<td style="text-align:right;">
offend
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
offend
</td>
<td style="text-align:right;">
-0.31
</td>
<td style="text-align:right;">
dog
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
offic_number
</td>
<td style="text-align:right;">
-0.32
</td>
<td style="text-align:right;">
suspect
</td>
<td style="text-align:right;">
-0.31
</td>
</tr>
<tr>
<td style="text-align:right;">
suspect
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
attack
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
offend
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
number
</td>
<td style="text-align:right;">
-0.30
</td>
<td style="text-align:right;">
offic_number
</td>
<td style="text-align:right;">
-0.24
</td>
</tr>
<tr>
<td style="text-align:right;">
shoot
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
bull
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
swat
</td>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;">
suspect
</td>
<td style="text-align:right;">
-0.28
</td>
<td style="text-align:right;">
number
</td>
<td style="text-align:right;">
-0.20
</td>
</tr>
<tr>
<td style="text-align:right;">
attack
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
pit_bull
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
offic_number
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
number_one
</td>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;">
drop_knife
</td>
<td style="text-align:right;">
-0.19
</td>
</tr>
<tr>
<td style="text-align:right;">
resid
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
pit
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
attack
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
drop_knife
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
number_one
</td>
<td style="text-align:right;">
-0.19
</td>
</tr>
<tr>
<td style="text-align:right;">
victim
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
offic_number
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
number
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
victim
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
offend
</td>
<td style="text-align:right;">
0.14
</td>
</tr>
<tr>
<td style="text-align:right;">
avenu
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
number
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
swat_offic
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
drop
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
rear
</td>
<td style="text-align:right;">
0.13
</td>
</tr>
<tr>
<td style="text-align:right;">
knife
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
number_one
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
number_one
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
bedroom
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
unmark
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:right;">
depart
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
veteran
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
male_suspect
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
offend
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
area
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
</tbody>
</table>
<p>Top 10 Terms for First 5 SVD Components</p>
</div>
</div>
<p>Note that “dog” shows up with a large absolute value in the first three left singular vectors. Even if there is a large negative value, that still means the term is important. A report of shooting a pit bull will have a large negative value for its <span class="math inline">\(v_2\)</span>, signalling a heavy presence of dog, pit bull, and attack terms, but the absence of the “offender” term. The first left singular vector measure the combined presence of “dog,” “offender,” and “suspect” (or the absence of all three if a document’s value of <span class="math inline">\(v_1\)</span> is large and negative.</p>
<p>Remember that the columns of <span class="math inline">\(\mathbf{V}\)</span> tell us how a particular report mixes together the eigendocuments (columns of <span class="math inline">\(\mathbf{U}\)</span>) to form their TFIDF weighted terms. I am curious to explore documents involving dog attacks (<span class="math inline">\(\mathbf{u}_2\)</span>) and documents with knife attacks (<span class="math inline">\(\mathbf{u}_4\)</span>). The code below creates an interactive 2D map of documents on their values of <span class="math inline">\(v_2\)</span> and <span class="math inline">\(v_4\)</span>. For each document, the code extracts the 10 most heavily weighted TF-IDF terms to use as hover text, giving a quick sense of the content. It also assigns each document to a category, “Likely dog attack,” “Likely knife attack,” or “Other,” based on thresholds of <span class="math inline">\(v_2\)</span> and <span class="math inline">\(v_4\)</span>. <code>plotly()</code> produces an interactive scatterplot where each point is a document, colored by category and annotated with its key terms. This visualization allows us to explore thematic variation in the reports and visually distinguish different types of incidents based on the language used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># collect the 10 terms with the highest weight in each document</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">apply</span>(oisTFIDF, <span class="dv">1</span>, order, <span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>hovertext <span class="ot">&lt;-</span> <span class="fu">apply</span>(i, <span class="dv">2</span>, </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(j) </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                   {</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">colnames</span>(oisTFIDF)[j[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]] <span class="sc">|&gt;</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste</span>(<span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>                   })</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co"># label some document types</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">case_when</span>(oisSVD<span class="sc">$</span>v[,<span class="dv">2</span>] <span class="sc">&gt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"Likely dog attack"</span>,</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>                   oisSVD<span class="sc">$</span>v[,<span class="dv">4</span>] <span class="sc">&gt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"Likely knife attack"</span>,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>                   <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>groupCols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Likely dog attack"</span> <span class="ot">=</span> <span class="st">"red"</span>,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Likely knife attack"</span> <span class="ot">=</span> <span class="st">"orange"</span>,</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co"># make a plot with hovertext</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> oisSVD<span class="sc">$</span>v[,<span class="dv">2</span>],</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> oisSVD<span class="sc">$</span>v[,<span class="dv">4</span>],</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"scatter"</span>,</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">"markers"</span>,</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> hovertext,</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> group,</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">colors =</span> groupCols,</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"V2 - Dog attack measure"</span>),</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"V4 - Knife attack measure"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-documentMap" class="cell-output-display quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-documentMap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8c7dc286e5fc93dee9d4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8c7dc286e5fc93dee9d4">{"x":{"visdat":{"7170447d32e2":["function () ","plotlyVisDat"]},"cur_data":"7170447d32e2","attrs":{"7170447d32e2":{"x":[0.1816187558778968,0.11572360794264433,-0.0019788713728065501,0.17877124283368376,0.022223821264152965,0.18259981991707072,0.11707134487490913,0.061167241620392283,0.05572097583763197,0.16850678364637398,0.16374104976200635,0.048273649645646489,0.03392644180911452,0.21204170471713846,0.020547903854837676,0.14751141714765933,0.27223024324059203,0.21900917326533442,0.018577428260032738,0.15651561529202301,0.0081574778119158625,0.21117828010095693,0.044146742468963572,0.16906490917093725,-0.020444727606716506,-0.019688882975228656,0.033479502282273005,0.044488847114346121,0.16140495714203171,0.12915289262487126,0.03895561051542823,0.14319779874135447,0.034513205577909788,0.15715001234373485,0.010288774058011624,0.028026034813560963,0.0051619495486400742,-0.010960374257623919,-0.03080148511732194,0.0034805026327011756,-0.045372966560736021,-0.029218619199922261,-0.015818943890176771,0.021759934033232578,-0.10195414139595667,-0.075582185895513548,0.0082711645406465945,-0.0038160328205497133,-0.0090294497149070087,0.011946510583231547,-0.047846038911684416,-0.074302718196757281,-0.0061615587655333712,-0.069463137440628417,-0.038615261481704036,-0.0054909352281676234,0.0039205632203707253,-0.075457978192815828,-0.05517922014072589,-0.0073223667718192546,-0.041430095428083936,-0.038567735799592148,-0.017835534277815351,-0.044649955663984484,-0.055517186343691204,-0.043525980650874097,-0.010785309029566511,-0.018800689621417527,-0.035265350888931443,-0.0523682796404083,-0.051409710766081883,-0.034207072019543608,-0.040655204858792739,-0.038890557656961339,-0.038987763380822132,-0.04295121299162722,-0.045648128441618224,-0.054518156209488945,-0.046373272434632039,-0.039908186961754459,-0.04441460591625912,-0.06632044621167299,-0.044769638626015643,-0.047357828271610017,-0.052404098414888099,-0.05930702712397394,-0.056645432021001363,-0.041634832202926485,-0.046675899727654478,-0.034090937987938885,-0.050356933614642461,-0.055910170380922851,-0.054914686535615528,-0.05687143149874474,-0.037538002449116509,-0.091381277492467064,-0.090664280006922851,-0.074810860787178537,-0.1052499187615067,-0.067975793704709159,-0.069922810025450491,-0.069184758056329815,-0.080422748552774426,-0.12826536685842213,-0.11433017564914463,-0.068300567015818728,-0.088807493305146909,-0.06933895325550278,-0.070404913327719407,-0.10441397207560424,-0.12601040650083331,-0.077758409185438138,-0.10359195495726557,-0.11536478039227681,-0.096572852746188959,-0.084222345514686159,-0.089363072445301242,-0.096011491137984864,-0.082579749139763028,-0.088826183218488536,-0.071017011830248833,-0.080397971558563985,-0.070219817169284313,-0.079212195080423028,-0.089976583088172052,-0.087500908125515309,-0.087191210821466775,-0.10666919804154282,-0.094477686770881295,-0.088159755127270478,-0.081527310486232643,-0.078845635288057936,-0.095375442585102665],"y":[0.001783370878443198,0.026569286265514358,0.028062219000325447,0.0016155413579487447,-0.0012174507505060932,0.0054863465404168844,-0.02924999282577077,-0.016032324730353455,-0.0095094548182552141,0.014377483980066011,-0.031890670339162493,-0.088578753762321674,-0.14080769307723751,-0.0089616712152539614,-0.088041055984498268,-0.012268508971865091,-0.05602680326379076,-0.034467898616002142,-0.14510182790859552,-0.010958400083721226,0.0640701424120277,-0.025347629861139313,-0.093242097426257761,-0.008672291844130051,0.0020048805512984918,-0.054342424489183638,-0.036637891451627227,-0.05753142780020621,0.0020293933058226914,0.0037744216461390182,-0.060228857146685147,0.016466450689725843,-0.033350262364861077,-0.011107182227913816,-0.021807971564355103,0.022369394719026624,-0.034592975321655665,0.0026087999263642464,0.075699193612742813,0.057166765509667365,0.019873437187983262,-0.00039815745098094866,0.050391398706270699,0.017951521749537597,0.097036808972095087,0.13457920790383091,0.11057925167590532,0.042379116951024712,0.062577481071959762,0.028035523811704145,-0.0047856841845446358,0.30646312055344366,0.034588446579626363,0.033633104999054086,0.0060864595370666357,0.088353965926886838,0.052217714108848019,0.11264483928614316,0.090615666836766806,0.03313434403820871,0.02384876200724128,0.011727398691738894,0.077349495067084384,-0.00052047555691053197,0.12332948577297553,0.30955549960705986,-0.077075957077809426,0.077759064476345313,-0.099286074576175859,0.35559668715477799,0.060974168727250408,0.020029917711219997,0.021797952052792297,0.010154282915939854,0.015760206177842535,-0.0091853272269319976,-0.015159159052059831,-0.034761383506974372,0.023848730831525243,-0.031677899322745985,0.053423382053373242,-0.027042924317941561,-0.051288222993426134,0.0097846125264492191,-0.017466716242593088,0.011245255456921364,0.17499752751217973,0.097226821318501772,0.010986243071695195,0.04636857699741715,-0.019639765015640343,-0.025923798349069816,-0.037341552706523139,0.0083973836661509309,0.013806815505300628,0.015582341250898836,-0.096390797147250587,-0.0077047404613872546,-0.21005101157350364,-0.04108662161914909,-0.050921668865838272,0.14042189150604412,-0.082157268913773326,-0.23757147088370797,-0.28450182634789972,-0.017204463556086257,-0.017328912428150194,0.0081800960879801401,-0.0176219199279696,0.02022960023945455,-0.30392183026855596,-0.014616193536109021,-0.10107790204162465,-0.14796624660787525,0.11687641456827716,-0.13164228991861263,-0.001132098588962383,-0.0020871810885490639,0.067370922661573199,-0.022110814479791897,-0.0036648986243316508,-0.030175276321227445,-0.030783965257856028,0.042302826451644515,-0.010741623006342552,-0.015500325869967361,0.01939396339257702,-0.010541969650640482,0.010025767359612602,-0.038600183460217617,-0.024154673753718017,-0.041228465201163675,-0.029925815214598545],"mode":"markers","text":["dog<br />narcot<br />back<br />secur<br />unit<br />insid_properti<br />compli<br />onc<br />tuesday<br />retreat","dog<br />district_offic<br />femal<br />polic_district<br />bedroom<br />insid<br />kill<br />locat_offic<br />call_person<br />offic_heard","servic<br />sergeant<br />year<br />wit<br />involv<br />male_point<br />investig_unit<br />home<br />unknown<br />complain","dog<br />narcot<br />block_e<br />resid<br />retreat<br />involv_shoot<br />kitchen<br />offic_involv<br />bull<br />pit_bull","detect<br />shoot<br />seat<br />person<br />unit<br />homicid<br />vehicl_approach<br />investig_unit<br />involv_shoot<br />offic_involv","dog<br />femal<br />partner<br />insid<br />kill<br />went<br />avenu<br />outsid<br />home<br />offic_heard","dog<br />septemb<br />encount<br />white<br />area<br />avenu<br />scene_injuri<br />camera_activ<br />retreat<br />subsequ","injur<br />polic_district<br />polic_depart<br />veteran<br />depart<br />investig_unit<br />duti<br />conduct<br />septemb<br />offic_transport","room<br />district_place<br />one_round<br />duti<br />discharg_one<br />incid_offic<br />place<br />affair_investig<br />septemb<br />shoot","dog<br />resid<br />polic_depart<br />dure<br />assault<br />depart<br />shout<br />went<br />use<br />district_place","dog<br />west<br />anim<br />bull<br />pit_bull<br />pit<br />kill<br />servic<br />june<br />offic_arriv","suspect<br />one_offic<br />year<br />shot<br />discharg_offic<br />driver<br />male_suspect<br />june<br />use<br />blue","suspect<br />block_north<br />saturday<br />uniform_offic<br />north<br />unit<br />due<br />june<br />district_place<br />conduct","dog<br />resid<br />attack<br />ongo<br />block_north<br />medic<br />two<br />north<br />black<br />anim","suspect<br />graze<br />male_suspect<br />white<br />robberi<br />off-duti<br />sustain<br />dure<br />wound<br />announc","sergeant<br />bull<br />pit_bull<br />pit<br />discharg_offic<br />attack<br />also<br />year_old<br />old<br />dog","attack<br />dog<br />bull<br />pit_bull<br />pit<br />kill<br />year<br />anim<br />district_place<br />larg","attack<br />dog<br />owner<br />bull<br />pit_bull<br />block_south<br />pit<br />control<br />femal<br />south","suspect<br />off-duti<br />assault<br />robberi<br />take<br />struggl<br />dure<br />male_suspect<br />remain<br />violat","dog<br />kill<br />wit<br />bull<br />pit_bull<br />pit<br />attack<br />bodi<br />victim<br />depart","complain<br />front_door<br />knock<br />outsid<br />taken<br />unit<br />subsequ<br />took<br />arm<br />front","bull<br />pit_bull<br />pit<br />dog<br />attack<br />owner<br />control<br />stop<br />discharg_offic<br />offic_offic","suspect<br />stolen<br />vehicl_offic<br />polic_district<br />driver<br />attempt<br />male_suspect<br />black<br />fled_scene<br />approach_driver","dog<br />attack<br />anim<br />depart<br />avenu<br />later<br />polic_depart<br />shout<br />highway<br />bodi_worn","magazin<br />block_north<br />offend<br />park<br />black<br />north<br />live<br />handgun<br />live_round<br />round","passeng<br />suspect<br />open<br />driver<br />door<br />strike_offic<br />driver_side<br />window<br />fled_scene<br />side","suspect<br />veteran_philadelphia<br />templ_univers<br />univers_hospit<br />depart_assign<br />shot<br />univers<br />shoot<br />person<br />polic_depart","swat<br />suspect<br />swat_offic<br />assist<br />year_old<br />respond_offic<br />old<br />still<br />year<br />direct","dog<br />yard<br />bull<br />pit_bull<br />owner<br />pit<br />resid<br />year_old<br />old<br />year","block_south<br />resid<br />dog<br />south<br />offic_offic<br />drew_weapon<br />made<br />bull<br />pit_bull<br />polic_offic","highway<br />graze<br />suspect<br />patrol<br />veteran_philadelphia<br />depart_assign<br />polic_depart<br />veteran<br />assault<br />depart","dog<br />attack<br />victim<br />wit<br />violat<br />home<br />highway<br />bull<br />pit_bull<br />bodi_worn","suspect<br />sergeant<br />home<br />depart<br />encount<br />shot<br />veteran<br />involv<br />verbal<br />one_time","dog<br />anim<br />remain<br />control<br />dure_incid<br />injur<br />three<br />sustain<br />polic_depart<br />dure","suspect<br />shoot<br />victim<br />passeng<br />pronounc_deceas<br />deceas<br />driver<br />unit<br />pronounc<br />wound","suspect<br />knife<br />ecw<br />deploy<br />offic_respond<br />began<br />advanc_toward<br />step<br />male_suspect<br />white","robberi<br />victim<br />suspect<br />approach_male<br />polic_vehicl<br />gun<br />follow<br />vehicl_offic<br />phone<br />drop_gun","side_door<br />door_offic<br />side<br />passeng<br />approach_driver<br />passeng_side<br />car<br />driver_side<br />driver<br />onto","lot<br />gun_offic<br />rear<br />bodi<br />ground<br />car<br />handgun<br />gun<br />pm_offic<br />strike_male","phone<br />detect<br />swat<br />one_time<br />properti<br />struck<br />enter<br />bedroom<br />swat_offic<br />announc","offend<br />offic_involv<br />gun_offic<br />observ_offend<br />area<br />involv<br />discharg_offic<br />turn<br />left<br />offic_offic","offic_involv<br />offend<br />side_door<br />involv<br />involv_shoot<br />side<br />taken<br />block_north<br />driver<br />shoot","swat<br />gsw<br />sustain<br />unit<br />insid_properti<br />front<br />properti<br />north<br />offend<br />rear","fire<br />cover<br />veteran_philadelphia<br />depart_assign<br />polic_depart<br />veteran<br />depart<br />district_offic<br />approach_male<br />arriv_locat","offend<br />gun<br />point_gun<br />lot<br />drop_gun<br />offend_drop<br />gun_offic<br />around<br />began<br />drop","offend<br />victim<br />east<br />handgun<br />gun<br />one_time<br />locat<br />return<br />partner<br />point_gun","victim<br />one_time<br />shot<br />shoot<br />left<br />unknown<br />area<br />south<br />homicid<br />shoulder","room<br />offic_offic<br />oper<br />hospit_polic<br />open_door<br />discharg_offic<br />sever_time<br />window<br />templ_hospit<br />pull","gsw<br />victim<br />discharg_offic<br />locat<br />offic_arriv<br />locat_offic<br />arriv_locat<br />gunshot<br />believ<br />head","secur<br />unknown<br />westbound<br />pursuit<br />avenu<br />return<br />black_male<br />activ<br />black<br />front","passeng<br />refer<br />rear<br />unmark<br />unmark_vehicl<br />area<br />want<br />struck<br />window<br />pm_offic","bedroom<br />knife<br />offend<br />victim<br />observ_offend<br />resid<br />arm<br />wit<br />front<br />enter","floor<br />polic_offic<br />swat<br />door<br />magazin<br />warrant<br />unit<br />search<br />point_offic<br />vest","offend<br />unmark_vehicl<br />black<br />wear<br />unmark<br />drove<br />unknown<br />intersect<br />time_offic<br />handgun","stolen<br />partner<br />point_gun<br />black<br />taken<br />pursuit<br />street_offic<br />run<br />point<br />district_offic","arriv_locat<br />corner<br />gun<br />drop<br />drop_gun<br />verbal<br />locat<br />front<br />ground_drop<br />polic_civilian","swat<br />announc<br />swat_offic<br />door<br />addit<br />south<br />order<br />assault<br />insid<br />knock","offend<br />encount<br />head<br />arm<br />point_offic<br />near<br />struck<br />fell<br />dure<br />wound","rifl<br />offend<br />homicid<br />believ<br />gunfir<br />multipl<br />gunshot<br />area<br />involv<br />direct","respond_offic<br />run<br />point<br />polic_offic<br />observ_male<br />male_point<br />offic_observ<br />walk<br />weapon_male<br />avenu","park<br />polic_offic<br />westbound<br />still<br />seat<br />foot<br />behind<br />driver_seat<br />cover<br />car","unmark_vehicl<br />corner<br />bodi<br />unmark<br />medic<br />north<br />point_gun<br />narcot<br />wound<br />oper_unmark","road<br />bodi<br />front<br />refer<br />two<br />live<br />toward<br />civilian<br />turn<br />resid","passeng<br />rear<br />driver<br />request<br />posit<br />broad<br />due<br />blue<br />passeng_side<br />approach","victim<br />offend<br />pronounc<br />weapon_offend<br />polic_civilian<br />highway<br />drew_weapon<br />larg<br />torso<br />ongo","knife<br />drop_knife<br />strike_male<br />drop<br />toward_offic<br />advanc_toward<br />arm<br />shout<br />advanc<br />deploy","suspect<br />swat_offic<br />swat<br />femal<br />properti<br />male_suspect<br />complain<br />road<br />point<br />white","properti<br />swat<br />black_male<br />black<br />driveway<br />went<br />locat<br />side<br />rear<br />full_uniform","suspect<br />vehicl_offic<br />polic_vehicl<br />gave<br />move<br />oper<br />driver<br />east<br />upon<br />point_offic","knife<br />drop_knife<br />drop<br />walk<br />order<br />order_male<br />away<br />back<br />toward<br />park","complain<br />car<br />get<br />floor<br />avenu<br />point<br />observ_male<br />male_arm<br />black<br />intersect","vest<br />rear<br />seat<br />vehicl_offic<br />black<br />area<br />road<br />near<br />unmark_polic<br />driver","unmark_polic<br />narcot<br />unmark<br />polic_vehicl<br />street_offic<br />front<br />black<br />search<br />front_door<br />area","sergeant<br />blue<br />unmark<br />camera<br />sever<br />insid<br />remov<br />run<br />plaincloth_offic<br />arrest","knock<br />off-duti<br />block_south<br />south<br />began<br />offic_offic<br />offic_drew<br />shout<br />locat<br />outsid","femal<br />yard<br />room<br />calib<br />found<br />multipl<br />also<br />live<br />properti<br />rear","medic<br />man<br />unit<br />driver<br />struggl<br />emerg<br />flee<br />pursuit<br />drive<br />lot","narcot<br />run<br />plaincloth_offic<br />gunshot<br />gun<br />unmark_vehicl<br />offic_heard<br />conduct<br />februari<br />round_recov","gun<br />third<br />gun_offic<br />door<br />saw<br />rear<br />arm<br />front<br />fire<br />ran","car<br />saw<br />window<br />still<br />approach<br />later<br />side<br />driver<br />approach_driver<br />area","man<br />away<br />advanc_toward<br />advanc<br />toward_offic<br />toward<br />drop<br />open<br />fell<br />car","detect<br />car<br />unmark<br />male_point<br />list_critic<br />approach_male<br />light<br />stop<br />believ<br />intersect","driver<br />broad<br />struggl<br />block_n<br />move<br />north<br />block_north<br />gun<br />still<br />open","calib<br />insid_resid<br />heard<br />gunshot<br />stand<br />search<br />front<br />come<br />area<br />resid","road<br />intersect<br />head<br />hold<br />pursu_male<br />offic_pursu<br />male_foot<br />male_fled<br />foot<br />discharg_firearm","complain<br />saw<br />struggl<br />drop_weapon<br />order_male<br />fled_foot<br />point<br />properti<br />order<br />point_gun","knife<br />drop_knife<br />male_drop<br />drop<br />order_male<br />away<br />back<br />continu<br />order<br />advanc_toward","ecw<br />advanc_toward<br />advanc<br />kitchen<br />knife<br />enter<br />get<br />resid<br />offic_observ<br />drew","driveway<br />road<br />hand_offic<br />near<br />foot<br />hand<br />fled_foot<br />bodi<br />observ_male<br />turn","point_firearm<br />kill<br />male_point<br />direct<br />state<br />point<br />shoot<br />heard<br />left<br />order","street_observ<br />male_fled<br />patrol_car<br />leg<br />toward<br />car<br />strike_offic<br />insid<br />man<br />area","cartridg<br />fire<br />south<br />corner<br />sidewalk<br />patrol_car<br />calib<br />car<br />handgun<br />graze","narcot<br />unmark_polic<br />unmark<br />use<br />conduct<br />driver_door<br />polic_vehicl<br />three<br />driver<br />unit","street_male<br />patrol_vehicl<br />fire<br />south<br />male_male<br />weapon_offic<br />drop<br />run<br />calib<br />uniform_offic","swat<br />unit<br />hospit_critic<br />insid_resid<br />insid<br />admit<br />critic_condit<br />resid<br />insid_properti<br />detect","detect<br />offend<br />observ_offend<br />resid<br />bedroom<br />gunshot<br />june<br />went<br />oper_unmark<br />radio_assign","stolen<br />driver_side<br />side<br />driver<br />rear<br />park_vehicl<br />refus<br />offic_oper<br />one_round<br />vehicl_approach","detect<br />treat_releas<br />chase<br />head<br />treat<br />releas<br />offend<br />westbound<br />shoulder<br />off-duti","offic_number<br />number<br />passeng<br />pistol<br />two<br />servic<br />number_one<br />four<br />unmark<br />offend","plaincloth_offic<br />unmark_polic<br />unmark<br />plaincloth<br />civilian<br />two<br />polic_vehicl<br />homicid<br />hand<br />avenu","robberi<br />stolen<br />driver_door<br />driver<br />offic_approach<br />open<br />plaincloth<br />posit<br />three<br />plaincloth_offic","knife<br />offic_drew<br />one_offic<br />properti<br />drew<br />drop_knife<br />hospit_critic<br />ecw<br />one_round<br />move","complain<br />phone<br />driveway<br />cartridg<br />number_one<br />offic_number<br />next<br />magazin<br />two<br />septemb","number_one<br />offic_number<br />number<br />offend<br />firearm_offic<br />south<br />yard<br />weapon_offend<br />august<br />pistol_load","offic_number<br />number<br />number_one<br />three<br />two<br />firearm_offic<br />pull<br />releas<br />offend<br />take","drop<br />hospit_critic<br />man<br />refus<br />ground_drop<br />street_male<br />august<br />monday<br />radio_assign<br />torso","stolen<br />offend<br />car<br />man<br />one_round<br />male_arm<br />report<br />discharg_one<br />light<br />emerg","offend<br />resid<br />admit<br />victim<br />semi-automat<br />templ_univers<br />univers_hospit<br />femal<br />univers<br />gunshot","waistband<br />june<br />offend<br />avenu_offic<br />pull<br />avenu<br />round<br />pistol<br />stop<br />patrol_vehicl","knife<br />offic_number<br />offend<br />number<br />move<br />number_one<br />open<br />toward_offic<br />offic_offic<br />bedroom","number_one<br />number<br />plaincloth_offic<br />offic_number<br />plaincloth<br />two<br />uniform_offic<br />februari<br />offend<br />park_vehicl","offend<br />east<br />street_offic<br />offend_offend<br />univers_hospit<br />toward<br />civilian<br />treatment<br />univers<br />turn","offend<br />number_one<br />offic_number<br />number<br />live_round<br />block_n<br />drop<br />hand<br />live<br />offend_offend","miss_offend<br />offend<br />offic_number<br />discharg_firearm<br />number<br />miss<br />north<br />number_one<br />block_n<br />seat","knife<br />offend<br />move<br />control<br />drop_knife<br />torso<br />deploy<br />number_one<br />offic_number<br />complain","offic_number<br />number<br />driveway<br />offic_approach<br />block_n<br />apprehend<br />approach<br />two<br />foot<br />fled_scene","rifl<br />offend<br />front<br />scene_injuri<br />radio_assign<br />octob<br />subsequ<br />offend_transport<br />without<br />street_upon","offend<br />miss_offend<br />compli<br />drop_weapon<br />offend_offend<br />pursu<br />weapon_offend<br />driveway<br />miss<br />ran","offend<br />properti<br />victim<br />penn-presbyterian<br />penn-presbyterian_hospit<br />knife<br />right_hand<br />hand<br />femal<br />right","offend<br />park_vehicl<br />sergeant<br />discharg_firearm<br />univers<br />firearm_strike<br />mark_polic<br />penn-presbyterian<br />penn-presbyterian_hospit<br />femal","insid_properti<br />properti<br />offend<br />femal<br />swat<br />insid<br />struck<br />person<br />assault<br />swat_offic","polic_vehicl<br />sidewalk<br />onto<br />drive<br />offend<br />direct<br />weapon_recov<br />block_e<br />passeng_side<br />drove","broad<br />block_north<br />oper<br />north<br />turn<br />miss_offend<br />approach_driver<br />offic_oper<br />weapon_recov<br />highway","step<br />door_offic<br />offend<br />rear<br />kitchen<br />off-duti<br />door<br />apprehend<br />miss<br />offic_observ","offend<br />properti<br />swat<br />secur<br />unit<br />one_offic<br />insid_properti<br />miss_offend<br />weapon_offend<br />offic_pursu","unmark_polic<br />polic_vehicl<br />unmark<br />offend<br />vehicl_respond<br />avenu<br />mark_polic<br />penn-presbyterian<br />penn-presbyterian_hospit<br />offic_drew","properti<br />offend<br />avenu<br />rear<br />avenu_offic<br />second<br />enter<br />penn-presbyterian<br />penn-presbyterian_hospit<br />gun","offend<br />complain<br />point_gun<br />robberi<br />struggl<br />exit_vehicl<br />subsequ<br />polic_vehicl<br />gun<br />femal","offend<br />weapon_offend<br />broad<br />offend_fled<br />block_n<br />offend_offend<br />park<br />lot<br />drop<br />result","offend<br />yard<br />lot<br />want<br />block_n<br />offend_drop<br />offic_pursu<br />unmark_polic<br />onc<br />pistol_load","polic_vehicl<br />second<br />offend<br />want<br />two<br />drive<br />park_vehicl<br />violat<br />front<br />move","polic_vehicl<br />block_north<br />pursu<br />pursu_male<br />north<br />offend<br />rear<br />yard<br />miss_offend<br />foot","offend<br />polic_vehicl<br />strike_offic<br />penn-presbyterian<br />penn-presbyterian_hospit<br />discharg_firearm<br />remain<br />advanc<br />scene_injuri<br />street_male"],"hoverinfo":"text","marker":{"size":6},"color":["Likely dog attack","Likely dog attack","Other","Likely dog attack","Other","Likely dog attack","Likely dog attack","Other","Other","Likely dog attack","Likely dog attack","Other","Other","Likely dog attack","Other","Likely dog attack","Likely dog attack","Likely dog attack","Other","Likely dog attack","Other","Likely dog attack","Other","Likely dog attack","Other","Other","Other","Other","Likely dog attack","Likely dog attack","Other","Likely dog attack","Other","Likely dog attack","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Likely knife attack","Likely knife attack","Other","Other","Other","Other","Likely knife attack","Other","Other","Other","Other","Other","Likely knife attack","Other","Other","Other","Other","Other","Other","Likely knife attack","Likely knife attack","Other","Other","Other","Likely knife attack","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Likely knife attack","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Likely knife attack","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Likely knife attack","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other","Other"],"colors":["red","orange","steelblue"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"V2 - Dog attack measure"},"yaxis":{"domain":[0,1],"automargin":true,"title":"V4 - Knife attack measure"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0.1816187558778968,0.11572360794264433,0.17877124283368376,0.18259981991707072,0.11707134487490913,0.16850678364637398,0.16374104976200635,0.21204170471713846,0.14751141714765933,0.27223024324059203,0.21900917326533442,0.15651561529202301,0.21117828010095693,0.16906490917093725,0.16140495714203171,0.12915289262487126,0.14319779874135447,0.15715001234373485],"y":[0.001783370878443198,0.026569286265514358,0.0016155413579487447,0.0054863465404168844,-0.02924999282577077,0.014377483980066011,-0.031890670339162493,-0.0089616712152539614,-0.012268508971865091,-0.05602680326379076,-0.034467898616002142,-0.010958400083721226,-0.025347629861139313,-0.008672291844130051,0.0020293933058226914,0.0037744216461390182,0.016466450689725843,-0.011107182227913816],"mode":"markers","text":["dog<br />narcot<br />back<br />secur<br />unit<br />insid_properti<br />compli<br />onc<br />tuesday<br />retreat","dog<br />district_offic<br />femal<br />polic_district<br />bedroom<br />insid<br />kill<br />locat_offic<br />call_person<br />offic_heard","dog<br />narcot<br />block_e<br />resid<br />retreat<br />involv_shoot<br />kitchen<br />offic_involv<br />bull<br />pit_bull","dog<br />femal<br />partner<br />insid<br />kill<br />went<br />avenu<br />outsid<br />home<br />offic_heard","dog<br />septemb<br />encount<br />white<br />area<br />avenu<br />scene_injuri<br />camera_activ<br />retreat<br />subsequ","dog<br />resid<br />polic_depart<br />dure<br />assault<br />depart<br />shout<br />went<br />use<br />district_place","dog<br />west<br />anim<br />bull<br />pit_bull<br />pit<br />kill<br />servic<br />june<br />offic_arriv","dog<br />resid<br />attack<br />ongo<br />block_north<br />medic<br />two<br />north<br />black<br />anim","sergeant<br />bull<br />pit_bull<br />pit<br />discharg_offic<br />attack<br />also<br />year_old<br />old<br />dog","attack<br />dog<br />bull<br />pit_bull<br />pit<br />kill<br />year<br />anim<br />district_place<br />larg","attack<br />dog<br />owner<br />bull<br />pit_bull<br />block_south<br />pit<br />control<br />femal<br />south","dog<br />kill<br />wit<br />bull<br />pit_bull<br />pit<br />attack<br />bodi<br />victim<br />depart","bull<br />pit_bull<br />pit<br />dog<br />attack<br />owner<br />control<br />stop<br />discharg_offic<br />offic_offic","dog<br />attack<br />anim<br />depart<br />avenu<br />later<br />polic_depart<br />shout<br />highway<br />bodi_worn","dog<br />yard<br />bull<br />pit_bull<br />owner<br />pit<br />resid<br />year_old<br />old<br />year","block_south<br />resid<br />dog<br />south<br />offic_offic<br />drew_weapon<br />made<br />bull<br />pit_bull<br />polic_offic","dog<br />attack<br />victim<br />wit<br />violat<br />home<br />highway<br />bull<br />pit_bull<br />bodi_worn","dog<br />anim<br />remain<br />control<br />dure_incid<br />injur<br />three<br />sustain<br />polic_depart<br />dure"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"rgba(255,0,0,1)","size":6,"line":{"color":"rgba(255,0,0,1)"}},"type":"scatter","name":"Likely dog attack","textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-0.075582185895513548,0.0082711645406465945,-0.074302718196757281,-0.075457978192815828,-0.055517186343691204,-0.043525980650874097,-0.0523682796404083,-0.056645432021001363,-0.069184758056329815,-0.096572852746188959],"y":[0.13457920790383091,0.11057925167590532,0.30646312055344366,0.11264483928614316,0.12332948577297553,0.30955549960705986,0.35559668715477799,0.17499752751217973,0.14042189150604412,0.11687641456827716],"mode":"markers","text":["offend<br />victim<br />east<br />handgun<br />gun<br />one_time<br />locat<br />return<br />partner<br />point_gun","victim<br />one_time<br />shot<br />shoot<br />left<br />unknown<br />area<br />south<br />homicid<br />shoulder","bedroom<br />knife<br />offend<br />victim<br />observ_offend<br />resid<br />arm<br />wit<br />front<br />enter","offend<br />encount<br />head<br />arm<br />point_offic<br />near<br />struck<br />fell<br />dure<br />wound","victim<br />offend<br />pronounc<br />weapon_offend<br />polic_civilian<br />highway<br />drew_weapon<br />larg<br />torso<br />ongo","knife<br />drop_knife<br />strike_male<br />drop<br />toward_offic<br />advanc_toward<br />arm<br />shout<br />advanc<br />deploy","knife<br />drop_knife<br />drop<br />walk<br />order<br />order_male<br />away<br />back<br />toward<br />park","knife<br />drop_knife<br />male_drop<br />drop<br />order_male<br />away<br />back<br />continu<br />order<br />advanc_toward","knife<br />offic_drew<br />one_offic<br />properti<br />drew<br />drop_knife<br />hospit_critic<br />ecw<br />one_round<br />move","knife<br />offend<br />move<br />control<br />drop_knife<br />torso<br />deploy<br />number_one<br />offic_number<br />complain"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"rgba(255,165,0,1)","size":6,"line":{"color":"rgba(255,165,0,1)"}},"type":"scatter","name":"Likely knife attack","textfont":{"color":"rgba(255,165,0,1)"},"error_y":{"color":"rgba(255,165,0,1)"},"error_x":{"color":"rgba(255,165,0,1)"},"line":{"color":"rgba(255,165,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-0.0019788713728065501,0.022223821264152965,0.061167241620392283,0.05572097583763197,0.048273649645646489,0.03392644180911452,0.020547903854837676,0.018577428260032738,0.0081574778119158625,0.044146742468963572,-0.020444727606716506,-0.019688882975228656,0.033479502282273005,0.044488847114346121,0.03895561051542823,0.034513205577909788,0.010288774058011624,0.028026034813560963,0.0051619495486400742,-0.010960374257623919,-0.03080148511732194,0.0034805026327011756,-0.045372966560736021,-0.029218619199922261,-0.015818943890176771,0.021759934033232578,-0.10195414139595667,-0.0038160328205497133,-0.0090294497149070087,0.011946510583231547,-0.047846038911684416,-0.0061615587655333712,-0.069463137440628417,-0.038615261481704036,-0.0054909352281676234,0.0039205632203707253,-0.05517922014072589,-0.0073223667718192546,-0.041430095428083936,-0.038567735799592148,-0.017835534277815351,-0.044649955663984484,-0.010785309029566511,-0.018800689621417527,-0.035265350888931443,-0.051409710766081883,-0.034207072019543608,-0.040655204858792739,-0.038890557656961339,-0.038987763380822132,-0.04295121299162722,-0.045648128441618224,-0.054518156209488945,-0.046373272434632039,-0.039908186961754459,-0.04441460591625912,-0.06632044621167299,-0.044769638626015643,-0.047357828271610017,-0.052404098414888099,-0.05930702712397394,-0.041634832202926485,-0.046675899727654478,-0.034090937987938885,-0.050356933614642461,-0.055910170380922851,-0.054914686535615528,-0.05687143149874474,-0.037538002449116509,-0.091381277492467064,-0.090664280006922851,-0.074810860787178537,-0.1052499187615067,-0.067975793704709159,-0.069922810025450491,-0.080422748552774426,-0.12826536685842213,-0.11433017564914463,-0.068300567015818728,-0.088807493305146909,-0.06933895325550278,-0.070404913327719407,-0.10441397207560424,-0.12601040650083331,-0.077758409185438138,-0.10359195495726557,-0.11536478039227681,-0.084222345514686159,-0.089363072445301242,-0.096011491137984864,-0.082579749139763028,-0.088826183218488536,-0.071017011830248833,-0.080397971558563985,-0.070219817169284313,-0.079212195080423028,-0.089976583088172052,-0.087500908125515309,-0.087191210821466775,-0.10666919804154282,-0.094477686770881295,-0.088159755127270478,-0.081527310486232643,-0.078845635288057936,-0.095375442585102665],"y":[0.028062219000325447,-0.0012174507505060932,-0.016032324730353455,-0.0095094548182552141,-0.088578753762321674,-0.14080769307723751,-0.088041055984498268,-0.14510182790859552,0.0640701424120277,-0.093242097426257761,0.0020048805512984918,-0.054342424489183638,-0.036637891451627227,-0.05753142780020621,-0.060228857146685147,-0.033350262364861077,-0.021807971564355103,0.022369394719026624,-0.034592975321655665,0.0026087999263642464,0.075699193612742813,0.057166765509667365,0.019873437187983262,-0.00039815745098094866,0.050391398706270699,0.017951521749537597,0.097036808972095087,0.042379116951024712,0.062577481071959762,0.028035523811704145,-0.0047856841845446358,0.034588446579626363,0.033633104999054086,0.0060864595370666357,0.088353965926886838,0.052217714108848019,0.090615666836766806,0.03313434403820871,0.02384876200724128,0.011727398691738894,0.077349495067084384,-0.00052047555691053197,-0.077075957077809426,0.077759064476345313,-0.099286074576175859,0.060974168727250408,0.020029917711219997,0.021797952052792297,0.010154282915939854,0.015760206177842535,-0.0091853272269319976,-0.015159159052059831,-0.034761383506974372,0.023848730831525243,-0.031677899322745985,0.053423382053373242,-0.027042924317941561,-0.051288222993426134,0.0097846125264492191,-0.017466716242593088,0.011245255456921364,0.097226821318501772,0.010986243071695195,0.04636857699741715,-0.019639765015640343,-0.025923798349069816,-0.037341552706523139,0.0083973836661509309,0.013806815505300628,0.015582341250898836,-0.096390797147250587,-0.0077047404613872546,-0.21005101157350364,-0.04108662161914909,-0.050921668865838272,-0.082157268913773326,-0.23757147088370797,-0.28450182634789972,-0.017204463556086257,-0.017328912428150194,0.0081800960879801401,-0.0176219199279696,0.02022960023945455,-0.30392183026855596,-0.014616193536109021,-0.10107790204162465,-0.14796624660787525,-0.13164228991861263,-0.001132098588962383,-0.0020871810885490639,0.067370922661573199,-0.022110814479791897,-0.0036648986243316508,-0.030175276321227445,-0.030783965257856028,0.042302826451644515,-0.010741623006342552,-0.015500325869967361,0.01939396339257702,-0.010541969650640482,0.010025767359612602,-0.038600183460217617,-0.024154673753718017,-0.041228465201163675,-0.029925815214598545],"mode":"markers","text":["servic<br />sergeant<br />year<br />wit<br />involv<br />male_point<br />investig_unit<br />home<br />unknown<br />complain","detect<br />shoot<br />seat<br />person<br />unit<br />homicid<br />vehicl_approach<br />investig_unit<br />involv_shoot<br />offic_involv","injur<br />polic_district<br />polic_depart<br />veteran<br />depart<br />investig_unit<br />duti<br />conduct<br />septemb<br />offic_transport","room<br />district_place<br />one_round<br />duti<br />discharg_one<br />incid_offic<br />place<br />affair_investig<br />septemb<br />shoot","suspect<br />one_offic<br />year<br />shot<br />discharg_offic<br />driver<br />male_suspect<br />june<br />use<br />blue","suspect<br />block_north<br />saturday<br />uniform_offic<br />north<br />unit<br />due<br />june<br />district_place<br />conduct","suspect<br />graze<br />male_suspect<br />white<br />robberi<br />off-duti<br />sustain<br />dure<br />wound<br />announc","suspect<br />off-duti<br />assault<br />robberi<br />take<br />struggl<br />dure<br />male_suspect<br />remain<br />violat","complain<br />front_door<br />knock<br />outsid<br />taken<br />unit<br />subsequ<br />took<br />arm<br />front","suspect<br />stolen<br />vehicl_offic<br />polic_district<br />driver<br />attempt<br />male_suspect<br />black<br />fled_scene<br />approach_driver","magazin<br />block_north<br />offend<br />park<br />black<br />north<br />live<br />handgun<br />live_round<br />round","passeng<br />suspect<br />open<br />driver<br />door<br />strike_offic<br />driver_side<br />window<br />fled_scene<br />side","suspect<br />veteran_philadelphia<br />templ_univers<br />univers_hospit<br />depart_assign<br />shot<br />univers<br />shoot<br />person<br />polic_depart","swat<br />suspect<br />swat_offic<br />assist<br />year_old<br />respond_offic<br />old<br />still<br />year<br />direct","highway<br />graze<br />suspect<br />patrol<br />veteran_philadelphia<br />depart_assign<br />polic_depart<br />veteran<br />assault<br />depart","suspect<br />sergeant<br />home<br />depart<br />encount<br />shot<br />veteran<br />involv<br />verbal<br />one_time","suspect<br />shoot<br />victim<br />passeng<br />pronounc_deceas<br />deceas<br />driver<br />unit<br />pronounc<br />wound","suspect<br />knife<br />ecw<br />deploy<br />offic_respond<br />began<br />advanc_toward<br />step<br />male_suspect<br />white","robberi<br />victim<br />suspect<br />approach_male<br />polic_vehicl<br />gun<br />follow<br />vehicl_offic<br />phone<br />drop_gun","side_door<br />door_offic<br />side<br />passeng<br />approach_driver<br />passeng_side<br />car<br />driver_side<br />driver<br />onto","lot<br />gun_offic<br />rear<br />bodi<br />ground<br />car<br />handgun<br />gun<br />pm_offic<br />strike_male","phone<br />detect<br />swat<br />one_time<br />properti<br />struck<br />enter<br />bedroom<br />swat_offic<br />announc","offend<br />offic_involv<br />gun_offic<br />observ_offend<br />area<br />involv<br />discharg_offic<br />turn<br />left<br />offic_offic","offic_involv<br />offend<br />side_door<br />involv<br />involv_shoot<br />side<br />taken<br />block_north<br />driver<br />shoot","swat<br />gsw<br />sustain<br />unit<br />insid_properti<br />front<br />properti<br />north<br />offend<br />rear","fire<br />cover<br />veteran_philadelphia<br />depart_assign<br />polic_depart<br />veteran<br />depart<br />district_offic<br />approach_male<br />arriv_locat","offend<br />gun<br />point_gun<br />lot<br />drop_gun<br />offend_drop<br />gun_offic<br />around<br />began<br />drop","room<br />offic_offic<br />oper<br />hospit_polic<br />open_door<br />discharg_offic<br />sever_time<br />window<br />templ_hospit<br />pull","gsw<br />victim<br />discharg_offic<br />locat<br />offic_arriv<br />locat_offic<br />arriv_locat<br />gunshot<br />believ<br />head","secur<br />unknown<br />westbound<br />pursuit<br />avenu<br />return<br />black_male<br />activ<br />black<br />front","passeng<br />refer<br />rear<br />unmark<br />unmark_vehicl<br />area<br />want<br />struck<br />window<br />pm_offic","floor<br />polic_offic<br />swat<br />door<br />magazin<br />warrant<br />unit<br />search<br />point_offic<br />vest","offend<br />unmark_vehicl<br />black<br />wear<br />unmark<br />drove<br />unknown<br />intersect<br />time_offic<br />handgun","stolen<br />partner<br />point_gun<br />black<br />taken<br />pursuit<br />street_offic<br />run<br />point<br />district_offic","arriv_locat<br />corner<br />gun<br />drop<br />drop_gun<br />verbal<br />locat<br />front<br />ground_drop<br />polic_civilian","swat<br />announc<br />swat_offic<br />door<br />addit<br />south<br />order<br />assault<br />insid<br />knock","rifl<br />offend<br />homicid<br />believ<br />gunfir<br />multipl<br />gunshot<br />area<br />involv<br />direct","respond_offic<br />run<br />point<br />polic_offic<br />observ_male<br />male_point<br />offic_observ<br />walk<br />weapon_male<br />avenu","park<br />polic_offic<br />westbound<br />still<br />seat<br />foot<br />behind<br />driver_seat<br />cover<br />car","unmark_vehicl<br />corner<br />bodi<br />unmark<br />medic<br />north<br />point_gun<br />narcot<br />wound<br />oper_unmark","road<br />bodi<br />front<br />refer<br />two<br />live<br />toward<br />civilian<br />turn<br />resid","passeng<br />rear<br />driver<br />request<br />posit<br />broad<br />due<br />blue<br />passeng_side<br />approach","suspect<br />swat_offic<br />swat<br />femal<br />properti<br />male_suspect<br />complain<br />road<br />point<br />white","properti<br />swat<br />black_male<br />black<br />driveway<br />went<br />locat<br />side<br />rear<br />full_uniform","suspect<br />vehicl_offic<br />polic_vehicl<br />gave<br />move<br />oper<br />driver<br />east<br />upon<br />point_offic","complain<br />car<br />get<br />floor<br />avenu<br />point<br />observ_male<br />male_arm<br />black<br />intersect","vest<br />rear<br />seat<br />vehicl_offic<br />black<br />area<br />road<br />near<br />unmark_polic<br />driver","unmark_polic<br />narcot<br />unmark<br />polic_vehicl<br />street_offic<br />front<br />black<br />search<br />front_door<br />area","sergeant<br />blue<br />unmark<br />camera<br />sever<br />insid<br />remov<br />run<br />plaincloth_offic<br />arrest","knock<br />off-duti<br />block_south<br />south<br />began<br />offic_offic<br />offic_drew<br />shout<br />locat<br />outsid","femal<br />yard<br />room<br />calib<br />found<br />multipl<br />also<br />live<br />properti<br />rear","medic<br />man<br />unit<br />driver<br />struggl<br />emerg<br />flee<br />pursuit<br />drive<br />lot","narcot<br />run<br />plaincloth_offic<br />gunshot<br />gun<br />unmark_vehicl<br />offic_heard<br />conduct<br />februari<br />round_recov","gun<br />third<br />gun_offic<br />door<br />saw<br />rear<br />arm<br />front<br />fire<br />ran","car<br />saw<br />window<br />still<br />approach<br />later<br />side<br />driver<br />approach_driver<br />area","man<br />away<br />advanc_toward<br />advanc<br />toward_offic<br />toward<br />drop<br />open<br />fell<br />car","detect<br />car<br />unmark<br />male_point<br />list_critic<br />approach_male<br />light<br />stop<br />believ<br />intersect","driver<br />broad<br />struggl<br />block_n<br />move<br />north<br />block_north<br />gun<br />still<br />open","calib<br />insid_resid<br />heard<br />gunshot<br />stand<br />search<br />front<br />come<br />area<br />resid","road<br />intersect<br />head<br />hold<br />pursu_male<br />offic_pursu<br />male_foot<br />male_fled<br />foot<br />discharg_firearm","complain<br />saw<br />struggl<br />drop_weapon<br />order_male<br />fled_foot<br />point<br />properti<br />order<br />point_gun","ecw<br />advanc_toward<br />advanc<br />kitchen<br />knife<br />enter<br />get<br />resid<br />offic_observ<br />drew","driveway<br />road<br />hand_offic<br />near<br />foot<br />hand<br />fled_foot<br />bodi<br />observ_male<br />turn","point_firearm<br />kill<br />male_point<br />direct<br />state<br />point<br />shoot<br />heard<br />left<br />order","street_observ<br />male_fled<br />patrol_car<br />leg<br />toward<br />car<br />strike_offic<br />insid<br />man<br />area","cartridg<br />fire<br />south<br />corner<br />sidewalk<br />patrol_car<br />calib<br />car<br />handgun<br />graze","narcot<br />unmark_polic<br />unmark<br />use<br />conduct<br />driver_door<br />polic_vehicl<br />three<br />driver<br />unit","street_male<br />patrol_vehicl<br />fire<br />south<br />male_male<br />weapon_offic<br />drop<br />run<br />calib<br />uniform_offic","swat<br />unit<br />hospit_critic<br />insid_resid<br />insid<br />admit<br />critic_condit<br />resid<br />insid_properti<br />detect","detect<br />offend<br />observ_offend<br />resid<br />bedroom<br />gunshot<br />june<br />went<br />oper_unmark<br />radio_assign","stolen<br />driver_side<br />side<br />driver<br />rear<br />park_vehicl<br />refus<br />offic_oper<br />one_round<br />vehicl_approach","detect<br />treat_releas<br />chase<br />head<br />treat<br />releas<br />offend<br />westbound<br />shoulder<br />off-duti","offic_number<br />number<br />passeng<br />pistol<br />two<br />servic<br />number_one<br />four<br />unmark<br />offend","plaincloth_offic<br />unmark_polic<br />unmark<br />plaincloth<br />civilian<br />two<br />polic_vehicl<br />homicid<br />hand<br />avenu","robberi<br />stolen<br />driver_door<br />driver<br />offic_approach<br />open<br />plaincloth<br />posit<br />three<br />plaincloth_offic","complain<br />phone<br />driveway<br />cartridg<br />number_one<br />offic_number<br />next<br />magazin<br />two<br />septemb","number_one<br />offic_number<br />number<br />offend<br />firearm_offic<br />south<br />yard<br />weapon_offend<br />august<br />pistol_load","offic_number<br />number<br />number_one<br />three<br />two<br />firearm_offic<br />pull<br />releas<br />offend<br />take","drop<br />hospit_critic<br />man<br />refus<br />ground_drop<br />street_male<br />august<br />monday<br />radio_assign<br />torso","stolen<br />offend<br />car<br />man<br />one_round<br />male_arm<br />report<br />discharg_one<br />light<br />emerg","offend<br />resid<br />admit<br />victim<br />semi-automat<br />templ_univers<br />univers_hospit<br />femal<br />univers<br />gunshot","waistband<br />june<br />offend<br />avenu_offic<br />pull<br />avenu<br />round<br />pistol<br />stop<br />patrol_vehicl","knife<br />offic_number<br />offend<br />number<br />move<br />number_one<br />open<br />toward_offic<br />offic_offic<br />bedroom","number_one<br />number<br />plaincloth_offic<br />offic_number<br />plaincloth<br />two<br />uniform_offic<br />februari<br />offend<br />park_vehicl","offend<br />east<br />street_offic<br />offend_offend<br />univers_hospit<br />toward<br />civilian<br />treatment<br />univers<br />turn","offend<br />number_one<br />offic_number<br />number<br />live_round<br />block_n<br />drop<br />hand<br />live<br />offend_offend","miss_offend<br />offend<br />offic_number<br />discharg_firearm<br />number<br />miss<br />north<br />number_one<br />block_n<br />seat","offic_number<br />number<br />driveway<br />offic_approach<br />block_n<br />apprehend<br />approach<br />two<br />foot<br />fled_scene","rifl<br />offend<br />front<br />scene_injuri<br />radio_assign<br />octob<br />subsequ<br />offend_transport<br />without<br />street_upon","offend<br />miss_offend<br />compli<br />drop_weapon<br />offend_offend<br />pursu<br />weapon_offend<br />driveway<br />miss<br />ran","offend<br />properti<br />victim<br />penn-presbyterian<br />penn-presbyterian_hospit<br />knife<br />right_hand<br />hand<br />femal<br />right","offend<br />park_vehicl<br />sergeant<br />discharg_firearm<br />univers<br />firearm_strike<br />mark_polic<br />penn-presbyterian<br />penn-presbyterian_hospit<br />femal","insid_properti<br />properti<br />offend<br />femal<br />swat<br />insid<br />struck<br />person<br />assault<br />swat_offic","polic_vehicl<br />sidewalk<br />onto<br />drive<br />offend<br />direct<br />weapon_recov<br />block_e<br />passeng_side<br />drove","broad<br />block_north<br />oper<br />north<br />turn<br />miss_offend<br />approach_driver<br />offic_oper<br />weapon_recov<br />highway","step<br />door_offic<br />offend<br />rear<br />kitchen<br />off-duti<br />door<br />apprehend<br />miss<br />offic_observ","offend<br />properti<br />swat<br />secur<br />unit<br />one_offic<br />insid_properti<br />miss_offend<br />weapon_offend<br />offic_pursu","unmark_polic<br />polic_vehicl<br />unmark<br />offend<br />vehicl_respond<br />avenu<br />mark_polic<br />penn-presbyterian<br />penn-presbyterian_hospit<br />offic_drew","properti<br />offend<br />avenu<br />rear<br />avenu_offic<br />second<br />enter<br />penn-presbyterian<br />penn-presbyterian_hospit<br />gun","offend<br />complain<br />point_gun<br />robberi<br />struggl<br />exit_vehicl<br />subsequ<br />polic_vehicl<br />gun<br />femal","offend<br />weapon_offend<br />broad<br />offend_fled<br />block_n<br />offend_offend<br />park<br />lot<br />drop<br />result","offend<br />yard<br />lot<br />want<br />block_n<br />offend_drop<br />offic_pursu<br />unmark_polic<br />onc<br />pistol_load","polic_vehicl<br />second<br />offend<br />want<br />two<br />drive<br />park_vehicl<br />violat<br />front<br />move","polic_vehicl<br />block_north<br />pursu<br />pursu_male<br />north<br />offend<br />rear<br />yard<br />miss_offend<br />foot","offend<br />polic_vehicl<br />strike_offic<br />penn-presbyterian<br />penn-presbyterian_hospit<br />discharg_firearm<br />remain<br />advanc<br />scene_injuri<br />street_male"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"rgba(70,130,180,1)","size":6,"line":{"color":"rgba(70,130,180,1)"}},"type":"scatter","name":"Other","textfont":{"color":"rgba(70,130,180,1)"},"error_y":{"color":"rgba(70,130,180,1)"},"error_x":{"color":"rgba(70,130,180,1)"},"line":{"color":"rgba(70,130,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-documentMap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Plot of how documents weigh 2nd and 4th left singular vectors
</figcaption>
</figure>
</div>
</div>
</section>
<section id="clustering-documents-with-hartigans-k-means-clustering-algorithm" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Clustering documents with Hartigan’s k-means clustering algorithm</h1>
<p>Hartigan’s k-means algorithm is an iterative method for partitioning data into <span class="math inline">\(k\)</span> clusters by minimizing the total within-cluster sum of squares. It begins with randomly chosen cluster centers (centroids) and alternates between two steps:</p>
<ol type="1">
<li>assigning each data point to the nearest centroid based on Euclidean distance</li>
<li>updating each centroid to be the mean of the points currently assigned to it</li>
</ol>
<p>These steps repeat until the assignments no longer change significantly, indicating convergence. The algorithm is greedy and locally optimal. That is, it always reduces the the within cluster sum of squares at each iteration, but it can converge to different solutions depending on the initial centroids. Multiple runs with different random starts are often used to find a better overall solution.</p>
<p>Let’s look at a little 2D demonstration before we run this on documents, which can be a little abstract. I have created three clusters with centers at (0,0), (3,3), and (5,5). Then I have R code that reassigns points to their nearest centroids, recomputes the cluster centroids, plots the points colored by their cluster assignment, checks for convergence, and repeats if needed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20250325</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data from 3 clusters</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">rnorm</span>(<span class="dv">180</span>, <span class="at">mean=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">5</span>)),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y=</span><span class="fu">rnorm</span>(<span class="dv">180</span>, <span class="at">mean=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">5</span>)))</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># find three clusters</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co"># pick three random points to start</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>old_centroid <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span>k) <span class="sc">|&gt;</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(x,y)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to assign points to nearest center</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   compare each point to each of the three centers</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   assign the point to its closest center</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>assign_clusters <span class="ot">&lt;-</span> <span class="cf">function</span>(df, centers) </span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">apply</span>(df, <span class="dv">1</span>, <span class="cf">function</span>(point) </span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">which.min</span>(<span class="fu">colSums</span>((<span class="fu">t</span>(centers) <span class="sc">-</span> point)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="cf">repeat</span> </span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign points to nearest cluster</span></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">assign_clusters</span>(df[,<span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>)], </span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>                                old_centroid)</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get centroids of newly assigned clusters</span></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>  new_centroid <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(cluster) <span class="sc">|&gt;</span></span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">x=</span><span class="fu">mean</span>(x), <span class="at">y=</span><span class="fu">mean</span>(y))</span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot showing old and new centroids</span></span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>  plotKmeans <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> <span class="fu">factor</span>(cluster))) <span class="sc">+</span></span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> old_centroid, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), </span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> new_centroid, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill=</span><span class="fu">factor</span>(cluster)), </span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(</span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">bind_cols</span>(old_centroid, new_centroid),</span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> x...<span class="dv">1</span>, <span class="at">y =</span> y...<span class="dv">2</span>, <span class="at">xend =</span> x...<span class="dv">4</span>, <span class="at">yend =</span> y...<span class="dv">5</span>),</span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"inches"</span>)),</span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"K-Means Iteration"</span>, iter)) <span class="sc">+</span></span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Cluster"</span>) <span class="sc">+</span></span>
<span id="cb52-54"><a href="#cb52-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb52-55"><a href="#cb52-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb52-56"><a href="#cb52-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plotKmeans)</span>
<span id="cb52-57"><a href="#cb52-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-58"><a href="#cb52-58" aria-hidden="true" tabindex="-1"></a>  new_centroid <span class="ot">&lt;-</span> new_centroid <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>cluster)</span>
<span id="cb52-59"><a href="#cb52-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-60"><a href="#cb52-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check if converged</span></span>
<span id="cb52-61"><a href="#cb52-61" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">all</span>(<span class="fu">abs</span>(new_centroid <span class="sc">-</span> old_centroid) <span class="sc">&lt;</span> <span class="fl">0.001</span>))</span>
<span id="cb52-62"><a href="#cb52-62" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb52-63"><a href="#cb52-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb52-64"><a href="#cb52-64" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-65"><a href="#cb52-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-66"><a href="#cb52-66" aria-hidden="true" tabindex="-1"></a>  old_centroid <span class="ot">&lt;-</span> new_centroid</span>
<span id="cb52-67"><a href="#cb52-67" aria-hidden="true" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb52-68"><a href="#cb52-68" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kmeans-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-kmeans-1.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Demonstration of Hartigan’s k-means algorithm
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmeans-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-kmeans-2.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Demonstration of Hartigan’s k-means algorithm
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmeans-3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kmeans-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-kmeans-3.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kmeans-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Demonstration of Hartigan’s k-means algorithm
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmeans-4" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kmeans-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-kmeans-4.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kmeans-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Demonstration of Hartigan’s k-means algorithm
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmeans-5" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kmeans-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-kmeans-5.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kmeans-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Demonstration of Hartigan’s k-means algorithm
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmeans-6" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kmeans-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-kmeans-6.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kmeans-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Demonstration of Hartigan’s k-means algorithm
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmeans-7" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kmeans-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-kmeans-7.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kmeans-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Demonstration of Hartigan’s k-means algorithm
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-kmeans-8" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kmeans-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-kmeans-8.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kmeans-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Demonstration of Hartigan’s k-means algorithm
</figcaption>
</figure>
</div>
</div>
</div>
<p>After 8 iterations, the centroids of the clusters do not change. That means the cluster assignments for each point will no longer changed. The k-means algorithm has converged after 8 iterations. Indeed k-means seems to have figured out the three clusters that I simulated. In practice we never really know how many real clusters there are. We need to come up with some measures that help us decide whether the number of clusters and their centroids adequately capture the data points.</p>
<p>The plot in <a href="#fig-totSS" class="quarto-xref">Figure&nbsp;11</a> illustrates the total sum of squares (TSS), which measures the overall variability in the dataset. It shows each data point connected to the grand centroid, the average of all points in the data. The total sum of squares is calculated by summing the squared distances from each point to this overall centroid. This serves as a baseline measure of dispersion before we run our clustering algorithm.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>tot_centroid <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(x, y) <span class="sc">|&gt;</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colMeans</span>() <span class="sc">|&gt;</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">|&gt;</span> </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>plotTotCentroid <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">color =</span> <span class="fu">factor</span>(cluster))) <span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">bind_cols</span>(tot_centroid <span class="sc">|&gt;</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">180</span>)), </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>                     df <span class="sc">|&gt;</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">select</span>(x,y)),</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x...<span class="dv">1</span>, <span class="at">y =</span> y...<span class="dv">2</span>, <span class="at">xend =</span> x...<span class="dv">3</span>, <span class="at">yend =</span> y...<span class="dv">4</span>),</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Cluster"</span>) <span class="sc">+</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plotTotCentroid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-totSS" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-totSS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-totSS-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-totSS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Total sum of squares calculation. TSS sums all the squared distances between each point and the single centroid of the entire dataset
</figcaption>
</figure>
</div>
</div>
</div>
<p>In contrast, <a href="#fig-withinSS" class="quarto-xref">Figure&nbsp;12</a> depicts the within-cluster sum of squares (WCSS). Each point is now connected to its respective cluster centroid, rather than the overall centroid. The sum of squared distances from each point to its assigned cluster center quantifies how compact each cluster is.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>new_centroid<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>plotWithinCentroid <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">color =</span> <span class="fu">factor</span>(cluster))) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df <span class="sc">|&gt;</span> </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">left_join</span>(new_centroid, <span class="at">by=</span><span class="fu">join_by</span>(cluster)),</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x.x, <span class="at">y =</span> y.x, <span class="at">xend =</span> x.y, <span class="at">yend =</span> y.y),</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Cluster"</span>) <span class="sc">+</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plotWithinCentroid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-withinSS" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-withinSS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-withinSS-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-withinSS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Within cluster sum of squares calculation. WCSS sums the squared distances between each point and the center of its associated centroid
</figcaption>
</figure>
</div>
</div>
</div>
<p>A useful measure of clustering quality is the proportion of variance explained by the clustering, computed as <span class="math inline">\(R^2 = 1-\frac{WCSS}{TSS}\)</span>. This tells us how much of the total variability has been accounted for by the clustering structure. A higher value indicates better clustering. If this proportion is low, it may suggest that the three clusters is insufficient to capture the underlying structure of the data.</p>
<p>Let’s put all this to work on our officer-involved shooting reports. We will define documents by their first 7 right singular vectors (columns of <span class="math inline">\(\mathbf{V}\)</span>). We will actually cluster on <span class="math inline">\(\mathbf{V}\boldsymbol\Sigma\)</span>. Remember that SVD normalizes all the columns in <span class="math inline">\(\mathbf{V}\)</span> (and those in <span class="math inline">\(\mathbf{U}\)</span> as well) to have length 1. That has the effect of making differences between documents basedon their values of <span class="math inline">\(v_{30}\)</span> just as large as differences on <span class="math inline">\(v_1\)</span>. The singular values in <span class="math inline">\(\boldsymbol\Sigma\)</span> tell us how to weight each column based how much variance it captures in the original TF-IDF matrix. Without this weighting, each dimension would contribute equally to distance calculations during clustering, even though some components may be far more informative than others. By using <span class="math inline">\(\mathbf{V}\boldsymbol\Sigma\)</span>, our clustering algorithm will more accurately group documents based on their underlying thematic content.</p>
<p>R has a built-in <code>kmeans()</code> function in the default <code>stats</code> package that will do all the work for us. First, we need to decide on how many clusters we should use. The code below explores the relationship between the number of clusters, <span class="math inline">\(k\)</span>, and <span class="math inline">\(R^2\)</span>. This is a key part of the “elbow method,” a common strategy for selecting an appropriate number of clusters. By running k-means repeatedly with increasing values of <span class="math inline">\(k\)</span> (from 1 to 40 in this case), and recording the corresponding <span class="math inline">\(R^2\)</span>, we can visualize how much the clustering improves as <span class="math inline">\(k\)</span> increases. A plot of <span class="math inline">\(R^2\)</span> versus <span class="math inline">\(k\)</span> typically shows a steep increase initially and then levels off. The “elbow” point, where the rate of improvement sharply slows, is often a good choice for the number of clusters. It represents a balance between underfitting and overfitting the structure in the data. Another common method is to consider more and more clusters until <span class="math inline">\(R^2\)</span> reaches 0.80 (or 0.90).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="at">R2=</span><span class="cn">NA</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(design))</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># multiply by the singular values to incorporate the importance of each </span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  km <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(oisSVD<span class="sc">$</span>v[,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>] <span class="sc">%*%</span> <span class="fu">diag</span>(oisSVD<span class="sc">$</span>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]), </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">centers =</span> design<span class="sc">$</span>k[i], </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">nstart =</span> <span class="dv">5</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  design<span class="sc">$</span>R2[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(i<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">1</span> <span class="sc">-</span> km<span class="sc">$</span>tot.withinss<span class="sc">/</span>km<span class="sc">$</span>totss)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(R2<span class="sc">~</span>k, <span class="at">data=</span>design, <span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">expression</span>(k),</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="fu">expression</span>(R<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.8</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>kSelect <span class="ot">&lt;-</span> design <span class="sc">|&gt;</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(R2 <span class="sc">&gt;</span> <span class="fl">0.8</span>) <span class="sc">|&gt;</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(R2) <span class="sc">|&gt;</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kvsse" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kvsse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-kvsse-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kvsse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Relationship between <span class="math inline">\(k\)</span> and <span class="math inline">\(R^2\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-kvsse" class="quarto-xref">Figure&nbsp;13</a> I have marked where the <span class="math inline">\(R^2\)</span> reaches 80%. That happens when we set <span class="math inline">\(k\)</span> to 10. With <span class="math inline">\(k\)</span> set to 10, the clustering captures 80% of the variation in the first seven right singular vectors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run kmeans on first 10 right singular vectors (scaled by Sigma)</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   clusters similar documents</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20250325</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>oisKmeans <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(oisSVD<span class="sc">$</span>v[,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] <span class="sc">%*%</span> <span class="fu">diag</span>(oisSVD<span class="sc">$</span>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]), </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">centers =</span> kSelect,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nstart =</span> <span class="dv">5</span>) <span class="co"># try 5 random starting points</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s add the cluster label to our original OIS data frame so we can see if themes are identifiable from their incident descriptions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add the cluster labels to the dataset</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>ois<span class="sc">$</span>cluster <span class="ot">&lt;-</span> oisKmeans<span class="sc">$</span>cluster</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>ois <span class="sc">|&gt;</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,location,date,cluster) <span class="sc">|&gt;</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id                                 location       date cluster
1 24-37      3450 Vista Street, Philadelphia, PA 2024-12-10       9
2 24-36          3250 A Street, Philadelphia, PA 2024-11-12       2
3 24-35 5450 Chancellor Street, Philadelphia, PA 2024-11-10      10
4 24-32         2950 E. Street, Philadelphia, PA 2024-10-11       9
5 24-31      3350 Willits Road, Philadelphia, PA 2024-10-03       6
6 24-30    6150 Lebanon Avenue, Philadelphia, PA 2024-10-02       9</code></pre>
</div>
</div>
<p>We need to craft some labels or definitions for these clusters. For each cluster I will compute the average of their TFIDF weights for each term in the vocabulary. I will paste together the top ten terms as cluster labels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>hovertext <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(oisTFIDF) <span class="sc">|&gt;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cluster =</span> ois<span class="sc">$</span>cluster) <span class="sc">|&gt;</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">|&gt;</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># average the TFIDF values within each cluster</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), mean), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>cluster) <span class="sc">|&gt;</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># find the top 10 TFIDF weighted terms by cluster</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(<span class="dv">1</span>, <span class="cf">function</span>(w)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> <span class="fu">order</span>(w, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(oisTFIDF)[i[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]]</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">|&gt;</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">|&gt;</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># paste together the top 10 terms</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(<span class="dv">1</span>, paste, <span class="at">collapse=</span><span class="st">", "</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">terms =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">size =</span> oisKmeans<span class="sc">$</span>size,</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster =</span> <span class="dv">1</span><span class="sc">:</span>kSelect) <span class="sc">|&gt;</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(size))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s examine the top 10 terms for these clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>hovertext <span class="sc">|&gt;</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="st">"html"</span>, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">escape =</span> <span class="cn">FALSE</span>, </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Top Terms"</span>, <span class="st">"Size"</span>, <span class="st">"Cluster"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="st">"left"</span>, </span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="table table-striped table-hover table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Top Terms</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Size</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cluster</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">driver, passeng, unmark, point, car, rear, area, door, gun, front</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">swat, unit, properti, door, shoot, front, locat, secur, insid, black</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dog, attack, bull, pit_bull, pit, owner, year, year_old, anim, old</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">offend, victim, handgun, gun, one_time, area, left, right, sever, black</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>The first row describes the largest cluster with 33 documents (Cluster #8). It describes shootings involving a car (driver, passenger, door). The second largest cluster (Cluster #3) seems to describe a prototypical officer-involved shooting involving an offender, a marked police vehicle, and some mention of charges. Clusters #10 and #1 are the SWAT (Special Weapons and Tactics) incidents. Cluster #2 clearly seems to be shootings of dogs, commonly pit bulls. You can pick up other themes in the remaining clusters such as knife attacks and the involvement of plainclothes police officers.</p>
<p>Let’s plot these out based on the values of each document’s first two right singular vectors (<span class="math inline">\(v_1\)</span> and <span class="math inline">\(v_2\)</span>). I will color them based on their clustering and add the top 10 terms as hovertext so we have some idea about the themes. Explore the clusters in the plot and see if you can extra some of those themes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> oisSVD<span class="sc">$</span>v[,<span class="dv">1</span>],</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> oisSVD<span class="sc">$</span>v[,<span class="dv">2</span>],</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"scatter"</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">"markers"</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> ois<span class="sc">$</span>cluster,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> hovertext<span class="sc">$</span>terms[ois<span class="sc">$</span>cluster], </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"SVD Dimension 1"</span>),</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"SVD Dimension 2"</span>),</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"K-Means Clustering of OIS Reports"</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-clusteredDocuments" class="cell-output-display quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-clusteredDocuments-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="plotly html-widget html-fill-item" id="htmlwidget-16875774eaa782778c4b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-16875774eaa782778c4b">{"x":{"visdat":{"71707c8f2655":["function () ","plotlyVisDat"]},"cur_data":"71707c8f2655","attrs":{"71707c8f2655":{"x":[0.13016093963267802,0.10231699477635521,0.085512826149933441,0.12917295358684439,0.084149421205118258,0.13127178436051212,0.10650647950750776,0.085033897054333882,0.082840540114520786,0.12596040597652214,0.11568923012434729,0.095398923589654808,0.1031121173693528,0.14125781532991558,0.099581867247699254,0.10745886513048078,0.14290625908342319,0.13265942291845215,0.09898454986019152,0.11535087704560232,0.081032964201314187,0.12447511886531513,0.097894581456425434,0.11831766196404349,0.090061072478837281,0.087466202577181032,0.088442154195074285,0.10128752712337349,0.11299509384720988,0.10363558051012814,0.092525792354167136,0.11410110842148356,0.095650206987512559,0.11487545448892478,0.096678157663676628,0.10366880134280465,0.093593366205540665,0.076987455668136653,0.073407444317435691,0.090833441339926407,0.086156223822562952,0.084768918692660705,0.093714273017393421,0.079781307657639161,0.10071300047644437,0.10476242605121326,0.090108185819903722,0.072657338369223418,0.081716177102647891,0.081474039929356923,0.075851035323362223,0.10569577811158,0.082538982291421856,0.10031074376692278,0.075959019470818345,0.072788028503809013,0.083883078910908196,0.098475016952769182,0.084874643042482628,0.078585241424528579,0.071355070229268389,0.072283223751582901,0.073104689434369305,0.07889831932220677,0.093836767032658669,0.076357423067845126,0.11757967657036997,0.081664733500482659,0.099683439920077194,0.080444429316018778,0.079296035231695802,0.077448768712446797,0.084834502362981151,0.070947730754001292,0.060976061465512946,0.064786978205185405,0.065065970058916636,0.062254381900017787,0.065534675725211169,0.068191895563331148,0.061789364295620056,0.061777520424832699,0.074375445323841105,0.063843785005722756,0.062085399250787772,0.066532972391451589,0.064735822928175951,0.0630657797766426,0.059872745307984997,0.061936941344078379,0.059335581863470446,0.060974759191640124,0.067608127849558691,0.061145300709514065,0.075906602973259893,0.08165142544660775,0.069094095123724136,0.068303421277020299,0.077384255916517194,0.066908756505984254,0.063942811791556364,0.06721434477430431,0.070818580738014017,0.079552252698355239,0.079095069375139188,0.060869794786939685,0.073095891165159382,0.07573404068697924,0.067592175626066592,0.08649685809231096,0.078832891243113032,0.069430417790723425,0.075381570265328976,0.08290391687334521,0.086701172783356262,0.069140102409902329,0.071401087322133613,0.077814289484206642,0.0859685975485385,0.076844992058665199,0.078449150067171305,0.066496126113719176,0.065868720452723087,0.077457320465133261,0.081302134331207324,0.070597767155514732,0.076787920037709831,0.091247195140274809,0.077024613269143075,0.074889782083216463,0.075964747273408656,0.068013696848289534,0.07387506117872851],"y":[0.1816187558778968,0.11572360794264433,-0.0019788713728065501,0.17877124283368376,0.022223821264152965,0.18259981991707072,0.11707134487490913,0.061167241620392283,0.05572097583763197,0.16850678364637398,0.16374104976200635,0.048273649645646489,0.03392644180911452,0.21204170471713846,0.020547903854837676,0.14751141714765933,0.27223024324059203,0.21900917326533442,0.018577428260032738,0.15651561529202301,0.0081574778119158625,0.21117828010095693,0.044146742468963572,0.16906490917093725,-0.020444727606716506,-0.019688882975228656,0.033479502282273005,0.044488847114346121,0.16140495714203171,0.12915289262487126,0.03895561051542823,0.14319779874135447,0.034513205577909788,0.15715001234373485,0.010288774058011624,0.028026034813560963,0.0051619495486400742,-0.010960374257623919,-0.03080148511732194,0.0034805026327011756,-0.045372966560736021,-0.029218619199922261,-0.015818943890176771,0.021759934033232578,-0.10195414139595667,-0.075582185895513548,0.0082711645406465945,-0.0038160328205497133,-0.0090294497149070087,0.011946510583231547,-0.047846038911684416,-0.074302718196757281,-0.0061615587655333712,-0.069463137440628417,-0.038615261481704036,-0.0054909352281676234,0.0039205632203707253,-0.075457978192815828,-0.05517922014072589,-0.0073223667718192546,-0.041430095428083936,-0.038567735799592148,-0.017835534277815351,-0.044649955663984484,-0.055517186343691204,-0.043525980650874097,-0.010785309029566511,-0.018800689621417527,-0.035265350888931443,-0.0523682796404083,-0.051409710766081883,-0.034207072019543608,-0.040655204858792739,-0.038890557656961339,-0.038987763380822132,-0.04295121299162722,-0.045648128441618224,-0.054518156209488945,-0.046373272434632039,-0.039908186961754459,-0.04441460591625912,-0.06632044621167299,-0.044769638626015643,-0.047357828271610017,-0.052404098414888099,-0.05930702712397394,-0.056645432021001363,-0.041634832202926485,-0.046675899727654478,-0.034090937987938885,-0.050356933614642461,-0.055910170380922851,-0.054914686535615528,-0.05687143149874474,-0.037538002449116509,-0.091381277492467064,-0.090664280006922851,-0.074810860787178537,-0.1052499187615067,-0.067975793704709159,-0.069922810025450491,-0.069184758056329815,-0.080422748552774426,-0.12826536685842213,-0.11433017564914463,-0.068300567015818728,-0.088807493305146909,-0.06933895325550278,-0.070404913327719407,-0.10441397207560424,-0.12601040650083331,-0.077758409185438138,-0.10359195495726557,-0.11536478039227681,-0.096572852746188959,-0.084222345514686159,-0.089363072445301242,-0.096011491137984864,-0.082579749139763028,-0.088826183218488536,-0.071017011830248833,-0.080397971558563985,-0.070219817169284313,-0.079212195080423028,-0.089976583088172052,-0.087500908125515309,-0.087191210821466775,-0.10666919804154282,-0.094477686770881295,-0.088159755127270478,-0.081527310486232643,-0.078845635288057936,-0.095375442585102665],"mode":"markers","text":["detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur","offend, victim, handgun, gun, one_time, area, left, right, sever, black","detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur","detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur","offend, victim, handgun, gun, one_time, area, left, right, sever, black","offend, victim, handgun, gun, one_time, area, left, right, sever, black","detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","driver, passeng, unmark, point, car, rear, area, door, gun, front","driver, passeng, unmark, point, car, rear, area, door, gun, front","detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur","driver, passeng, unmark, point, car, rear, area, door, gun, front","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","driver, passeng, unmark, point, car, rear, area, door, gun, front","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","driver, passeng, unmark, point, car, rear, area, door, gun, front","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","offend, victim, handgun, gun, one_time, area, left, right, sever, black","driver, passeng, unmark, point, car, rear, area, door, gun, front","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","driver, passeng, unmark, point, car, rear, area, door, gun, front","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","driver, passeng, unmark, point, car, rear, area, door, gun, front","detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","driver, passeng, unmark, point, car, rear, area, door, gun, front","driver, passeng, unmark, point, car, rear, area, door, gun, front","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti","driver, passeng, unmark, point, car, rear, area, door, gun, front","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","driver, passeng, unmark, point, car, rear, area, door, gun, front","suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","offend, victim, handgun, gun, one_time, area, left, right, sever, black","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","swat, unit, properti, door, shoot, front, locat, secur, insid, black","suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","offend, victim, handgun, gun, one_time, area, left, right, sever, black","dog, attack, bull, pit_bull, pit, owner, year, year_old, anim, old","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti","swat, unit, properti, door, shoot, front, locat, secur, insid, black","dog, attack, bull, pit_bull, pit, owner, year, year_old, anim, old","dog, attack, bull, pit_bull, pit, owner, year, year_old, anim, old","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti","dog, attack, bull, pit_bull, pit, owner, year, year_old, anim, old","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black"],"marker":{"size":6},"color":[9,2,10,9,6,9,9,6,6,9,2,1,1,9,1,2,2,2,1,2,10,2,1,2,7,8,6,1,2,2,1,2,1,9,10,1,1,8,8,10,7,10,10,10,7,7,7,10,10,10,8,4,10,7,8,10,10,7,7,8,8,8,8,8,7,4,1,10,1,4,8,8,8,8,8,8,8,8,8,8,8,6,8,8,8,3,4,8,8,8,8,8,8,8,10,3,3,6,5,8,8,4,3,5,5,3,3,3,3,4,5,3,3,3,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"SVD Dimension 1"},"yaxis":{"domain":[0,1],"automargin":true,"title":"SVD Dimension 2"},"title":"K-Means Clustering of OIS Reports","hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0.13016093963267802,0.10231699477635521,0.085512826149933441,0.12917295358684439,0.084149421205118258,0.13127178436051212,0.10650647950750776,0.085033897054333882,0.082840540114520786,0.12596040597652214,0.11568923012434729,0.095398923589654808,0.1031121173693528,0.14125781532991558,0.099581867247699254,0.10745886513048078,0.14290625908342319,0.13265942291845215,0.09898454986019152,0.11535087704560232,0.081032964201314187,0.12447511886531513,0.097894581456425434,0.11831766196404349,0.090061072478837281,0.087466202577181032,0.088442154195074285,0.10128752712337349,0.11299509384720988,0.10363558051012814,0.092525792354167136,0.11410110842148356,0.095650206987512559,0.11487545448892478,0.096678157663676628,0.10366880134280465,0.093593366205540665,0.076987455668136653,0.073407444317435691,0.090833441339926407,0.086156223822562952,0.084768918692660705,0.093714273017393421,0.079781307657639161,0.10071300047644437,0.10476242605121326,0.090108185819903722,0.072657338369223418,0.081716177102647891,0.081474039929356923,0.075851035323362223,0.10569577811158,0.082538982291421856,0.10031074376692278,0.075959019470818345,0.072788028503809013,0.083883078910908196,0.098475016952769182,0.084874643042482628,0.078585241424528579,0.071355070229268389,0.072283223751582901,0.073104689434369305,0.07889831932220677,0.093836767032658669,0.076357423067845126,0.11757967657036997,0.081664733500482659,0.099683439920077194,0.080444429316018778,0.079296035231695802,0.077448768712446797,0.084834502362981151,0.070947730754001292,0.060976061465512946,0.064786978205185405,0.065065970058916636,0.062254381900017787,0.065534675725211169,0.068191895563331148,0.061789364295620056,0.061777520424832699,0.074375445323841105,0.063843785005722756,0.062085399250787772,0.066532972391451589,0.064735822928175951,0.0630657797766426,0.059872745307984997,0.061936941344078379,0.059335581863470446,0.060974759191640124,0.067608127849558691,0.061145300709514065,0.075906602973259893,0.08165142544660775,0.069094095123724136,0.068303421277020299,0.077384255916517194,0.066908756505984254,0.063942811791556364,0.06721434477430431,0.070818580738014017,0.079552252698355239,0.079095069375139188,0.060869794786939685,0.073095891165159382,0.07573404068697924,0.067592175626066592,0.08649685809231096,0.078832891243113032,0.069430417790723425,0.075381570265328976,0.08290391687334521,0.086701172783356262,0.069140102409902329,0.071401087322133613,0.077814289484206642,0.0859685975485385,0.076844992058665199,0.078449150067171305,0.066496126113719176,0.065868720452723087,0.077457320465133261,0.081302134331207324,0.070597767155514732,0.076787920037709831,0.091247195140274809,0.077024613269143075,0.074889782083216463,0.075964747273408656,0.068013696848289534,0.07387506117872851],"y":[0.1816187558778968,0.11572360794264433,-0.0019788713728065501,0.17877124283368376,0.022223821264152965,0.18259981991707072,0.11707134487490913,0.061167241620392283,0.05572097583763197,0.16850678364637398,0.16374104976200635,0.048273649645646489,0.03392644180911452,0.21204170471713846,0.020547903854837676,0.14751141714765933,0.27223024324059203,0.21900917326533442,0.018577428260032738,0.15651561529202301,0.0081574778119158625,0.21117828010095693,0.044146742468963572,0.16906490917093725,-0.020444727606716506,-0.019688882975228656,0.033479502282273005,0.044488847114346121,0.16140495714203171,0.12915289262487126,0.03895561051542823,0.14319779874135447,0.034513205577909788,0.15715001234373485,0.010288774058011624,0.028026034813560963,0.0051619495486400742,-0.010960374257623919,-0.03080148511732194,0.0034805026327011756,-0.045372966560736021,-0.029218619199922261,-0.015818943890176771,0.021759934033232578,-0.10195414139595667,-0.075582185895513548,0.0082711645406465945,-0.0038160328205497133,-0.0090294497149070087,0.011946510583231547,-0.047846038911684416,-0.074302718196757281,-0.0061615587655333712,-0.069463137440628417,-0.038615261481704036,-0.0054909352281676234,0.0039205632203707253,-0.075457978192815828,-0.05517922014072589,-0.0073223667718192546,-0.041430095428083936,-0.038567735799592148,-0.017835534277815351,-0.044649955663984484,-0.055517186343691204,-0.043525980650874097,-0.010785309029566511,-0.018800689621417527,-0.035265350888931443,-0.0523682796404083,-0.051409710766081883,-0.034207072019543608,-0.040655204858792739,-0.038890557656961339,-0.038987763380822132,-0.04295121299162722,-0.045648128441618224,-0.054518156209488945,-0.046373272434632039,-0.039908186961754459,-0.04441460591625912,-0.06632044621167299,-0.044769638626015643,-0.047357828271610017,-0.052404098414888099,-0.05930702712397394,-0.056645432021001363,-0.041634832202926485,-0.046675899727654478,-0.034090937987938885,-0.050356933614642461,-0.055910170380922851,-0.054914686535615528,-0.05687143149874474,-0.037538002449116509,-0.091381277492467064,-0.090664280006922851,-0.074810860787178537,-0.1052499187615067,-0.067975793704709159,-0.069922810025450491,-0.069184758056329815,-0.080422748552774426,-0.12826536685842213,-0.11433017564914463,-0.068300567015818728,-0.088807493305146909,-0.06933895325550278,-0.070404913327719407,-0.10441397207560424,-0.12601040650083331,-0.077758409185438138,-0.10359195495726557,-0.11536478039227681,-0.096572852746188959,-0.084222345514686159,-0.089363072445301242,-0.096011491137984864,-0.082579749139763028,-0.088826183218488536,-0.071017011830248833,-0.080397971558563985,-0.070219817169284313,-0.079212195080423028,-0.089976583088172052,-0.087500908125515309,-0.087191210821466775,-0.10666919804154282,-0.094477686770881295,-0.088159755127270478,-0.081527310486232643,-0.078845635288057936,-0.095375442585102665],"mode":"markers","text":["detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur","offend, victim, handgun, gun, one_time, area, left, right, sever, black","detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur","detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur","offend, victim, handgun, gun, one_time, area, left, right, sever, black","offend, victim, handgun, gun, one_time, area, left, right, sever, black","detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","driver, passeng, unmark, point, car, rear, area, door, gun, front","driver, passeng, unmark, point, car, rear, area, door, gun, front","detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur","driver, passeng, unmark, point, car, rear, area, door, gun, front","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","driver, passeng, unmark, point, car, rear, area, door, gun, front","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","driver, passeng, unmark, point, car, rear, area, door, gun, front","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","offend, victim, handgun, gun, one_time, area, left, right, sever, black","driver, passeng, unmark, point, car, rear, area, door, gun, front","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","driver, passeng, unmark, point, car, rear, area, door, gun, front","offend, polic_vehicl, offend_offend, mark_polic, injuri_result, provid, properti, offic_mark, prior_charg, charg_decis","driver, passeng, unmark, point, car, rear, area, door, gun, front","detect, shoot, polic_district, person, veteran, room, depart, polic_depart, duti, injur","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","driver, passeng, unmark, point, car, rear, area, door, gun, front","driver, passeng, unmark, point, car, rear, area, door, gun, front","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","knife, drop_knife, offend, bedroom, drop, toward_offic, arm, move, toward, male_drop","suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti","driver, passeng, unmark, point, car, rear, area, door, gun, front","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","driver, passeng, unmark, point, car, rear, area, door, gun, front","suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","offend, victim, handgun, gun, one_time, area, left, right, sever, black","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","swat, unit, properti, door, shoot, front, locat, secur, insid, black","suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","offic_number, number, number_one, two, offend, plaincloth_offic, plaincloth, pistol, three, firearm_offic","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","offend, victim, handgun, gun, one_time, area, left, right, sever, black","dog, attack, bull, pit_bull, pit, owner, year, year_old, anim, old","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","dog, resid, narcot, retreat, polic_depart, secur, encount, veteran_philadelphia, veteran, depart","suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti","swat, unit, properti, door, shoot, front, locat, secur, insid, black","dog, attack, bull, pit_bull, pit, owner, year, year_old, anim, old","dog, attack, bull, pit_bull, pit, owner, year, year_old, anim, old","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti","dog, attack, bull, pit_bull, pit, owner, year, year_old, anim, old","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","suspect, male_suspect, swat, swat_offic, robberi, dure, veteran, depart, fire, off-duti","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black","swat, unit, properti, door, shoot, front, locat, secur, insid, black"],"marker":{"colorbar":{"title":"","ticklen":2},"cmin":1,"cmax":10,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[9,2,10,9,6,9,9,6,6,9,2,1,1,9,1,2,2,2,1,2,10,2,1,2,7,8,6,1,2,2,1,2,1,9,10,1,1,8,8,10,7,10,10,10,7,7,7,10,10,10,8,4,10,7,8,10,10,7,7,8,8,8,8,8,7,4,1,10,1,4,8,8,8,8,8,8,8,8,8,8,8,6,8,8,8,3,4,8,8,8,8,8,8,8,10,3,3,6,5,8,8,4,3,5,5,3,3,3,3,4,5,3,3,3,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"size":6,"line":{"colorbar":{"title":"","ticklen":2},"cmin":1,"cmax":10,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[9,2,10,9,6,9,9,6,6,9,2,1,1,9,1,2,2,2,1,2,10,2,1,2,7,8,6,1,2,2,1,2,1,9,10,1,1,8,8,10,7,10,10,10,7,7,7,10,10,10,8,4,10,7,8,10,10,7,7,8,8,8,8,8,7,4,1,10,1,4,8,8,8,8,8,8,8,8,8,8,8,6,8,8,8,3,4,8,8,8,8,8,8,8,10,3,3,6,5,8,8,4,3,5,5,3,3,3,3,4,5,3,3,3,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]}},"type":"scatter","xaxis":"x","yaxis":"y","frame":null},{"x":[0.059335581863470446,0.14290625908342319],"y":[-0.12826536685842213,0.27223024324059203],"type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":1,"cmax":10,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[1,10],"line":{"color":"rgba(255,127,14,1)"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-clusteredDocuments-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Plot of document by first two right singular vectors, colored by cluster
</figcaption>
</figure>
</div>
</div>
</section>
<section id="document-classification" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Document classification</h1>
<p>We can now explore whether the semantic structure of the officer-involved shooting narratives helps us predict whether the subject was fatally shot in the incident. We will base our predictions on the right singular vectors (columns of <span class="math inline">\(\mathbf{V}\)</span>) from the SVD of the TF-IDF matrix, which capture the major themes or latent dimensions in the reports. These components serve as compressed features summarizing the language in each report. We will use the first 20 right singular vectors in a gradient boosting model (GBM), using the <code>gbm3</code> package to model the probability that a given incident was fatal. Each vector reflects some underlying dimension of report content, and the model learns how those patterns relate to fatal outcomes. This approach allows us to assess whether differences in the language used across reports help explain variation in whether in incident was a fatal shooting.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>oisV <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ois, <span class="at">v=</span>oisSVD<span class="sc">$</span>v[,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>oisV <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>text) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     id                                 location
1 24-37      3450 Vista Street, Philadelphia, PA
2 24-36          3250 A Street, Philadelphia, PA
3 24-35 5450 Chancellor Street, Philadelphia, PA
4 24-32         2950 E. Street, Philadelphia, PA
5 24-31      3350 Willits Road, Philadelphia, PA
6 24-30    6150 Lebanon Avenue, Philadelphia, PA
                                        url subInjury       date       lon
1   https://www.phillypolice.com/ois/24-37/       N/A 2024-12-10 -75.03885
2   https://www.phillypolice.com/ois/24-36/       N/A 2024-11-12 -75.12714
3   https://www.phillypolice.com/ois/24-35/    Killed 2024-11-10 -75.23050
4   https://www.phillypolice.com/ois/24-32/       N/A 2024-10-11 -75.12024
5   https://www.phillypolice.com/ois/24-31/    Killed 2024-10-03 -75.00908
6 https://www.phillypolice.com/ois/ps24-30/       N/A 2024-10-02 -75.24450
       lat                                             addrmatch score
1 40.04022      3450 Vista St, Philadelphia, Pennsylvania, 19136   100
2 39.99956          3250 A St, Philadelphia, Pennsylvania, 19134   100
3 39.95692 5450 Chancellor St, Philadelphia, Pennsylvania, 19139   100
4 39.99345          2950 E St, Philadelphia, Pennsylvania, 19134   100
5 40.05383    3350 Willits Rd, Philadelphia, Pennsylvania, 19136   100
6 39.98175   6150 Lebanon Ave, Philadelphia, Pennsylvania, 19151   100
       addrtype fatal cluster        v.1          v.2         v.3          v.4
1 StreetAddress     0       9 0.13016094  0.181618756  0.06341974  0.001783371
2 StreetAddress     0       2 0.10231699  0.115723608  0.04017399  0.026569286
3 StreetAddress     1      10 0.08551283 -0.001978871 -0.01974636  0.028062219
4 StreetAddress     0       9 0.12917295  0.178771243  0.08454448  0.001615541
5 StreetAddress     1       6 0.08414942  0.022223821 -0.05407945 -0.001217451
6  PointAddress     0       9 0.13127178  0.182599820  0.08866061  0.005486347
          v.5         v.6          v.7        v.8         v.9        v.10
1  0.07760631 0.008890891  0.199979308 0.10018817  0.15989567  0.34982790
2 -0.02230433 0.041084503 -0.008339128 0.01935934 -0.05211922 -0.06771078
3  0.03252344 0.067735002 -0.011804535 0.01590215 -0.08673165 -0.04244152
4  0.06670486 0.022493657  0.162582216 0.07352676  0.12173044  0.24055656
5  0.07677374 0.000240447  0.075101934 0.09643664 -0.33961067  0.05761663
6  0.02808567 0.025036115  0.116875101 0.05193598  0.10383358  0.19693314
           v.11        v.12         v.13         v.14         v.15         v.16
1  0.0006812256  0.08102049  0.013300813  0.006515582  0.025324136  0.099139343
2 -0.0074360197 -0.03181066 -0.023685352  0.038979828 -0.005265058 -0.016276658
3 -0.0669816328  0.04056427 -0.009046667 -0.117791644  0.287192712 -0.008292827
4  0.1350307434  0.05270958  0.011407636  0.068441876  0.141978442  0.162467380
5  0.2166365871 -0.13642562  0.092188050 -0.277003881  0.027547169  0.029559397
6 -0.1528681606 -0.04603825  0.135725616 -0.093843767 -0.061663914 -0.128477348
         v.17        v.18         v.19       v.20
1  0.10411342  0.14321191  0.006603584  0.2043905
2 -0.14588496 -0.06326903 -0.037565115  0.1656836
3  0.02444913 -0.06104601 -0.002713264 -0.1059321
4  0.11530322  0.18384681  0.153184117  0.2256497
5  0.03461698  0.18019102  0.088448722 -0.1009509
6 -0.15592025 -0.05279324 -0.100212054 -0.1043711</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240316</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>gbm1 <span class="ot">&lt;-</span> <span class="fu">gbmt</span>(fatal<span class="sc">~</span>v<span class="fl">.1</span><span class="sc">+</span>v<span class="fl">.2</span><span class="sc">+</span>v<span class="fl">.3</span><span class="sc">+</span>v<span class="fl">.4</span><span class="sc">+</span>v<span class="fl">.5</span><span class="sc">+</span>v<span class="fl">.6</span><span class="sc">+</span>v<span class="fl">.7</span><span class="sc">+</span>v<span class="fl">.8</span><span class="sc">+</span>v<span class="fl">.9</span><span class="sc">+</span>v<span class="fl">.10</span><span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                   v<span class="fl">.11</span><span class="sc">+</span>v<span class="fl">.12</span><span class="sc">+</span>v<span class="fl">.13</span><span class="sc">+</span>v<span class="fl">.14</span><span class="sc">+</span>v<span class="fl">.15</span><span class="sc">+</span>v<span class="fl">.16</span><span class="sc">+</span>v<span class="fl">.17</span><span class="sc">+</span>v<span class="fl">.18</span><span class="sc">+</span>v<span class="fl">.19</span><span class="sc">+</span>v<span class="fl">.20</span>,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>oisV,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">distribution=</span><span class="fu">gbm_dist</span>(<span class="st">"Bernoulli"</span>),</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">train_params =</span> <span class="fu">training_params</span>(</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">num_trees =</span> <span class="dv">3000</span>,         <span class="co"># number of trees</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">shrinkage =</span> <span class="fl">0.0004</span>,        <span class="co"># lambda</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">bag_fraction =</span> <span class="fl">0.5</span>,       <span class="co"># fit trees to random subsample</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">num_train =</span> <span class="fu">nrow</span>(oisV),</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">min_num_obs_in_node =</span> <span class="dv">10</span>,</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">interaction_depth =</span> <span class="dv">2</span>,    <span class="co"># number of splits</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">num_features =</span> <span class="dv">10</span>),       <span class="co"># number of features</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">cv_folds=</span><span class="dv">10</span>,</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">par_details=</span><span class="fu">gbmParallel</span>(<span class="at">num_threads=</span><span class="dv">12</span>),</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">is_verbose =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-gbmperf" class="quarto-xref">Figure&nbsp;15</a> below shows the cross-validated predictive performance of the gradient boosting model that uses the first 20 right singular vectors of the text as predictors of whether a shooting was fatal. Each point on the curve represents the model’s performance after a given number of trees, with performance measured on held-out folds of the data. The error declines at first, then levels off and starts to increase as it begins to overfit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>bestNTree <span class="ot">&lt;-</span> <span class="fu">gbmt_performance</span>(gbm1, <span class="at">method=</span><span class="st">"cv"</span>) </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bestNTree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-gbmperf" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gbmperf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-gbmperf-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gbmperf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: Cross-validated predictive performance, predicting fatal shooting from text features
</figcaption>
</figure>
</div>
</div>
</div>
<p>The vertical line marks the number of trees that yielded the best average performance across the folds, in this case 1143 iterations. This value, stored in <code>bestNTree</code>, represents the optimal model complexity for predicting fatal shootings based on the latent text structure.</p>
<p><a href="#fig-relinf" class="quarto-xref">Figure&nbsp;16</a> below displays the relative influence of each right singular vector <span class="math inline">\(v_j\)</span> on the prediction of whether a shooting was fatal, based on the fitted gradient boosting model. Each bar shows how much a particular component contributed to the model’s decision-making, taking into account how much it is responsible for improving the model’s predictive accuracy. Higher values indicate greater importance. This helps identify which underlying semantic dimensions in the officer-involved shooting reports are most strongly associated with fatal outcomes. <span class="math inline">\(v_{16}\)</span> and <span class="math inline">\(v_8\)</span> seem to be the most important.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gbm1, <span class="at">num_trees=</span>bestNTree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      var   rel_inf
v.16 v.16 27.759280
v.8   v.8 21.867012
v.10 v.10 10.631215
v.5   v.5  7.896286
v.14 v.14  6.709116
v.1   v.1  6.650145
v.12 v.12  5.933612
v.7   v.7  5.370606
v.18 v.18  3.939236
v.13 v.13  3.243492
v.2   v.2  0.000000
v.3   v.3  0.000000
v.4   v.4  0.000000
v.6   v.6  0.000000
v.9   v.9  0.000000
v.11 v.11  0.000000
v.15 v.15  0.000000
v.17 v.17  0.000000
v.19 v.19  0.000000
v.20 v.20  0.000000</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-relinf" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-relinf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-relinf-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-relinf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: Relative influence of <span class="math inline">\(v_j\)</span> on fatal shooting
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-partdep" class="quarto-xref">Figure&nbsp;17</a> shows partial dependence plots for the eighth and sixteenth right singular vectors (<span class="math inline">\(v_8\)</span> and <span class="math inline">\(v_{16}\)</span>), illustrating how each influences the predicted probability that a shooting was fatal, holding all other variables constant. These plots help interpret the fitted gradient boosting model by isolating the marginal effect of each feature. For example, since the predicted probability increases with higher values of <span class="math inline">\(v_8\)</span>, this suggests that reports scoring higher on the latent dimension captured by <span class="math inline">\(v_8\)</span> are more likely to describe fatal shootings. The predicted probability of a fatal shooting appears to decline with increasing values of <span class="math inline">\(v_{16}\)</span>. Both plots show threshold and saturation effects. Together, these plots provide insight into which latent themes in the narratives are most predictive of fatal outcomes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">plot</span>(gbm1, <span class="st">"v.8"</span>, <span class="at">num_trees =</span> bestNTree, </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">return_grid =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>v<span class="fl">.8</span>, <span class="at">data=</span>a, </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">3</span>,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">expression</span>(v[<span class="dv">8</span>]), </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Predicted probability"</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">plot</span>(gbm1, <span class="st">"v.16"</span>, <span class="at">num_trees =</span> bestNTree, </span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">return_grid =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>v<span class="fl">.16</span>, <span class="at">data=</span>a, </span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">3</span>,</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">expression</span>(v[<span class="dv">16</span>]), </span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Predicted probability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-partdep" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-partdep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="L11-text_files/figure-html/fig-partdep-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-partdep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Partial dependence plot of <span class="math inline">\(v_8\)</span> and <span class="math inline">\(v_16\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Lastly, let’s explore what terms weigh heavily in the associated <span class="math inline">\(\mathbf{u}_8\)</span> and <span class="math inline">\(\mathbf{u}_{16}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># align terms with their u8 and u16 left singular vectors</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">term=</span><span class="fu">colnames</span>(oisTFIDF),</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">u8=</span>oisSVD<span class="sc">$</span>u[,<span class="dv">8</span>],</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">u16=</span>oisSVD<span class="sc">$</span>u[,<span class="dv">16</span>])</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co"># the 20 most important terms in u8</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>a <span class="sc">|&gt;</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, u8) <span class="sc">|&gt;</span> </span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(u8))) <span class="sc">|&gt;</span> </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               term          u8
1      offic_number  0.34559518
2            number  0.32935959
3        number_one  0.27237200
4           suspect -0.25115632
5              swat  0.16697453
6            attack -0.14247622
7      polic_vehicl -0.13874237
8            victim  0.11190724
9             shoot  0.11101919
10             bull -0.10506007
11         pit_bull -0.10506007
12           offend -0.10283638
13              pit -0.10256173
14          passeng  0.10254237
15         one_time  0.08866185
16         off-duti -0.08665976
17             room  0.08548776
18             unit  0.07747015
19 plaincloth_offic  0.07705985
20              two  0.07696829</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>searchTerm <span class="ot">&lt;-</span> <span class="st">"([Oo]ffic[a-z]* number)"</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>ois <span class="sc">|&gt;</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(searchTerm, text, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(text) <span class="sc">|&gt;</span> </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gsub</span>(searchTerm, bgYellow<span class="sc">$</span><span class="fu">black</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>), <span class="at">x=</span>_) <span class="sc">|&gt;</span> </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OIS# 18-08
On Wednesday, April 18, 2018, at approximately 3:45AM, two uniformed officers operating a marked police vehicle pursued a stolen Nissan Altima to the 3100 block of N. 33rd Street. The stolen vehicle crashed into parked vehicles. The officers exited their patrol vehicle and approached the stolen vehicle. The male operator of the stolen vehicle refused commands to stay in the vehicle and show his hands, and began exiting the vehicle and reaching for his waistband. Officer number one, positioned at the driver’s side rear of the stolen vehicle, drew his firearm and discharged one round striking the driver’s side rear door. The offender fled south on 33rd Street and was apprehended by both officers. The offender was uninjured. No firearm was recovered from the male or the vehicle.
Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The DA’s Office is provided all the information from the PPD’s investigation prior to their charging decision. OIS# 18-01
On Saturday, January 13th, 2018, at approximately 10:45PM, two uniformed officers in an unmarked patrol vehicle observed a Hyundai Santa Fe traveling in the wrong direction on Hart Lane. The officers activated the emergency lights and sirens and stopped the Hyundai in the 2800 block of Kensington Avenue. The vehicle was occupied by a male driver, who lowered all four windows upon stopping, and a male passenger in the front seat. Officer number one proceeded to the driver’s side and spoke with the vehicle operator, and officer number two proceeded to the passenger side and spoke with the male passenger. Officer number two observed a bulge at the front waistband of the passenger, and the officer opened the door and patted the object. Officer number two felt a firearm, drew his service pistol, and alerted officer number one. At the same time, two additional uniformed officers in an unmarked patrol vehicle arrived at the location, and officers number three and four exited their vehicle and drew their firearms. The male passenger exited the Hyundai and produced a 9MM semi-automatic pistol with an extended magazine. Officers number two and three discharged their service pistols, striking the offender.
The offender was admitted to Temple University Hospital in critical but stable condition. The offender’s firearm, a stolen 9MM pistol loaded with thirty-three (33) rounds, was recovered from the male.
The male operator of the Hyundai was not charged with any offense.
No other injuries were reported in connection with this incident.
*** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The DA’s Office is provided all the information from the PPD’s investigation prior to their charging decision. OIS# 17-28
On Saturday, September 23, 2017, at approximately 10:06 PM, two uniformed 22nd District officers were speaking to a complainant in the 2300 block of north 13th Street about the theft of the complainants cellular phone one week earlier. The complainant was scheduled to meet the alleged thief at the location to “buy back” his phone. While the officers were standing next to the complainant’s vehicle, two males, one of whom was armed with a handgun, approached and fired several shots at the officers. Both officers retreated and officer number one drew his firearm and discharged six rounds at the offender. Both males appeared to be uninjured. They fled on foot eluding apprehension. A firearm magazine loaded with six .380 caliber cartridges was recovered in a driveway between 2300 N. 13th Street and Park Avenue.
*** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The DA’s Office is provided all the information from the PPD’s investigation prior to their charging decision. OIS# 17-25
On Saturday, August 19, 2017, at approximately 11:00PM, three uniformed bike patrol officers were riding their bicycles south in the 2500 block of N. Alder Street when officer number one observed the offender holding a firearm. Officer number one dismounted his bicycle and told the male to drop the weapon. The offender ran south on Alder Street, and west through an alley with officer number one in foot pursuit. The offender pointed his firearm at officer number one, who discharged striking the offender in the right flank and legs. The offender threw his firearm, a semi-automatic pistol loaded with ten rounds, into a yard adjacent to the alley. Officer number one caught up with the male, who was arrested without further incident and transported to Temple University Hospital, where he was admitted in stable condition. There were no other reported injuries as a result of this incident.
*** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The DA’s Office is provided all the information from the PPD’s investigation prior to their charging decision. OIS# 17-23
On Friday, August 11, 2017, at approximately 5:12 PM, uniformed officers in marked patrol vehicles responded to a radio assignment of “Theft in Progress” in the 3100 block of N. Darien Street. When officer number one arrived, the officer was told that a male was trying to take an individual’s vehicle. Officer number one approached the male positioned in the driver’s seat with the door open. The male grabbed the officer’s holstered firearm and attempted to pull the firearm out. Officer number one fought to keep his firearm from being pulled out of his holster, and called for assistance. Officers number two and three arrived at that time, and drew their firearms. Officer number two ordered the offender to release officer number one’s firearm. The offender released his grip on officer number one’s weapon, and grabbed the barrel of officer number two’s weapon. Officer number two discharged one round, and officers one and three discharged three rounds each. The offender sustained gunshot wounds to the torso and legs and was transported to Temple University Hospital where he was pronounced deceased. There were no other injuries as a result of this incident.
*** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The DA’s Office is provided all the information from the PPD’s investigation prior to their charging decision. OIS# 17-13
On Friday, May 12, 2017, at approximately 2:42 AM, 12th District uniformed officers responded to a radio call for a male violating a Protection From Abuse (PFA) order inside a residence on the 1200 block of south 51 street. The offender was inside the 2nd floor front bedroom. A female complainant stated the male might be armed with a knife. The male refused officers’ direction to open the door and come out of the room. Officer number one forced the door open, and the offender, armed with a ten-inch knife, moved towards the officers. Officer number two deployed his ECW (Taser), contacting the offender, momentarily causing him to fall onto the bed. The offender stood up and while still holding the knife, moved towards the officers. Officer number one discharged his service weapon, striking the offender in the torso. The offender was transported to Penn Presbyterian Medical Center where he was pronounced deceased.
There were no other injuries as a result of this incident. A knife was recovered at the scene.
*** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The DA’s Office is provided all the information from the PPD’s investigation prior to their charging decision. OIS# 17-03 (February 15, 2017)
On Wednesday, February 15th, 2017, at approximately 8:33PM, two plainclothes officers in an unmarked vehicle were traveling west in the 2000 block of Chelten Avenue when they observed two males exiting a known drug location. Both males attempted to enter a parked vehicle, and the vehicle’s alarm activated. The plainclothes officers exited their vehicle and stopped both males for investigation. At the same time, two uniformed officers operating a marked vehicle were driving past and stopped to assist the plainclothes officers. Plainclothes officer number one felt a handgun in the clothing of male number one while conducting a pat-down, and male number one fled east on Chelten Avenue, and north on 6400 Lambert Street. Plainclothes officer number one, and uniformed officer’s number one and two chased the male. Male number one produced a firearm, and pointed it at the pursuing officers. Plainclothes officer number one, and uniformed officer’s number one and two discharged their firearms, striking the offender. The offender was admitted to AEMC in critical but stable condition.
The offender’s firearm, a 9MM pistol loaded with eleven rounds, was recovered from the male’s hand.
Male number two was not charged with any offense.
There were no other injuries as a result of this incident.
*** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The DA’s Office is provided all the information from the PPD’s investigation prior to their charging decision. PS#16-40
11/07/16
On Monday, November 7, 2016, at approximately 7:02 P.M., uniformed police officers in marked police vehicles, received information that a male wanted for investigation in reference to an earlier shooting may be in the area of the 3100 block of N. Darien Street. The officers responded to that location and observed a male walking toward them with his hands in his pockets. The officers requested that the male show his hands, at which time the male ran south on Darien Street, west on Clearfield Street, and north onto the 3100 block of N. 9th Street. The officers pursued the male, on foot, and observed that the male had a firearm in his hand as he fled. The officers yelled for the offender to drop the weapon, at which time the offender pointed the firearm at Officer number one. In response, Officer number one discharged his weapon at the offender. The offender fell to the ground and dropped his firearm. The offender then reached for a second firearm that he had also dropped. Officer number one and three additional officers discharged their weapons, striking the offender. The offender was transported to Temple University Hospital, where he was pronounced deceased.
The offender’s firearms, a .357 caliber revolver, loaded with five live rounds and a 9MM semi-automatic pistol, loaded with one live round, were recovered at the scene.
There were no other injuries as a result of this incident.
*** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The DA’s Office is provided all the information from the PPD’s investigation prior to their charging decision. PS#16-38
11/2/16
On Saturday, October 29, 2016, at approximately 10:21 P.M., uniformed police officers in a marked police vehicle, while driving north on Front Street approaching Gurney Street, observed a male discharging a firearm at a second male, who was running north in the 2900 block of N. Front Street. The officers stopped their vehicle and officer number one exited from the passenger side and discharged his firearm, missing the offender. Officer number two, while seated in the driver’s seat of the patrol car, discharged his firearm through the windshield, missing the offender.
According to the officers, the offender then turned and discharged his firearm at them. Officer number one again discharged his firearm, missing the offender. The offender ran west on Tusculum Street and then north in the 3000 block of N. Waterloo Street, where the officers lost sight of him.
The male being fired upon by the offender reported being robbed by the offender.
No weapon has been recovered at this time.
There were no known injuries as a result of this incident.
*** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The DA’s Office is provided all the information from the PPD’s investigation prior to their charging decision. PS#16-37
10/27/16
On Thursday, October 27, 2016, at approximately 10:49 P.M., uniformed officers, in a marked police vehicle, responded to a Police Radio assignment of an intoxicated, suicidal male, armed with a knife, at 3810 Elsinore Street. Upon their arrival, the officers were met by a female complainant who identified herself as the daughter of the suicidal male. The female complainant informed the officers that her father was intoxicated, armed with a knife, and threatening suicide.
The officers entered the residence and observed the male seated in the kitchen, holding a large knife to his chest. The officers ordered the male to drop the knife, but he did not comply. The male then stood up with the knife raised above his shoulder, and moved toward the officers. Officer number one, who is a Crisis Intervention Trained Officer, deployed his Electronic Control Weapon on the offender. The offender removed the Electronic Control Weapon prongs from his torso and again moved toward the officers. In response, Officer number one deployed his Electronic Control Weapon a second time. The offender once again removed the prongs from his torso. The officers then backed away from the offender and exited the residence.
The offender followed the officers to the front door and broke through the frame of screen door as he moved toward the officers with the knife in his hand. Both officers discharged their firearms, striking the offender. The offender fell to the ground, dropping the knife.
The offender was transported to Temple University Hospital for treatment.
The offender’s stainless steel knife, with an overall length of fifteen inches, was recovered at the scene.
There were no other injuries as a result of this incident.
*** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The DA’s Office is provided all the information from the PPD’s investigation prior to their charging decision. PS# 16-35
10/19/16
On Saturday, October 22, 2016, at approximately 4:10 A.M., uniformed officers, in a marked police vehicle, were responding to a Police Radio assignment of a disturbance in the 600 block of N. 56th Street. As the officers approached the intersection of 56th Street and Haverford Avenue, they heard gunshots and saw muzzle flashes coming from a driveway in the 5500 block of Haverford Avenue. The officers stopped, exited their vehicle, and approached the driveway. As the officers approached, a male ran north on 56th Street. Officer number one pursued the male on foot and apprehended him in the 500 block N. 56th Street. A second male exited the driver side door of a nearby black Toyota Corolla and walked toward Officer number two. Officer number two ordered the male to stop. The male reached toward his waistband. In response, Officer number two discharged his firearm, striking the offender. A third male was also apprehended outside of the Toyota. A fourth male fled from the scene on foot and was not identified.
The offender was transported to Penn-Presbyterian Hospital for treatment.
No weapon was recovered; however, fifteen fired cartridge casings were recovered at the scene.
There were no other injuries as a result of this incident.
*** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The DA’s Office is provided all the information from the PPD’s investigation prior to their charging decision.</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Narrative from 2 reports with the terms like 'officer number'">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Narrative from 2 reports with the terms like ‘officer number’
</div>
</div>
<div class="callout-body-container callout-body">
<p>OIS# 18-08 On Wednesday, April 18, 2018, at approximately 3:45AM, two uniformed officers operating a marked police vehicle pursued a stolen Nissan Altima to the 3100 block of N. 33rd Street. The stolen vehicle crashed into parked vehicles. The officers exited their patrol vehicle and approached the stolen vehicle. The male operator of the stolen vehicle refused commands to stay in the vehicle and show his hands, and began exiting the vehicle and reaching for his waistband. Officer number one, positioned at the driver’s side rear of the stolen vehicle, drew his firearm and discharged one round striking the driver’s side rear door. The offender fled south on 33rd Street and was apprehended by both officers. The offender was uninjured. No firearm was recovered from the male or the vehicle. Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The DA’s Office is provided all the information from the PPD’s investigation prior to their charging decision.</p>
<p>OIS# 18-01 On Saturday, January 13th, 2018, at approximately 10:45PM, two uniformed officers in an unmarked patrol vehicle observed a Hyundai Santa Fe traveling in the wrong direction on Hart Lane. The officers activated the emergency lights and sirens and stopped the Hyundai in the 2800 block of Kensington Avenue. The vehicle was occupied by a male driver, who lowered all four windows upon stopping, and a male passenger in the front seat. Officer number one proceeded to the driver’s side and spoke with the vehicle operator, and officer number two proceeded to the passenger side and spoke with the male passenger. Officer number two observed a bulge at the front waistband of the passenger, and the officer opened the door and patted the object. Officer number two felt a firearm, drew his service pistol, and alerted officer number one. At the same time, two additional uniformed officers in an unmarked patrol vehicle arrived at the location, and officers number three and four exited their vehicle and drew their firearms. The male passenger exited the Hyundai and produced a 9MM semi-automatic pistol with an extended magazine. Officers number two and three discharged their service pistols, striking the offender. The offender was admitted to Temple University Hospital in critical but stable condition. The offender’s firearm, a stolen 9MM pistol loaded with thirty-three (33) rounds, was recovered from the male. The male operator of the Hyundai was not charged with any offense. No other injuries were reported in connection with this incident. *** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The DA’s Office is provided all the information from the PPD’s investigation prior to their charging decision.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>a <span class="sc">|&gt;</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, u16) <span class="sc">|&gt;</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(u16))) <span class="sc">|&gt;</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           term         u16
1        stolen  0.23365546
2       robberi  0.20856963
3      complain  0.18489227
4          rifl -0.15161821
5       highway -0.14550798
6        driver  0.13467318
7          swat  0.12489604
8         resid -0.11764230
9          bull  0.11210792
10     pit_bull  0.11210792
11    point_gun  0.11199690
12        knife  0.10742236
13        south  0.10739931
14      partner  0.10593829
15         bodi -0.10504127
16         road -0.10364580
17        femal -0.10290537
18 unmark_polic -0.10276761
19       unmark -0.10234364
20          pit  0.09482592</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>searchTerm <span class="ot">&lt;-</span> <span class="st">"(bod[yi][^ ]*)"</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>ois <span class="sc">|&gt;</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(searchTerm, text, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(text) <span class="sc">|&gt;</span> </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gsub</span>(searchTerm, bgYellow<span class="sc">$</span><span class="fu">black</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>), <span class="at">x=</span>_) <span class="sc">|&gt;</span> </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2600 block of Glenwood Avenue
The Philadelphia Police Department is investigating an officer-involved shooting incident that occurred on Thursday, September 26, 2024.
At approximately 7:00 PM on the evening of September 26, Officer #1 and his partner were on foot patrol in the area of 2600 Glenwood Avenue when they were alerted to a stolen moped being tracked by Apple AirTag. While searching the area, Officer #1 encountered a white Pit-bull dog that charged at him. In response, the officer discharged his weapon multiple times, missing the dog. The dog subsequently retreated from the scene.
No injuries were reported as a result of the incident.
The officer&amp;#8217;s body-worn camera was activated during the encounter.
Officer #1 is 27-years-old, a two-year veteran of the Philadelphia Police Department,&nbsp; assigned to the 22nd Police District. The officer has been placed on administrative duty pending the outcome of the Internal Affairs and Officer-Involved Shooting Investigations. 3000 block of Ruth Street
The Philadelphia Police Department is currently investigating an officer-involved shooting that resulted in the injury of a dog in the Kensington neighborhood.
The incident occurred on July 4th, 2024, shortly after 8:00 PM, as officers were investigating a black Jeep Grand Cherokee that had been stolen during a burglary and used in an aggravated assault against police.
During the investigation, officers went to a residence on the 30xx block of Ruth Street, where they believed the occupants of the vehicle might be located. Upon arriving at the residence, officers encountered a 27-year-old Hispanic female accompanied by a Pitbull dog. The officers instructed the woman to secure the dog, which she did on the second floor of the residence.
As the officers were speaking to the woman at the door, they heard additional officers in the rear of the property shouting at someone to stay where they were. At that time, the officers who had been speaking to the woman entered the residence, and observed the dog at the top of the stairs. The dog began barking and then charged towards the officers. Officer #1 discharged his weapon, striking the dog in the nose.
The injured dog was taken to a veterinarian by their owner for treatment. There were no injuries to any police officers or civilians.
The officer, a 34-year-old five-year veteran of the Philadelphia Police Department assigned to the 24th Police District, has been placed on administrative duty pending the outcome of the Officer-Involved Shooting and Internal Affairs investigations.
The discharging officer’s body worn camera captured the incident. 1500 block of North 57th Street
A Philadelphia police officer fatally shot two dogs on June 5, 2024 after the dogs attacked a woman and a resident in West Philadelphia.
Officers responded to a call for a woman screaming and being attacked by dogs shortly before 9:00 a.m. on the 1500 block of North 57th Street.
An 18-year-old Black female victim was walking down the street when she witnessed two Pitbulls fighting on a porch. A 57-year-old Black male resident on the porch called for the woman’s help.
The woman approached the dogs and used mace on them, managing to separate one of the Pitbulls, believed to be a stray, from the resident’s dog. However, the resident’s second Pitbull ran out from the residence and attacked the woman, biting her on the arm and ankle.
The woman managed to run from the dogs, and all three dogs turned on each other.
Upon arriving at the scene, the responding officer observed the ongoing dog fight. The officer discharged his weapon multiple times, striking and fatally wounding both the stray dog and one of the resident’s Pitbulls.
Medics transported the injured woman to Lankenau Hospital for treatment. The resident, who sustained a dog bite to his chest during the dog fight, refused medical attention.
Philadelphia Animal Control took custody of the two deceased dogs.
Police body camera footage captured the incident.
The investigation is ongoing.
The discharging officer is 34-years-old, a five year veteran of the Philadelphia Police Department, and is assigned to the 19th Police District.
He has been placed on administrative duty pending the outcome of the Internal Affairs and Officer-Involved Shooting investigations. 1600 South Dover Street
On Thursday, May 23, 2024, at approximately 4:03 a.m., officers from the Philadelphia Police Department’s 17th District responded to a radio call for a dog attack at a residence on the 1600 block of South Dover Street.
Upon arrival, officers observed a 67 year-old male attempting to separate two dogs; a tan-colored Pitbull and a small black Pomeranian. The pit bull then turned and attacked a PPD Sergeant, biting him on the left arm.
Officer #1 discharged her multiple times, striking the pit bull. The sergeant (discharging officer #2) also discharged his firearm, striking the dog. Both the pit bull and the Pomeranian were deceased at the scene.
The injured sergeant was transported to Presbyterian Hospital by medics in stable condition with bite wounds and minor abrasions. He received treatment and was released.
Animal Control responded to the scene and took possession of the Pitbull.
The officers’ body-worn cameras were activated and captured the incident.
Discharging officer #1 is 46 years old, a 20-year veteran of the PPD, and is assigned to the 17th Police District.
Discharging officer #2 (PPD sergeant) is 48 years old, a 16-year veteran of the PPD, and is also assigned to the 17th Police District.
Both officers have been placed on administrative duty pending the outcome of Internal Affairs and Officer-Involved Shooting investigations. 3000 block of North 16th Street
A Philadelphia police officer shot and killed a pit bull on May 15, 2024 that was attacking another dog.
Officers from the 39th District responded to a call about a dog attack around 12:06 p.m. Upon arrival, they saw a large pit bull attacking a smaller dog.
To stop the attack, Officer #1 fired his weapon multiple times, killing the pit bull. The smaller dog died from injuries sustained in the attack.
There were no injuries to the officers.
One of the dog owners, a 66 year-old Black male, was injured when a bullet fragment ricocheted and struck his left forearm. He declined medical attention at the scene.
Both dogs were taken to the Philadelphia Animal Care and Control Agency (PACCA).
The officer’s body-worn camera captured the incident.
Officer #1 is 30 years old, a 7 year veteran of the Philadelphia Police Department, and is assigned to the 39th Police District.
He has been placed on administrative duty pending the outcome of the Internal Affairs and Officer-Involved Shooting Investigations. 3900 block of Fairmont Avenue
A Philadelphia police officer shot and killed a Cane Corso dog on May 1, 2024, after it and three pit bulls attacked a man in the city’s Mantua neighborhood.
Officer #1 was on patrol around 10:16 a.m. on May 1st, 2024, when he encountered a civilian witness who was pointing and stating that there were loose dogs down the street. Arriving at the intersection of Fairmount Avenue and Union Street, the officer witnessed a 53-year-old Black male victim being mauled by the four dogs.
Officer #1 attempted to use his siren to distract the dogs, but they continued their attack. The officer then exited his vehicle and fired multiple rounds, killing the Cane Corso and stopping the mauling. The pit bulls fled the scene.
The victim suffered bite wounds throughout his body and was transported to Presbyterian Hospital by Philadelphia Fire Department paramedics for treatment. He was listed in stable condition. The officer did not sustain any injuries.
Officer #1’s body camera was not activated during this incident.
Officer #1 is 33 years old, a 7-year veteran of the Philadelphia Police Department, and is assigned to the 16th Police District.
As per PPD policy, the officer has been placed on administrative duty pending the outcome of the Internal Affairs and Officer-Involved Shooting Investigations 2100 block of Eastburn Avenue
At approximately 8:08 a.m. on April 17, 2024, a Philadelphia Police officer responded to a radio call for a dog attack on the 2100 block of Eastburn Avenue.
Upon arrival, the officer observed a large pit bull dog attacking a Pomeranian on the sidewalk. The owner of the pit bull attempted to intervene but was unable to separate the dogs.
At that time the discharging officer (Officer #1) exited her vehicle and deployed her Taser twice in an attempt to stop the attack. When the Taser was ineffective at stopping the pit bull, the officer drew her weapon and discharged multiple rounds, stopping the attack on the dog.
The pit bull then turned towards the officer and the officer discharged her weapon again, striking the pit bull in the rear leg.
After the pit bull was injured, the owner was able to gain control of the dog and transported it to the University of Pennsylvania Veterinary Hospital for treatment of a single gunshot wound.
The Pomeranian was transported to Animal Care and Control Team Philadelphia (ACCT) but did not survive.
The officer’s Body Worn Camera was activated and captured the entire incident.
The discharging officer is 31 years old, an eight-year veteran of the Philadelphia Police Department, and is assigned to the 14th Police District. As with all officer-involved shootings, the officer has been placed on administrative duty pending the outcome of the Internal Affairs and Officer-Involved Shooting investigations. 1000 block of West Dakota Street
On Monday, April 15, 2024, at approximately 3:26 p.m.. two Philadelphia police officers responded to a radio call for a recovered stolen auto on the 1000 block of W. Dakota Street. Upon arrival, the officers located a matching 2017 Black Jeep Grand Cherokee.
As the officers initiated the recovery process, a Black male suspect entered the driver’s seat and attempted to flee in the vehicle. Officer A* approached the driver’s side and attempted to remove the suspect.
A second officer, Officer #1 (discharging officer) of the 22nd Police District, observed the suspect draw a handgun from his waistband. Officer #1 discharged his weapon once. The suspect fled the scene northbound on 11th Street in the stolen vehicle.
The officers’ Body Worn Cameras (BWCs) were not activated at the time of incident. A description of the suspect and the vehicle was broadcast over police radio and a search for the suspect at local hospitals was unsuccessful in locating in the male.
The investigation remains ongoing.
Officer #1 is 44 years old, a five-year-veteran of the Philadelphia Police Department, and is assigned to the 22nd Police District. Officer #1 has been placed on administrative duty pending the outcome of the Internal Affairs and Officer-Involved Shooting Investigations.
*asterisk denotes an officer present during an officer-involved shooting who does not discharge their firearm 6200 block of Haverford Avenue
On Sunday, April 14, 2024, at approximately 12:46 p.m., Officer #1 of the Philadelphia Police Department responded to a radio call for two Pitbull dogs attacking people on the highway at the intersection of 62nd and Haverford Avenue.
Upon arrival, Officer #1 observed the Pitbulls attacking a 17 year-old Black male. The officer exited his marked patrol car and shouted at the dogs to stop the attack. The dogs then turned and charged towards Officer #1.
Officer #1 discharged his weapon multiple times, striking one of the dogs. Both animals then retreated to a nearby porch on Haverford Avenue. Responding officers transported the injured dog to the Animal Care and Control Team (ACCT) facility, where it later died.
The owner of the dogs was located and took possession of the uninjured Pitbull.
Philadelphia Fire Department paramedics transported the juvenile victim to Lankenau Hospital for a laceration to his left thigh and was later released.
The officer’s Body Worn Camera was activated and captured the entire incident.
Officer #1 is 36 years old, a three-year veteran of the Philadelphia Police Department, and is assigned to the 19th Police District.
The officer has been placed on administrative duty pending the outcome of the Internal Affairs and Officer-Involved Shooting investigations. 300 block of Adams Avenue
On Thursday evening, February 15, 2024, at approximately 7:02 p.m., Officer #1, assigned to the 25th District, while on duty in a marked RPC and in full uniform, was patrolling the area of F Street and Roosevelt Boulevard. During his patrol, Officer #1 observed a white Lincoln Town Car, occupied by two individuals, and attempted to stop the vehicle for investigation.
Officer #1 activated his lights and siren in an attempt to pull over the vehicle. However the driver failed to comply and fled. Officer #1 pursued the vehicle until it reached the 300 block of Adams venue.
Upon reaching the 300 block Adams Avenue, Officer #1 encountered civilian vehicles blocking the road on the bridge over Tacony Creek. Despite this obstruction the driver of the Lincoln continued to maneuver the vehicle erratically.
Officer #1 exited his vehicle and approached the driver’s side of the Lincoln and attempted to open the driver’s side door. The door was locked and the window was partially down. The suspect (driver) did not comply with Officer #1 commands to open the door and rolled the window up. The vehicle continued to move back-and-forth, but was unable to get around the stopped civilian vehicles. Officer #1 struck the driver’s window with his ASP, shattering the window. At that point, Officer #1 was able to open the driver’s door; however, at the same time, the suspect maneuvered his vehicle forward; striking Officer #1; pinning him between the driver’s side of the suspect’s vehicle and a stone wall on the bridge. The suspect drove forward and Officer #1 fell on the ground in front of the vehicle. At that point, Officer #1 discharged his weapon, striking the vehicle.
The passenger in the Lincoln, later identified as a 27/B/M, exited the Lincoln and backed away from the vehicle; leaving the front passenger door open. As Officer #1 approached the passenger front door, the suspect accelerated forward, striking Officer #1 and causing the passenger door to close and striking Officer #1 marked patrol vehicle. Officer #1 opened the passenger door and the suspect reverses, striking Officer #1 with the open passenger front door at which point Officer #1 discharged his weapon into the vehicle from the open passenger door. The door closed again and Officer #1 again, opened the passenger front door and discharged one time into the vehicle. The vehicle again struck the marked patrol vehicle. Officer #1 rounded the rear of the Lincoln from the passenger side to the driver side and the suspect again reversed striking Officer #1 with the bent driver’s door. The suspect continued to reverse in the eastbound lane to Newtown Avenue and fled the scene in the vehicle.
A struggle ensued between the remaining occupant of the Lincoln and Officer #1. The vehicle struck both the officer and his patrol car and fled the scene. Officer #1 discharged his weapon multiple times during the encounter.
A witness then assisted Officer #1 in taking the passenger into custody.
Following the altercation, the Lincoln, operated by the suspect, fled the scene and was later found by uniformed officers in the rear driveway of 6000 Hasbrook Avenue. The suspect was discovered outside the vehicle with multiple gunshot wounds to his legs, and was pronounced deceased upon arrival at Albert Einstein Medical Center (AEMC).
Officer #1 was transported by Medics to AEMC with injuries to his lower extremities. He was equipped with a Body Worn Camera that was activated during the incident.
The incident is currently under investigation by the Philadelphia Police Department’s Officer Involved Shooting Investigations Unit (OISI), the PPD’s Internal Affairs Division (IAD), and the Philadelphia District Attorney’s Office (DAO).
Officer #1: 38/B/M, assigned to the 25th Police District, is an eight-year veteran of the PPD.
Decedent: 36/B/M, of Philadelphia. 2300 block of Borbeck Avenue
At approximately 4:56 a.m. on January 17, 2024, a Philadelphia police officer was dispatched to the 7800 block of E. Roosevelt Boulevard for a possible vehicle crash. Unable to locate a crash, but observing a truck parked on Borbeck Avenue with its horn steadily sounding, the officer approached and made contact with the 73-year-old driver. After the officer determined no assistance was needed, he began to leave the location. He then heard two gunshots coming from the direction of the truck.
Approaching the truck again, the officer observed a firearm in the suspect’s hand and retreated while calling for additional officers. Responding officers declared a barricade, established a perimeter, and called for SWAT assistance. During the barricade incident, the suspect fired in the direction of officers while still seated in the truck.
The suspect then shot at a responding SWAT Lieutenant (Officer #1) and a SWAT Officer (Officer #2) who arrived on the scene. Officer #1 and Officer #2 returned fire, fatally wounding the suspect.
No officers were injured.
Officer #1 is 42 years old and a 21-year veteran assigned to SWAT.
Officer #2 is 38 years old and a 17-year veteran assigned to SWAT.
Both discharging officers have been placed on administrative duty pending the outcome of the internal affairs and officer-involved shooting investigations.
The initial responding officer’s body-worn camera was activated during the incident but did not capture the shooting itself.
###
Please note that this information is still under investigation and may be subject to change. 3600 block of Sepviva Street
At approximately 9:30 p.m. on Wednesday, January 10, 2024, Philadelphia Police officers responded to a report of a “person screaming” in the rear yard of a residence on the 3600 block of Sepviva Street. Upon arrival, officers learned that several Pit Bull dogs had attacked a French bulldog in the yard. The owner of the French bulldog, a 37-year-old male, attempted to intervene and was bitten multiple times on the right leg and lower back. He was transported to Temple Hospital in stable condition. The French bulldog died from its injuries.
Officers entered the residence and observed five Pit Bull dogs barking and growling. When the dogs advanced, one officer deployed an Electronic Control Weapon (ECW) without effect. Officer #1 and Officer #2 then drew their firearms and discharged several times, striking one dog in the paw. All five dogs were able to be to be contained inside the residence by the owner.
Body Worn Cameras were activated during the incident. No officers were injured.
Officer #1 is 28 years old, a four-year veteran of the Department, and assigned to the 24th District.
Officer #2 is 30 years old, a 10-month veteran of the Department, and assigned to the 24th District.
Both discharging officers have been placed on administrative duty pending the outcome of the Internal Affairs and Officer Involved Shooting investigations. 1800 block of South 29th St.
On Sunday, December 31, 2023, at approximately 12:05 a.m., Philadelphia Police officers responded to a radio call for “Someone Breaking In” at a residence on the 1800 block of South 29th Street.
Officers made contact with a male resident upon arrival. During the interaction, a pit bull belonging to the resident charged towards one of the responding officers. Officer #1 drew their weapon and fired four rounds, striking the dog in the hind legs. The dog was transported to a private veterinary clinic for treatment.
No police officers were injured in the incident.
Both officers were equipped with Body Worn Cameras, which were activated at the time of the incident.
The discharging officer (Officer #1) is 36 years old, a 16-year veteran of the Philadelphia Police Department, and assigned to the 1st Police District. Officer #1 has been placed on administrative duty pending the outcome of the Internal Affairs and Officer-Involved Shooting investigations. 3700 block of Fairmount Street
On Saturday, November 4, 2023, Police Officer #1, operating a marked Radio Patrol Car (RPC), in full uniform, responded to a radio call at 3700 Fairmount Avenue, in reference to a person with a weapon (wooden stick) / someone being attacked by a Pit-bull on the highway. Upon arrival, witnesses reported an attack involving multiple dogs. While searching for potential victims, three pit bulls charged at the officer while barking aggressively. In response, Officer #1 fired his weapon, missing the dogs, who then retreated to their home on the 600 block of N. 37th St.
Police were unable to locate a dog bite victim. There were no injuries to police. The owner of the dogs was issued two code violation notices.
The officer’s Body Worn Camera (BWC) was activated and it depicts the incident / OIS.
The discharging officer (Officer #1) is 34-years-old and a one-year veteran of the PPD. He is assigned to the 16th District.
Officer #1 has been placed on administrative duty pending the outcome of the Internal Affairs and Officer-Involved Shooting investigations. 7500 block of Whitaker Ave.
At approximately 7:07 p.m. on Wednesday, October 4th, Philadelphia Police officers responded to a radio call for a “Person with a gun” and a report of a shooting at 75xx Whitaker Avenue. Upon arrival, officers encountered a 42-year-old Asian male armed outside the location.
Officers gave verbal commands to the suspect to drop his weapon. The suspect failed to comply, and an exchange of gunfire occurred between the officers and the suspect.
Sergeant A* was shot once in his left hand during the encounter. Officer #1 was shot one time in the rear right leg area. Police Officer #2 was shot one time in the right leg. The officers returned fire, and the suspect was fatally wounded. Philadelphia Fire Department personnel responded to the scene and pronounced him deceased at 7:27 pm.
The preliminary investigation indicates the suspect was involved in a verbal altercation with another male inside the home before firing his weapon, striking the other male in the face. The suspect then exited the home, where he encountered officers.
A juvenile male and an adult female were inside the home at the time of the incident but were not injured.
The suspect was wearing a ballistic vest and was found to be in possession of a loaded 40 caliber Glock pistol and additional ammunition.
All officers involved were treated at Jefferson-Torresdale Hospital for their injuries and are listed in stable condition. The victim shot by the suspect is currently listed in critical but stable condition at Abington Hospital.
The officers were equipped with body-worn cameras.
The involved officers are assigned to the 2nd Police District:
Officer #1: 32-years-old, four-year veteran of the Department
Officer #2: 34-years-old, six-year veteran of the Department
Sergeant #1: 33-years-old, 10-year veteran of the Department
Sergeant A*, a 17-year veteran of the Department, was present during the incident but did not discharge his weapon.
The discharging officers have been placed on administrative duty pending the outcome of the Internal Affairs and Officer-Involved Shooting investigations. 1500 block of N. 62nd Street
On Wednesday, October 4, 2023, at 1:11 p.m., officers in a marked patrol vehicle responded to a radio call of a male being mauled by multiple dogs at 15xx N. 62nd Street.
Upon arrival, officers found a 63-year-old Black male lying on his back, sustaining significant injuries and being mauled by a pack of five to six dogs. Officer #1 attempted to control the situation verbally, but discharged his weapon after the dogs continued their attack. Two dogs were struck; one dog died at the scene, and the other sustained a gunshot wound to the face. The remaining three dogs retreated into a fenced yard.
Philadelphia Animal Care Control Team (ACCT) responded to remove the injured and deceased dogs. The dog owner took custody of the remaining three animals.
The victim, in critical condition, received two tourniquets to his left leg and was transported to Lankenau Hospital by paramedics. No officers were injured during the incident.
Body worn cameras were activated during the incident.
Officer #1 is 34 years old, a six-year veteran of the Philadelphia Police Department, and is assigned to the 19th Police District.
He has been placed on administrative duty pending the outcome of the Philadelphia Police Department’s Internal Affairs Division and Officer-Involved Shooting Investigation Unit. On Monday, August 14, at approximately 12:28 PM, 24th District Officer #1 and his partner, Officer A* were in full uniform and operating a marked police car in the area of B Street near Westmoreland when they observed a Toyota Corolla with a PA tag driving erratically. Officer A went over police radio and asked if there were any priority assignments involving a Toyota sedan. The officers followed the vehicle as it turned on Westmoreland, then left onto Lee Street, and finally left onto Willard Street. At that point, the vehicle continued along 100 E. Willard Street, a single-lane, one-way street, westbound – the wrong way. The vehicle pulled into a parking spot mid-block, at which point both officers got out of their marked radio patrol car.
Officer A, who was the driver of the police vehicle, approached the passenger side of the Toyota Corolla. Officer #1, the passenger of the police car, approached the driver’s side door. Officer A attempted to open the passenger side door and as he did so, Officer #1 was approaching the driver’s side door.
Officer A alerted Officer #1 that the male had a weapon. As the male turned towards Officer #1, Officer #1 discharges his firearm multiple times into the vehicle, fatally wounding the driver/sole occupant of the vehicle. The occupant/operator was transported to the Temple Hospital by police where he was pronounced at 12:48 PM.**
Two knives were observed inside the vehicle. The vehicle was towed to a police garage, pending a search warrant.
Both officers’ Body Worn Cameras (BWC) were activated and captured the incident.
Officer #1 is a five year veteran of the Philadelphia Police Department and is assigned to the 24th District.
*Officer A denotes an officer present during a police shooting who does not discharge a firearm. 2300 block of Fawn Street
On Thursday, May 4, 2023, at approximately 2:21 p.m., Officer #1 and Officer #2 were in full uniform operating a marked radio patrol car responding to a pending radio assignment for males stripping a possible stolen car in the lot located at 23xx Fawn Street. Officer #1 exited his patrol vehicle and entered the lot observing a stripped down Dodge Durango. As Officer #1 approached, a black male emerged running from between the car and house.
Officer #1 began to chase the male for several blocks through empty lots and into the rear of 12XX W. Dauphin Street. The rear property was not fenced and covered in debris and waist high weeds. Officer #1 approached the rear of the house and the male came out from the in cove of the house with a handgun raised in the direction of Officer #1. Officer #1 fired his weapon three times striking the male in the head. The male fell to the ground and dropped his handgun next to his body. Officer #1 holstered his weapon, notified police radio of his position and grabbed the male’s right arm. The male laid on the ground with his eyes closed not moving for several seconds. The male quickly rolled his body away from the Officer and reached for his handgun. Officer #1 and the male began to struggle on the ground and the male was able to gain possession of the officer’s gun. Officer #1 was on top of the male and the male had the gun between Officer #1’s legs and fired one time. Officer #2 arrived in the rear yard and observed his partner in a fight with the male over the gun. Officer #2 discharged his weapon, striking the male in his body.
Responding officers transported the male to Temple Hospital where he was pronounced at 3:04 p.m.
Both officers’ BWCs depict the entire incident. 4700 block of Leiper Street
On 4/6/2022, at approximately 7:00 p.m., two 15th District officers were travelling along 4700 Penn St. in their marked vehicle when they heard 8-9 gunshots near their location. The officers saw a Black male with a black hooded sweatshirt running down the 1600 block of Arrott Street. The officers exited their vehicle and engaged the male in a foot pursuit. The officers relayed to police radio that they were involved in a foot pursuit and notified radio that they were coming up 4700 Penn Street. Once they got to Arrott Street, one of the officers lost sight of the male but his partner indicated that he “ran into the building over here.” Passers-by also pointed the location out to the officers and stated “He ran into there! In that house!” indicating 4701 Leiper Street. The officers notified police radio and informed them that a male was barricaded inside that location. The officers remained on location keeping an eye on the building. They could hear movement in the location and at one point, the same male they had chased had started to exit the side door of the structure, and upon seeing them, slammed the door and returned to the home. The officers noted that the male was no longer wearing the hooded sweatshirt.
Additional officers arrived on location to the barricade incident. A short time later, officers heard gunshots coming from above inside of the residence at 4701 Leiper Street. A responding supervisor told the group of officers to remain in cover, as this was an active shooter situation. At some point, a request was made over police radio for long-gun trained officers to assist. A SEPTA Officer arrived at the location with a long-gun. The SEPTA Police Officer was at 1400 Arrott Street attempting to take cover behind a patrol vehicle, and while doing so, he was struck in the stomach area by gunfire. Responding officers transported him to Temple Hospital where he was listed critical but stable condition after receiving surgery for a GSW to the abdomen.
During this incident, additional officers who arrived on location discharged their firearms at the offender who was positioned on the second floor near the windows, armed with a firearm.
The crime scene was processed and inside investigators observed a Black male, face-up, with an apparent GSW to his head. In addition, these investigators observed a black semi-automatic handgun near his right shoulder in the 2nd floor front bedroom of 4701 Leiper Street.
Responding officers initially believed the GSW to the head was self-inflicted, due to preliminary evidence observed.
The decedent’s body was removed from the scene and transported to the Medical Examiner’s Office.
An autopsy of the decedent was completed on 4/7/22 by the Philadelphia Medical Examiner’s Office.
As part of the ongoing investigation, it is currently believed that the decedent’s GSW to the head was not self-inflicted, and was caused by shots fired from discharging officers at some point during the exchange of gunfire between the decedent and discharging officers.
Note: During the course of this incident, officers came upon two gunshot victims – female victim #1 sustained a graze wound to her right upper hip area and female victim #2 who sustained a perforating gunshot wound to her buttocks. These victims were transported to Temple Hospital and were placed in stable condition.
A third gunshot victim – a male – walked into Jefferson-Frankford Hospital with 2 GSWs to the neck area. He was transported to Jefferson-Torresdale where he was intubated. Upon further investigation, it is believed that this male was involved in a physical altercation with the offender, and while walking away, the offender fired at him – striking him as well as the two female victims.
Offender/Decedent: 18/B/M.
Offender’s weapon: Polymer 80 Privately Made Firearm (PMF – aka “Ghost Gun”) 9MM semi-auto pistol.
Victim #1: 52/F: GSW to right upper hip area
Victim #2: 42/F: GSW to buttocks
Victim #3: 33/M: Two GSWs to neck
Victim #4: 28/M SEPTA PD P/O Injuries: GSW to abdomen
Discharging Officer #1: 15th District P/O 45/W/M
Discharging Officer #2: 15th District P/O 36/W/M
Discharging Officer #3: 25th District P/O 27/B/M
Discharging Officer #4: 25th District P/O 31/W/M
Discharging Officer#5: 24th District P/O 30/W/M
Discharging Officer #6: 2nd District P/O 37/W/M
Discharging Officer #7: 15th District P/O 33/H/M
The Investigation is active and ongoing with the Officer-Involved Shooting Investigation Unit.
All discharging officers have been placed on administrative duty pending the outcome of the Internal Affairs investigation. 100 block of West Lehigh Avenue
On Friday, February 11, 2022 at approximately 12:37 p.m., members of the Philadelphia Police Department’s SWAT Unit were at 1xx West Lehigh Avenue to execute a search warrant. The search warrant was to search for a 35/H/M wanted for parole violations.
Police Officers #1 and #2, from the Philadelphia Police Department’s SWAT Unit, knocked and announced “POLICE WITH A WARRANT” and breached the front door. Police Officers #3, #4, #5, also assigned to SWAT, were assigned as the 3rd floor entry team. Officer #3, equipped with a ballistic shield, assigned to be first in line, ascended the stairs and made his way to the 3rd floor apartment door. Officer #3 put his shield to the door and called up the “breacher”. Officer #4 used a breaching shotgun on the door lock and deadbolt, discharging three (3) rounds on the lock with negative results for breaching the lock. At that point, Officer #3 called for a ram. Officer #3 bladed his body, in order to make room for Officer #4 to strike the door with a “ram”. At that point, Officer #3, facing the apartment wall, still positioned in the stairwell, heard “pops” emanating from inside the 3rd floor apartment. Officer #3 noted that the “pops” were very light, because he had his headset on. Officer #3 then heard two additional “pops”, then a third “pop”, followed by the sensation of a “sting” in his chest. He observed a hole in the wall and drywall dust on his shoulder. Additionally, he observed a hole through the 3rd floor apartment door. Officer #3 informed his team, via SWAT Band, that he was shot. At that point, Officer #3 exited the property. SWAT Unit personnel transported Police Officer #3 to Temple Hospital where he received treatment by medical staff. The bullet did not penetrate his ballistic vest. Police Officer #3 sustained a “red mark” to his chest, from where the bullet stuck his vest.
Police Officer #6 and #7, also assigned to SWAT, were positioned in the rear of the property. Police Officer #6 and Police Officer #7 observed a male, later positively identified as the male wanted for parole violations, exit the 3rd floor rear window, jumping down to the 2nd floor’s rooftop. Police Officer #6 stated, “Gun! DROP THE GUN!” The male then pointed his firearm at Police Officer #6. Police Officer #6 discharged his weapon at the male, missing him, who then discarded his weapon on another adjacent rooftop. The magazine dislodged from the firearm’s magazine well and landed on the ground, behind the property.
Police Officer #4 made his way to the 2nd floor and climbed through the window and onto the roof. He turned the corner and observed the male, but could not see his hands. Police Officer #4 ordered the male to “show his hands.” However, the male did not comply. A brief struggle ensued and the male was eventually placed in handcuffs. The male complained of pain to his ankle. Police transported the male to AEMC where he received treatment for his injured ankle.
The male’s firearm, a Glock 17, 9MM, semi-automatic handgun, was recovered with one (1) live round in the chamber, the magazine had ten (10) live 9MM rounds inside.
Note: The firearm is in stolen status, stolen from Upper Darby, Pa.
The discharging officer, Officer #6, has been placed on administrative duty pending the outcome of the Internal Affairs Bureau and Officer-Involved Shooting Investigations Unit investigations. 3000 block of North Water Street
On Thursday, July 22, 2021, at approximately 6:29 p.m., Officer #1 and Officer #2, detailed to the Narcotic Field Unit, were in plainclothes, operating an unmarked vehicle. While on patrol, traveling north bound in the 3000 block of N. Water Street, they observed a large crowd fighting near the southeast corner of Water Street and Clearfield Street. The Officers stopped their vehicle at the corner and unknown people began to strike their unmarked vehicle. At that point, the Officers observed a male, wearing a red hat, discharging a firearm towards the crowd and an additional time in the air. Both officers exited their vehicle as the discharging male was walking southbound on the sidewalk.&nbsp; Officer #2 identified himself as Police.&nbsp;The discharging male turned, blading his body, pointing his gun at Officer #2.&nbsp; In response, Officer #2 and Officer #1 discharged their weapons, fatally wounding the male.
The male’s weapon was recovered from the sidewalk next to his body.
A female initially stated that she was struck by gunfire.&nbsp; She was transported to Temple University Hospital and assessed by medical personnel.&nbsp;The medical examination revealed that she did not sustain a gunshot wound.
There were no injuries to Police. 300 Glen Echo Road
On Monday, June 14, 2021, at approximately 10:46 p.m., Officer #1 and his partner, Officer #2, and Officer #3, were in full uniform operating marked patrol vehicles, when they responded to a radio call, in reference to a person with a gun at 3XX Glen Echo Road.
Upon arrival, officers met the occupants of 3XX Glen Echo Road and began to speak with the family inside of the living room area.&nbsp; The officers learned that there was no firearm involved in the incident; it was in reference to an on-going domestic assault allegation of a minor. Due to the chaos inside the residence, Officer #3 stepped out onto the front porch and spoke with the two of the occupants from the home. While speaking to them, Officer #3 heard what he believed to be two (2) gunshots.&nbsp; In response, Office #3 directed the civilians into the residence and took cover inside.&nbsp; Simultaneously, Officers #2 and #1 exited the front door of 3XX Glen Echo Road.&nbsp; Officer #1 points out the individual(s) approaching the residence.&nbsp; Officer #1 re-positioned himself in front of Officer #2 and then turns his body towards the front door.&nbsp; At that point, it sounds as if there are two (2) gunshots.&nbsp; Officer #1 re-positioned his body and turned towards his right.&nbsp; Officer #1 observed two black males, armed with a long gun rifle and handgun coming up the walkway towards the officers. Officer #1 discharged his firearm striking both males.
Recovered at the scene:

Numerous .223 and .266 live rounds of ammunition.
One 91 (magazine) loaded.
One Springfield Armory pistol, serial number:

Both weapons were recovered at the scene.
Both males were transported to AEMC by Police and treated for non-life threating injuries.
The Officers Body Worn Cameras were activated and captured the incident.
There were no reported injuries to Police or Civilians. 3500 block of Wharton Street
On 11-27-20 at 7:58 p.m., officers responded to a shooting at 15XX S. Taney Terrace where, a Black male was shot and later pronounced deceased at 8:23 PM at Presbyterian Hospital. Information was developed from witnesses on scene in reference to the identity of the alleged shooter, including name and address. Based on that information, Officers #1 and #2, in full uniform and marked patrol vehicle went to 35xx Wharton Street. Officer #3 was also in full uniform and in a marked patrol vehicle, was already on location and observed a blue minivan parked in the side driveway that was observed fleeing the homicide scene. Officers #1 and #2 went to the rear of 35xx Wharton Street for rear containment. Officer #1 and #2 observed a black male standing in the side doorway of that property. Officer #1 attempted to communicate with the male. The male stated, “You looking for me?”, then discharged his firearm at Officers #1 and #2. Officer #3 was positioned in the side driveway towards the front of property, observed the black male, shooting at the officers. In response, Officer #3 discharged his weapon, missing the male. At that point, the male retreated into the property and officers secured the location and declared a barricaded. SWAT personnel attempted to establish an open line of communication with the male for over an hour without success.
SWAT officers made entry and located the decedent, a Black male, towards the rear of the property, 1st floor kitchen with an apparent gunshot wound to the head. SWAT cleared the rest of the property with negative results. A firearm was located next to Scott’s body. Philadelphia Fire Department Medics pronounced Scott at the scene.
There were no other reported injuries to police or civilians. On 9-02-19, at 10:15 PM, two uniformed 24th District Police Officers were driving a marked patrol car, when they observed a silver Nissan Titan SUV traveling in reverse, westbound on the 100 block of East Wishart Street. As the SUV approached Front Street, the officers observed a man standing near the SUV attempting to open the driver’s door. The officers activated their emergency lights and the SUV sped away, northbound on Front Street. The male, who attempted to open the door, fell away from the vehicle and stood in the middle of the street. Both officers exited the police car and saw the male was holding a box cutter. Both officers ordered the man to stop and drop the box cutter. He ignored the officers’ commands and began walking towards them. Both officers back-pedaled, while continually ordering him to drop the knife. One of the officers (officer A) requested back up and a Crisis Intervention Trained (CIT) officer. The man with the box cutter continued advancing towards the officers who created distance between themselves and the man by back-pedaling towards Allegheny Avenue. As the officers approached Allegheny Avenue the man advanced toward officer A. In response, Office A discharged his weapon, striking the male in his torso. The male fell to his knees, still refusing to drop the box-cutter. Additional officers who had arrived on the scene disarmed him by kicking the box-cutter away. The man was transported to Temple University Hospital by police, where he was treated and listed in critical condition. Officer’s Body Worn Cameras were activated during the incident. The box-cutter was recovered at the scene. No other injuries were reported in connection with this incident.
*** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The District Attorney’s Office is provided all the information from the PPD’s investigation prior to their charging decision. OIS# 18-27
On November 13, 2018, at approximately 10:45 PM, 19th District Police Officers responded to a radio call for “Several gunshots fired at 7500 Brookhaven Road.” Upon arrival, they observed a male, walking on Brookhaven Road coming from the direction of the reported gunshots. The Officers exited their vehicle and approached the male, who fled on foot in the driveway, armed with a firearm in his right hand. The officers pursued the male on foot and observed him in a crouched position, near the bushes of a residence on the block. The male then emerged from the bushes and fled on foot, down the rear driveway. While fleeing, the male turned towards an officer, blading his body. Due to the male’s actions, the officer was unable to observe the male’s hands. Believing the male was still armed, the officer discharged one round, missing the male, who continued running down the driveway, turning his body in a way that did not allow officers to see his hand. The officer discharged another round. The male was not struck. The officer was able to apprehend the male at the opposite end of the driveway, heading back onto Brookhaven Road, near Haverford Avenue. An officer located the male’s firearm near the bushes he had initially crouched behind.
There were no reported injuries in connection with this incident.
*** Information posted in the original summary reflects a preliminary understanding of what occurred at the time of the incident. This information is posted shortly after the incident and may be updated as the investigation leads to new information. The District Attorney’s Office is provided all the information from the PPD’s investigation prior to their charging decision.</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Narrative from 2 reports with the terms like 'body' or 'bodies'">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Narrative from 2 reports with the terms like ‘body’ or ‘bodies’
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>ois <span class="sc">|&gt;</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(searchTerm, text, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(text) <span class="sc">|&gt;</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gsub</span>(searchTerm, bgYellow<span class="sc">$</span><span class="fu">black</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>), <span class="at">x=</span>_) <span class="sc">|&gt;</span> </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>2600 block of Glenwood Avenue The Philadelphia Police Department is investigating an officer-involved shooting incident that occurred on Thursday, September 26, 2024. At approximately 7:00 PM on the evening of September 26, Officer #1 and his partner were on foot patrol in the area of 2600 Glenwood Avenue when they were alerted to a stolen moped being tracked by Apple AirTag. While searching the area, Officer #1 encountered a white Pit-bull dog that charged at him. In response, the officer discharged his weapon multiple times, missing the dog. The dog subsequently retreated from the scene. No injuries were reported as a result of the incident. The officer’s body-worn camera was activated during the encounter. Officer #1 is 27-years-old, a two-year veteran of the Philadelphia Police Department,&nbsp; assigned to the 22nd Police District. The officer has been placed on administrative duty pending the outcome of the Internal Affairs and Officer-Involved Shooting Investigations. 3000 block of Ruth Street The Philadelphia Police Department is currently investigating an officer-involved shooting that resulted in the injury of a dog in the Kensington neighborhood. The incident occurred on July 4th, 2024, shortly after 8:00 PM, as officers were investigating a black Jeep Grand Cherokee that had been stolen during a burglary and used in an aggravated assault against police. During the investigation, officers went to a residence on the 30xx block of Ruth Street, where they believed the occupants of the vehicle might be located. Upon arriving at the residence, officers encountered a 27-year-old Hispanic female accompanied by a Pitbull dog. The officers instructed the woman to secure the dog, which she did on the second floor of the residence. As the officers were speaking to the woman at the door, they heard additional officers in the rear of the property shouting at someone to stay where they were. At that time, the officers who had been speaking to the woman entered the residence, and observed the dog at the top of the stairs. The dog began barking and then charged towards the officers. Officer #1 discharged his weapon, striking the dog in the nose. The injured dog was taken to a veterinarian by their owner for treatment. There were no injuries to any police officers or civilians. The officer, a 34-year-old five-year veteran of the Philadelphia Police Department assigned to the 24th Police District, has been placed on administrative duty pending the outcome of the Officer-Involved Shooting and Internal Affairs investigations. The discharging officer’s body worn camera captured the incident.</p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>